(()=>{"use strict";var e=[,(e,t,a)=>{a.r(t),a.d(t,{default:()=>SETTINGS});class SETTINGS{static init(e){this.MOD_NAME=e,String.prototype.localize||(String.prototype.localize=function(){return game.i18n.localize(this.valueOf())})}static register(e,t){game.settings.register(SETTINGS.MOD_NAME,e,t)}static registerMenu(e,t){game.settings.registerMenu(SETTINGS.MOD_NAME,e,t)}static get(e){return game.settings.get(SETTINGS.MOD_NAME,e)}static async set(e,t){return await game.settings.set(SETTINGS.MOD_NAME,e,t)}static default(e){return game.settings.settings.get(SETTINGS.MOD_NAME+"."+e).default}static typeOf(){return Object}}},(e,t,a)=>{a.r(t),a.d(t,{default:()=>AngleSnaps});var i=a(1);class AngleSnaps{static init(){i.default.register("angle-snap-macro",{config:!0,scope:"world",name:"DF_TEMPLATES.AngleSnap.MacroName",hint:"DF_TEMPLATES.AngleSnap.MacroHint",type:Number,range:{min:4,max:24,step:4},default:24}),i.default.register("angle-snap-micro",{config:!0,scope:"world",name:"DF_TEMPLATES.AngleSnap.MicroName",hint:"DF_TEMPLATES.AngleSnap.MicroHint",type:Number,range:{min:1,max:4,step:1},default:3})}static ready(){libWrapper.register(i.default.MOD_NAME,"canvas.templates._onMouseWheel",(function(e){const t=this._hover;if(!t)return;let a=360/i.default.get("angle-snap-macro");e.shiftKey||(a/=i.default.get("angle-snap-micro"));const n=Math.sign(e.deltaY),r=a*n;let l=t.data.direction-t.data.direction%a;return t.data.direction%a!=0&&n<0&&(l+=a),t.rotate(l+r,a)}),"OVERRIDE")}static handleDnD5eAbilityTemplate(e,t){t.mw=t=>{t.ctrlKey&&t.preventDefault(),t.stopPropagation();let a=360/i.default.get("angle-snap-macro");t.shiftKey&&(a/=i.default.get("angle-snap-micro"));const n=Math.sign(t.deltaY);let r=e.data.direction;r<0&&(r+=360),r-=r%a,e.data.direction%a!=0&&n<0&&(r+=a),e.data.update({direction:r+a*n}),e.refresh()}}}},(e,t,a)=>{a.r(t),a.d(t,{default:()=>SnapIntersect});var i=a(1);class SnapIntersect{static init(){i.default.register("SnapIntersect",{config:!0,scope:"world",name:"DF_TEMPLATES.SnapIntersectName",hint:"DF_TEMPLATES.SnapIntersectHint",type:Boolean,default:!1,onChange:e=>e?this.patch():this.unpatch()})}static ready(){i.default.get("SnapIntersect")&&this.patch()}static patch(){libWrapper.register(i.default.MOD_NAME,"canvas.templates.gridPrecision",SnapIntersect.TemplateLayer_gridPrecision,"OVERRIDE")}static unpatch(){libWrapper.unregister(i.default.MOD_NAME,"canvas.templates.gridPrecision",!1)}static TemplateLayer_gridPrecision(){return canvas.grid.type===CONST.GRID_TYPES.GRIDLESS?0:1}static handleDnD5eAbilityTemplate(e,t){let a=0;t.mm=t=>{t.stopPropagation();const n=Date.now();if(n-a<=20)return;const r=t.data.getLocalPosition(e.layer),l=canvas.grid.getSnappedPosition(r.x,r.y,i.default.get("SnapIntersect")?1:2);e.data.update({x:l.x,y:l.y}),e.refresh(),a=n}}}},(e,t,a)=>{a.r(t),a.d(t,{default:()=>SquareTemplate});var i=a(1);class SquareTemplate{static init(){i.default.register(SquareTemplate.FIX_ROTATION_PREF,{config:!0,scope:"world",name:"DF_TEMPLATES.SquareRotateName",hint:"DF_TEMPLATES.SquareRotateHint",type:Boolean,default:!0,onChange:e=>e?SquareTemplate.patch():SquareTemplate.unpatch()}),i.default.get(SquareTemplate.FIX_ROTATION_PREF)&&SquareTemplate.patch()}static patch(){libWrapper.register(i.default.MOD_NAME,"MeasuredTemplate.prototype._getRectShape",SquareTemplate.MeasuredTemplate_getRectShape,"OVERRIDE"),libWrapper.register(i.default.MOD_NAME,"MeasuredTemplate.prototype._refreshRulerText",SquareTemplate.MeasuredTemplate_refreshRulerText,"WRAPPER")}static unpatch(){libWrapper.unregister(i.default.MOD_NAME,"MeasuredTemplate.prototype._getRectShape",!1),libWrapper.unregister(i.default.MOD_NAME,"MeasuredTemplate.prototype._refreshRulerText",!1)}static MeasuredTemplate_getRectShape(e,t,a=!1){const i=PIXI.Matrix.IDENTITY.rotate(Math.PI/180*-45+e),n=a?1e-4:0,r=Math.sqrt(t*t/2)-n,l=i.apply(new PIXI.Point(n,n)),o=i.apply(new PIXI.Point(r,n)),s=i.apply(new PIXI.Point(n,r)),c=i.apply(new PIXI.Point(r,r)),d=new PIXI.Polygon([l.x,l.y,o.x,o.y,c.x,c.y,s.x,s.y,l.x,l.y]);return d.x=l.x,d.y=l.y,d.width=r,d.height=r,d}static MeasuredTemplate_refreshRulerText(e){if(e(),"rect"===this.data.t){const e=`${Math.sqrt(this.data.distance*this.data.distance/2).toFixed(1)}${canvas.scene.data.gridUnits}`;this.hud.ruler.text=e}}}SquareTemplate.FIX_ROTATION_PREF="fix-square-rotation"},(e,t,a)=>{a.r(t),a.d(t,{default:()=>TemplateTargeting});var i=a(1),n=a(6),r=a(7);class TemplateTargeting{static init(){r.TemplateConfig.init(),i.default.register(TemplateTargeting.TARGETING_TOGGLE_PREF,{config:!1,scope:"client",type:Boolean,default:!0,onChange:()=>{i.default.get(TemplateTargeting.TARGETING_MODE_PREF)}}),i.default.register(TemplateTargeting.TARGETING_MODE_PREF,{config:!0,scope:"world",name:"DF_TEMPLATES.AutoTargetName",hint:"DF_TEMPLATES.AutoTargetHint",type:String,choices:{never:"Never",toggle:"Toggle (Add toggle button)",always:"Always"},default:"toggle",onChange:()=>{ui.controls.initialize(),ui.controls.render(!0)}}),i.default.register(TemplateTargeting.GRIDLESS_RESOLUTION_PREF,{config:!0,scope:"world",name:"DF_TEMPLATES.GridlessPointResolutionName",hint:"DF_TEMPLATES.GridlessPointResolutionHint",range:{max:10,min:1,step:1},type:Number,default:3}),i.default.register(TemplateTargeting.GRIDLESS_PERCENTAGE_PREF,{config:!0,scope:"world",name:"DF_TEMPLATES.GridlessPointPercentageName",hint:"DF_TEMPLATES.GridlessPointPercentageHint",range:{max:100,min:0,step:10},type:Number,default:0}),i.default.register(TemplateTargeting.PREVIEW_PREF,{config:!0,scope:"world",name:"DF_TEMPLATES.PreviewName",hint:"DF_TEMPLATES.PreviewHint",type:Boolean,default:!0}),Hooks.on("getSceneControlButtons",(e=>{if("toggle"!==i.default.get(TemplateTargeting.TARGETING_MODE_PREF))return;e.find((e=>"measure"===e.name)).tools.splice(0,0,{icon:"fas fa-bullseye",name:"autoTarget",title:"DF_TEMPLATES.ToggleTitle",visible:!0,toggle:!0,active:i.default.get(TemplateTargeting.TARGETING_TOGGLE_PREF),onClick:e=>{i.default.set(TemplateTargeting.TARGETING_TOGGLE_PREF,e)}})})),libWrapper.register(i.default.MOD_NAME,"MeasuredTemplate.prototype.highlightGrid",this._MeasuredTemplate_highlightGrid,"OVERRIDE"),libWrapper.register(i.default.MOD_NAME,"PlaceableObject.prototype._createInteractionManager",(function(e){if(!(this instanceof MeasuredTemplate))return e();const t=e();return t.callbacks.dragLeftCancel=function(e){this.refresh(),PlaceableObject.prototype._onDragLeftCancel.apply(this,[e])},t}),"WRAPPER")}static ready(){const e=function throttle(e,t){let a;t||(t=250);let i,n=!1;return function(...r){i=[...r];const l=+new Date,o=this;if(a&&l<a+t){if(n)return;n=!0,setTimeout((function(){n=!1,a=+new Date,e.apply(o,i)}),t-(l-a))}else a=l,e.apply(o,i)}}((function(){TemplateTargeting._MeasuredTemplate_highlightGrid.apply(this)}),50);game.dnd5e&&libWrapper.register(i.default.MOD_NAME,"game.dnd5e.canvas.AbilityTemplate.prototype.refresh",(function(t,...a){return e.apply(this),t(...a)}),"WRAPPER"),libWrapper.register(i.default.MOD_NAME,"MeasuredTemplate.prototype.refresh",(function(t){return e.apply(this),t()}),"WRAPPER");const handleTemplateCreation=function(e,...t){var a;return null===(a=canvas.grid.getHighlightLayer("Template.null"))||void 0===a||a.clear(),e(...t)};libWrapper.register(i.default.MOD_NAME,"TemplateLayer.prototype._onDragLeftDrop",handleTemplateCreation,"WRAPPER"),libWrapper.register(i.default.MOD_NAME,"TemplateLayer.prototype._onDragLeftCancel",handleTemplateCreation,"WRAPPER"),canvas.controls.addChild(TemplateTargeting.PointGraphContainer)}static _MeasuredTemplate_highlightGrid(){const e=i.default.get(TemplateTargeting.TARGETING_MODE_PREF),t="always"===e||"toggle"===e&&i.default.get(TemplateTargeting.TARGETING_TOGGLE_PREF),a=this.document.author.id===game.userId;if(a&&t&&canvas.tokens.objects)for(const e of game.user.targets)e.setTarget(!1,{releaseOthers:!1,groupSelection:!0});TemplateTargeting._handleTouchTemplate.bind(this)(a,t)}static _calculateGridTestArea(){const e=this.shape,t=e.points?e.points:e.radius?[-e.radius,-e.radius,e.radius,e.radius]:[e.x,e.y,e.x+e.width,e.y+e.height],a={left:Number.MAX_VALUE,right:Number.MIN_VALUE,top:Number.MAX_VALUE,bottom:Number.MIN_VALUE,width:function(){return this.right-this.left},height:function(){return this.bottom-this.top}};for(let e=0;e<t.length;e+=2)t[e]<a.left&&(a.left=t[e]),t[e]>a.right&&(a.right=t[e]),t[e+1]<a.top&&(a.top=t[e+1]),t[e+1]>a.bottom&&(a.bottom=t[e+1]);const i=canvas.grid.grid.getSnappedPosition(a.left,a.top,1),n=canvas.grid.grid.getSnappedPosition(a.right,a.bottom,1);return[a.left,a.top]=[i.x,i.y],[a.right,a.bottom]=[n.x,n.y],a}static _handleTouchTemplate(e,t){var a,l;const o=canvas.grid,s=canvas.dimensions,c=this.borderColor,d=this.fillColor,p=i.default.get("template-debug"),g=null!==(a=this.id)&&void 0!==a?a:null===(l=this._original)||void 0===l?void 0:l.id;if(!this.id&&!i.default.get(TemplateTargeting.PREVIEW_PREF)||!this.shape)return;const h=o.getHighlightLayer(`Template.${null!=g?g:null}`);if(null==h||h.clear(),o.type===CONST.GRID_TYPES.GRIDLESS){const a=this.shape.clone();try{"points"in a?a.points=a.points.map(((e,t)=>t%2?this.y+e:this.x+e)):(a.x+=this.x,a.y+=this.y)}catch(e){}return o.grid.highlightGridPosition(h,{border:c,color:d,shape:a}),void TemplateTargeting._selectTokensByPointContainment.bind(this)(e,t,this.data,this.shape,!0)}const u=TemplateTargeting._calculateGridTestArea.apply(this),T=Math.ceil(u.width()/o.w)+2,f=Math.ceil(u.height()/o.h)+2,[m,E]=canvas.grid.getTopLeft(this.data.x,this.data.y),[_,M]=o.grid.getGridPositionFromPixels(u.left+m,u.top+E),P=canvas.grid.w/2,y=canvas.grid.h/2;let{direction:R,distance:S,angle:b,width:C}=this.data;S*=s.size/s.distance,C*=s.size/s.distance,b=Math.toRadians(b),R=Math.toRadians(R%360+360);const v="round"===game.settings.get("core","coneTemplateType"),A=v?S:S/Math.sin(Math.PI/2-b/2)*Math.sin(Math.PI/2);let[D,I,O,N]=[0,0,0,0],[w,L,G,F]=[0,0,0,0],x=!1;const generateConeData=()=>{x||(x=!0,[D,I,O,N]=[this.data.x,this.data.y,this.data.x+Math.cos(R-b/2)*A,this.data.y+Math.sin(R-b/2)*A],[w,L,G,F]=[this.data.x,this.data.y,this.data.x+Math.cos(R+b/2)*A,this.data.y+Math.sin(R+b/2)*A])},generateRayData=()=>{x||([D,I]=[this.data.x+Math.cos(R-Math.PI/2)*(C/2),this.data.y+Math.sin(R-Math.PI/2)*(C/2)],[O,N]=[D+Math.cos(R)*S,I+Math.sin(R)*S],[w,L]=[this.data.x+Math.cos(R+Math.PI/2)*(C/2),this.data.y+Math.sin(R+Math.PI/2)*(C/2)],[G,F]=[w+Math.cos(R)*S,L+Math.sin(R)*S])};for(let a=-1;a<f;a++)for(let i=-1;i<T;i++){const[l,s]=canvas.grid.grid.getPixelsFromGridPosition(_+a,M+i),g=l+P,u=s+y,T=new NormalizedRectangle(l,s,canvas.grid.w,canvas.grid.h);let f=!1;switch(this.data.t){case"circle":{const[e,t]=[g-this.data.x,u-this.data.y];if(f=e*e+t*t<=S*S,f||r.TemplateConfig.config.circle===r.HighlightMode.CENTER)break;const a=S*S;let[i,n]=[0,0];const testPoint=(e,t)=>([i,n]=[e-this.data.x,t-this.data.y],i*i+n*n<a);f=testPoint(T.left,T.top)||testPoint(T.right,T.top)||testPoint(T.left,T.bottom)||testPoint(T.right,T.bottom);break}case"rect":{const e=this._getRectShape(R,S,!0);if(e instanceof PIXI.Polygon){if(f=this.shape.contains(g-this.data.x,u-this.data.y),f||r.TemplateConfig.config.rect===r.HighlightMode.CENTER)break;[D,I,O,N,G,F,w,L]=e.points.map(((e,t)=>e+(t%2?this.data.y:this.data.x))),f=n.default.cohenSutherlandLineClipAndDraw(D,I,O,N,T)||n.default.cohenSutherlandLineClipAndDraw(O,N,G,F,T)||n.default.cohenSutherlandLineClipAndDraw(G,F,w,L,T)||n.default.cohenSutherlandLineClipAndDraw(w,L,D,I,T)}else e.x+=this.data.x,e.y+=this.data.y,e.width-=1,e.height-=1,f=!(e.left>=T.right||e.right<=T.left||e.top>=T.bottom||e.bottom<=T.top);break}case"cone":if(f=this.shape.contains(g-this.data.x,u-this.data.y),f||r.TemplateConfig.config.cone===r.HighlightMode.CENTER)break;if(generateConeData(),f=n.default.cohenSutherlandLineClipAndDraw(D,I,O,N,T),f)break;if(f=n.default.cohenSutherlandLineClipAndDraw(w,L,G,F,T),f)break;if(v){const e=S*S;let[t,a]=[0,0],i=0,n=0;const testPoint=(i,n)=>([t,a]=[i-this.data.x,n-this.data.y],t*t+a*a<e),testAngle=()=>{i=Math.sqrt(t*t+a*a),t/=i,n=Math.acos(t),a<0&&(n=2*Math.PI-n);const e=R-b/2,r=R+b/2;return e<0?n<=r||n>=2*Math.PI+e:r>2*Math.PI?n<=r-2*Math.PI||n>=e:n<=r&&n>=e};if(testPoint(T.left,T.top)&&(f=testAngle(),f))break;if(testPoint(T.right,T.top)&&(f=testAngle(),f))break;if(testPoint(T.left,T.bottom)&&(f=testAngle(),f))break;testPoint(T.right,T.bottom)&&(f=testAngle())}else f=n.default.cohenSutherlandLineClipAndDraw(O,N,G,F,T);break;case"ray":if(f=this.shape.contains(g-this.data.x,u-this.data.y),f||r.TemplateConfig.config.ray===r.HighlightMode.CENTER)break;generateRayData(),f=n.default.cohenSutherlandLineClipAndDraw(D,I,O,N,T)||n.default.cohenSutherlandLineClipAndDraw(w,L,G,F,T)||n.default.cohenSutherlandLineClipAndDraw(D,I,w,L,T)||n.default.cohenSutherlandLineClipAndDraw(O,N,G,F,T)}if(p||f){try{o.grid.highlightGridPosition(h,{x:l,y:s,border:c,color:p?f?65280:16711680:d})}catch(e){if(!(e instanceof Error&&e.message.includes("'highlight'")))throw e}if(f&&e&&t)if(r.TemplateConfig.config[this.data.t]!==r.HighlightMode.POINTS)for(const e of canvas.tokens.placeables){const t=new NormalizedRectangle(e.x,e.y,e.w,e.h);T.left>=t.right||T.right<=t.left||T.top>=t.bottom||T.bottom<=t.top||e.setTarget(!0,{user:game.user,releaseOthers:!1,groupSelection:!0})}else TemplateTargeting._selectTokensByPointContainment.bind(this)(e,t,this.data,this.shape,!0)}}}static _selectTokensByPointContainment(e,t,a,n,r=!1){if(!e||!t)return;const l=i.default.get("template-debug");let o;TemplateTargeting.PointGraphContainer.clear(),TemplateTargeting.PointGraphContainer.removeChildren(),l&&(o=new PIXI.Graphics,TemplateTargeting.PointGraphContainer.addChild(o));const s=r?i.default.get(TemplateTargeting.GRIDLESS_RESOLUTION_PREF):1;for(const e of canvas.tokens.placeables){const t=e.w/2,r=e.h/2,[c,d]=[e.x-a.x,e.y-a.y];let p=s>1?Math.roundDecimals(e.w/canvas.grid.w,1)*(s-1)+1:Math.ceil(e.w/canvas.grid.w),g=s>1?Math.roundDecimals(e.h/canvas.grid.h,1)*(s-1)+1:Math.ceil(e.h/canvas.grid.h);e.w/canvas.grid.w<1&&(p=Math.floor(p)),e.h/canvas.grid.h<1&&(g=Math.floor(g));const h=p>1?e.w/(p-1):e.w,u=g>1?e.h/(g-1):e.h;let T=0,f=0,m=!1;l&&o.beginFill(16711680);const E=i.default.get(TemplateTargeting.GRIDLESS_PERCENTAGE_PREF)/100,_=g*p;let M=0;for(let i=0;!m&&i<g;i++)for(let P=0;P<p;P++)if(s>1?(T=p>1?c+h*P:c+t,f=g>1?d+u*i:d+r):(T=p>1?c+canvas.grid.w*P+canvas.grid.w/2:c+t,f=g>1?d+canvas.grid.h*i+canvas.grid.h/2:d+r),l&&o.drawCircle(T+a.x,f+a.y,3),n.contains(T,f)&&(M++,(0===E||Math.roundDecimals(M/_,1)>=E)&&(e.setTarget(!0,{user:game.user,releaseOthers:!1,groupSelection:!0}),!l))){m=!0;break}l&&o.endFill()}}}TemplateTargeting.PREVIEW_PREF="template-preview",TemplateTargeting.TARGETING_TOGGLE_PREF="template-targeting-toggle",TemplateTargeting.TARGETING_MODE_PREF="template-targeting",TemplateTargeting.GRIDLESS_RESOLUTION_PREF="template-gridless-resolution",TemplateTargeting.GRIDLESS_PERCENTAGE_PREF="template-gridless-percentage",TemplateTargeting.PointGraphContainer=new PIXI.Graphics},(e,t,a)=>{var i;a.r(t),a.d(t,{default:()=>LineToBoxCollision}),function(e){e[e.INSIDE=0]="INSIDE",e[e.LEFT=1]="LEFT",e[e.RIGHT=16]="RIGHT",e[e.BOTTOM=256]="BOTTOM",e[e.TOP=4096]="TOP"}(i||(i={}));class LineToBoxCollision{static _computeOutCode(e,t,a){let n;return n=i.INSIDE,e<=a.left?n|=i.LEFT:e>=a.right&&(n|=i.RIGHT),t<=a.top?n|=i.BOTTOM:t>=a.bottom&&(n|=i.TOP),n}static cohenSutherlandLineClipAndDraw(e,t,a,n,r){let l=this._computeOutCode(e,t,r),o=this._computeOutCode(a,n,r),s=!1;for(;;){if(!(l|o)){s=!0;break}if(l&o)break;{let[s,c]=[0,0];const d=o>l?o:l;d&i.TOP?(s=e+(a-e)*(r.bottom-t)/(n-t),c=r.bottom-1):d&i.BOTTOM?(s=e+(a-e)*(r.top-t)/(n-t),c=r.top+1):d&i.RIGHT?(c=t+(n-t)*(r.right-e)/(a-e),s=r.right-1):d&i.LEFT&&(c=t+(n-t)*(r.left-e)/(a-e),s=r.left+1),d==l?(e=s,t=c,l=this._computeOutCode(e,t,r)):(a=s,n=c,o=this._computeOutCode(a,n,r))}}return s}}},(e,t,a)=>{a.r(t),a.d(t,{HighlightMode:()=>i,TemplateConfig:()=>TemplateConfig});var i,n=a(1);!function(e){e.CENTER="center",e.TOUCH="touch",e.POINTS="points"}(i||(i={}));class TemplateConfig extends FormApplication{static get options(){var e;if(!this._options){const t=(null!==(e=game.i18n.translations.DF_TEMPLATES)&&void 0!==e?e:game.i18n._fallback.DF_TEMPLATES).TemplateConfig.Options;this._options=Object.keys(t).map((e=>(t[e].type=e,t[e])))}return this._options}static get defaultOptions(){return mergeObject(super.defaultOptions,{resizable:!1,submitOnChange:!1,closeOnSubmit:!0,editable:!0,submitOnClose:!1,width:500,popOut:!0,minimizable:!1,title:"DF_TEMPLATES.TemplateConfig.Title",template:"modules/df-templates/templates/template-config.hbs"})}static get config(){return n.default.get(this.CONFIG_PREF)}static get isNotDefault(){const e=this.config;return e.circle!==i.CENTER||e.cone!==i.CENTER||e.rect!==i.CENTER||e.ray!==i.CENTER}static init(){n.default.register(this.PATCH_5E_PREF,{config:!1,type:Boolean,default:!1,scope:"world"}),n.default.register(this.PATCH_5E_CIRCLE_PREF,{config:!1,type:Boolean,default:!1,scope:"world"});const e=n.default.get(this.PATCH_5E_PREF),t=n.default.get(this.PATCH_5E_CIRCLE_PREF);n.default.register(this.CONFIG_PREF,{config:!1,scope:"world",type:Object,default:{circle:t?i.TOUCH:i.CENTER,cone:e?i.TOUCH:i.CENTER,rect:e?i.TOUCH:i.CENTER,ray:e?i.TOUCH:i.CENTER},onChange:()=>{var e;return null===(e=canvas.templates)||void 0===e?void 0:e.placeables.filter((e=>"circle"===e.data.t)).forEach((e=>e.draw()))}}),n.default.registerMenu("template-config",{restricted:!0,type:TemplateConfig,label:"DF_TEMPLATES.TemplateConfig.Title"})}getData(e){return mergeObject(TemplateConfig.config,{options:TemplateConfig.options})}activateListeners(e){e.find("#dfte-set-foundry").on("click",(t=>{t.preventDefault(),e.find('select[name="circle"]').val(i.CENTER),e.find('select[name="cone"]').val(i.CENTER),e.find('select[name="rect"]').val(i.CENTER),e.find('select[name="ray"]').val(i.CENTER)})),e.find("#dfte-set-dnd5e").on("click",(t=>{t.preventDefault(),e.find('select[name="circle"]').val(i.CENTER),e.find('select[name="cone"]').val(i.TOUCH),e.find('select[name="rect"]').val(i.TOUCH),e.find('select[name="ray"]').val(i.TOUCH)})),e.find("#cancel").on("click",(e=>{e.preventDefault(),this.close()}))}async _updateObject(e,t){await n.default.set(TemplateConfig.CONFIG_PREF,t)}}TemplateConfig.CONFIG_PREF="template-config",TemplateConfig.PATCH_5E_PREF="template-targeting-patch5e",TemplateConfig.PATCH_5E_CIRCLE_PREF="template-targeting-patch5e-circle"}],t={};function __webpack_require__(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};(()=>{__webpack_require__.r(a);var e=__webpack_require__(1),t=__webpack_require__(2),i=__webpack_require__(3),n=__webpack_require__(4),r=__webpack_require__(5);e.default.init("df-templates"),Hooks.once("init",(function(){r.default.init(),i.default.init(),t.default.init(),n.default.init(),e.default.register("template-debug",{config:!0,scope:"client",name:"DF_TEMPLATES.DebugName",hint:"DF_TEMPLATES.DebugHint",type:Boolean,default:!1})})),Hooks.once("ready",(function(){var a;if(!(null===(a=game.modules.get("lib-wrapper"))||void 0===a?void 0:a.active))return console.error("Missing libWrapper module dependency"),void(game.user.isGM&&ui.notifications.error(game.i18n.localize("DF-QOL.errorLibWrapperMissing")));r.default.ready(),i.default.ready(),t.default.ready(),game.dnd5e&&libWrapper.register(e.default.MOD_NAME,"game.dnd5e.canvas.AbilityTemplate.prototype.activatePreviewListeners",(function(e){const a={};a.rc=t=>{var i;this.layer._onDragLeftCancel(t),canvas.stage.off("mousemove",a.mm),canvas.stage.off("mousedown",a.lc),canvas.app.view.oncontextmenu=null,canvas.app.view.onwheel=null,e.activate(),null===(i=this.actorSheet)||void 0===i||i.maximize()},a.lc=e=>{a.rc(e);const t=canvas.grid.getSnappedPosition(this.data.x,this.data.y,2);this.data.update(t),canvas.scene.createEmbeddedDocuments("MeasuredTemplate",[this.data])},i.default.handleDnD5eAbilityTemplate(this,a),t.default.handleDnD5eAbilityTemplate(this,a),canvas.stage.on("mousemove",a.mm),canvas.stage.on("mousedown",a.lc),canvas.app.view.oncontextmenu=a.rc,canvas.app.view.onwheel=a.mw}),"OVERRIDE")}))})()})();
//# sourceMappingURL=main.js.map