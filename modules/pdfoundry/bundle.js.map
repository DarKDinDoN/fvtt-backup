{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/pdfoundry/Api.ts","src/pdfoundry/Main.ts","src/pdfoundry/Settings.ts","src/pdfoundry/Setup.ts","src/pdfoundry/Util.ts","src/pdfoundry/app/ActorSheetSelect.ts","src/pdfoundry/app/PDFActorDataBrowser.ts","src/pdfoundry/app/PDFActorSheetAdapter.ts","src/pdfoundry/app/PDFConfig.ts","src/pdfoundry/app/PlayerSelect.ts","src/pdfoundry/app/SelectApp.ts","src/pdfoundry/cache/CacheError.ts","src/pdfoundry/cache/CacheHelper.ts","src/pdfoundry/cache/PDFCache.ts","src/pdfoundry/commands/ChatCommand.ts","src/pdfoundry/commands/FixMissingTypes.ts","src/pdfoundry/commands/PurgeCache.ts","src/pdfoundry/common/Whitelist.ts","src/pdfoundry/common/helpers/events.ts","src/pdfoundry/common/helpers/header.ts","src/pdfoundry/common/types/PDFType.ts","src/pdfoundry/enricher/HTMLEnricher.ts","src/pdfoundry/enricher/TinyMCEPlugin.ts","src/pdfoundry/migrate/MigrateLegacy.ts","src/pdfoundry/socket/Socket.ts","src/pdfoundry/socket/events/PreloadEvent.ts","src/pdfoundry/socket/events/SetViewEvent.ts","src/pdfoundry/socket/events/SocketEvent.ts","src/pdfoundry/viewer/ActorViewer.ts","src/pdfoundry/viewer/BaseViewer.ts","src/pdfoundry/viewer/FillableViewer.ts","src/pdfoundry/viewer/StaticViewer.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The PDFoundry API.\n *\n * You can access the API with `ui.PDFoundry`.\n * @moduledefinition API\n */\n\nimport {\n    canOpenPDF,\n    deletePDFData,\n    getAbsoluteURL,\n    getPDFData,\n    getRoutePrefix,\n    getUserIdsExceptMe,\n    isEntityPDF,\n    setPDFData,\n    validateAbsoluteURL,\n} from './Util';\nimport StaticViewer from './viewer/StaticViewer';\nimport { PDFData } from './common/types/PDFData';\nimport Settings from './Settings';\nimport PDFCache from './cache/PDFCache';\nimport BaseViewer from './viewer/BaseViewer';\nimport { PDFType } from './common/types/PDFType';\nimport FillableViewer from './viewer/FillableViewer';\n\n// noinspection JSUnusedGlobalSymbols\n\n/**\n * A function to passed to {@link Api.findPDFData} to find user specified PDF data.\n * @module API\n */\nexport type PDFValidator = (data: PDFData) => boolean;\n\n/**\n * Open the specified PDF in a provided viewer\n * @param viewer\n * @param url\n * @param page\n * @param cache\n * @internal\n */\nexport async function _handleOpen(viewer: BaseViewer, url: string, page: number | undefined, cache: boolean) {\n    if (cache) {\n        const cachedBytes = await PDFCache.getCache(url);\n        // If we have a cache hit open the cached data\n        if (cachedBytes) {\n            await viewer.open(cachedBytes, page);\n        } else {\n            // Otherwise we should open it by url\n            await viewer.open(url, page);\n            // And when the download is complete set the cache\n            viewer.download().then((bytes) => {\n                PDFCache.setCache(url, bytes);\n            });\n        }\n    } else {\n        await viewer.open(url, page);\n    }\n}\n\n/**\n * Options passed to the {@link Api.openPDF} function.\n * @module API\n */\nexport interface PDFOpenOptions {\n    /**\n     * The page to open to. If not specified, PDFoundry will attempt to open the\n     *  last page the user was viewing.\n     */\n    page?: number;\n    /**\n     * If you're opening a fillable pdf, you must specify an entity for data storage.\n     */\n    entity?: JournalEntry;\n}\n\n/**\n * A definition for a viewer theme.\n * @module API\n */\nexport interface ViewerTheme {\n    /**\n     *\n     */\n    id: string;\n    name: string;\n    filePath: string;\n}\n\n/**\n * The PDFoundry API\n *\n * You can access the API with `ui.PDFoundry`.\n * @module API\n */\nexport default class Api {\n    /**\n     * Enable additional debug information for the specified category.\n     * @category Debug\n     */\n    public static DEBUG = {\n        // TODO\n        /**\n         * When set to true, enables the logging event names and arguments to console.\n         */\n        EVENTS: false,\n    };\n\n    // <editor-fold desc=\"Static Methods\">\n\n    private static _availableThemes: { [id: string]: ViewerTheme } = {};\n\n    /**\n     * Get a full theme definition by id.\n     * @param id The unique id of the theme to lookup.\n     */\n    public static getTheme(id: string): ViewerTheme | null {\n        return Api._availableThemes[id] ?? null;\n    }\n\n    /**\n     * Get the currently enabled theme id.\n     */\n    public static get activeTheme(): ViewerTheme {\n        const id = Settings.get(Settings.SETTINGS_KEY.VIEWER_THEME);\n        return Api._availableThemes[id];\n    }\n\n    /**\n     * Get a map of themes available for use.\n     */\n    public static get availableThemes() {\n        const themesMap = {};\n        for (const key of Object.keys(Api._availableThemes)) {\n            themesMap[key] = Api._availableThemes[key].name;\n        }\n        return themesMap;\n    }\n\n    /**\n     * Register a theme for use with PDFoundry. You must register a theme before `ready`. Do so in `setup`.\n     * @param id The unique id of the theme. Providing an already existing id will over-write the existing theme.\n     * @param name The user-facing display name of the theme.\n     * @param filePath The relative path of the theme css file\n     */\n    public static registerTheme(id: string, name: string, filePath: string) {\n        if (!filePath.endsWith('.css')) {\n            throw new Error('You may only register css files as themes.');\n        }\n\n        if (Api._availableThemes.hasOwnProperty(id)) {\n            console.warn(`PDFoundry theme with id of \"${id}\" is already registered!`);\n        }\n\n        this._availableThemes[id] = {\n            id,\n            name,\n            filePath,\n        };\n    }\n\n    // </editor-fold>\n\n    /**\n     * A reference to the unclassified utility functions.\n     * @category Utility\n     */\n    public static get Utilities() {\n        return {\n            getRoutePrefix,\n            getAbsoluteURL,\n            validateAbsoluteURL,\n            isEntityPDF,\n            getPDFData,\n            setPDFData,\n            deletePDFData,\n            canOpenPDF,\n            getUserIdsExceptMe,\n        };\n    }\n\n    // <editor-fold desc=\"GetPDFData Methods\">\n\n    /**\n     * Find a PDF containing journal entry from the journals directory using a specified comparer.\n     * @param comparer The function to compare PDF data with.\n     * @param allowInvisible If true, PDFs hidden from the active user will be returned.\n     * @category PDFData\n     */\n    public static findPDFEntity(comparer: PDFValidator, allowInvisible: boolean = true): JournalEntry | null {\n        return game.journal.find((journalEntry: JournalEntry) => {\n            if (!isEntityPDF(journalEntry)) {\n                return false;\n            }\n\n            const pdfData = getPDFData(journalEntry);\n            if (pdfData === undefined) {\n                return false;\n            }\n\n            return (journalEntry.visible || allowInvisible) && comparer(pdfData);\n        });\n    }\n\n    /**\n     * Helper method. Alias for {@link Api.findPDFData} with a comparer that searches by PDF Code.\n     * @param code Which code to search for a PDF with.\n     * @param allowInvisible See allowVisible on {@link findPDFEntity}\n     * @category PDFData\n     */\n    public static findPDFDataByCode(code: string, allowInvisible: boolean = true): PDFData | undefined {\n        return Api.findPDFData((data: PDFData) => {\n            return data.code === code;\n        }, allowInvisible);\n    }\n\n    /**\n     * Helper method. Alias for {@link Api.findPDFData} with a comparer that searches by PDF Name.\n     * @param name Which name to search for a PDF with.\n     * @param caseInsensitive If a case insensitive search should be done.\n     * @param allowInvisible See allowVisible on {@link findPDFEntity}\n     * @category PDFData\n     */\n    public static findPDFDataByName(name: string, caseInsensitive: boolean = true, allowInvisible: boolean = true): PDFData | undefined {\n        if (caseInsensitive) {\n            return Api.findPDFData((data) => {\n                return data.name.toLowerCase() === name.toLowerCase();\n            }, allowInvisible);\n        } else {\n            return Api.findPDFData((data) => {\n                return data.name === name;\n            }, allowInvisible);\n        }\n    }\n\n    /**\n     * Finds a PDF entity created by the user and constructs a {@link PDFData} object of the resulting PDF's data.\n     * @param comparer A comparison function that will be used.\n     * @param allowInvisible See allowVisible on {@link findPDFEntity}\n     * @category PDFData\n     */\n    public static findPDFData(comparer: PDFValidator, allowInvisible: boolean = true): PDFData | undefined {\n        const pdf = this.findPDFEntity(comparer, allowInvisible);\n        if (pdf === null) {\n            return undefined;\n        }\n\n        return getPDFData(pdf);\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"OpenPDF Methods\">\n\n    /**\n     * Open the PDF with the provided code to the specified page.\n     * Helper for {@link findPDFDataByCode} then {@link openPDF}.\n     * @category Open\n     */\n    public static async openPDFByCode(code: string, options?: PDFOpenOptions): Promise<BaseViewer> {\n        const pdf = this.findPDFDataByCode(code);\n\n        if (pdf === undefined) {\n            const error = game.i18n.localize('PDFOUNDRY.ERROR.NoPDFWithCode');\n\n            ui.notifications.error(error);\n\n            return Promise.reject(error);\n        }\n\n        return this.openPDF(pdf, options);\n    }\n\n    /**\n     * Open the PDF with the provided code to the specified page.\n     * Helper for {@link findPDFDataByCode} then {@link openPDF}.\n     * @category Open\n     */\n    public static async openPDFByName(name: string, options?: PDFOpenOptions): Promise<BaseViewer> {\n        const pdf = this.findPDFDataByName(name);\n\n        if (pdf === undefined) {\n            const message = game.i18n.localize('PDFOUNDRY.ERROR.NoPDFWithName');\n            const error = new Error(message);\n\n            ui.notifications.error(error.message);\n\n            return Promise.reject(error);\n        }\n\n        return this.openPDF(pdf, options);\n    }\n\n    /**\n     * Open the provided {@link PDFData} to the specified page.\n     * @param pdf The PDF to open. See {@link Api.findPDFData}.\n     * @param options The specified options for PDFs.\n     * @category Open\n     */\n    public static async openPDF(pdf: PDFData, options?: PDFOpenOptions): Promise<BaseViewer> {\n        if (options === undefined) {\n            options = {};\n        }\n\n        let { url, offset, cache } = pdf;\n\n        if (typeof offset === 'string') {\n            if (offset === '') {\n                offset = 0;\n            } else {\n                offset = parseInt(offset);\n            }\n        } else if (offset === null) {\n            offset = 0;\n        }\n\n        if (!validateAbsoluteURL(url)) {\n            url = getAbsoluteURL(url);\n        }\n\n        if (options.page !== undefined) {\n            options.page = options.page + offset;\n        }\n\n        let viewer: BaseViewer;\n\n        switch (pdf.type) {\n            case PDFType.Static:\n                viewer = new StaticViewer(pdf);\n                viewer.render(true);\n\n                await _handleOpen(viewer, url, options.page, cache);\n                break;\n            case PDFType.Fillable:\n                if (!(options.entity instanceof JournalEntry)) {\n                    throw new Error('Provided entity was not a journal entry.');\n                }\n\n                viewer = new FillableViewer(options.entity, pdf);\n                viewer.render(true);\n\n                await _handleOpen(viewer, url, options.page, cache);\n                break;\n            case PDFType.Actor:\n                throw new Error('Actor sheets can only be opened through the actor.sheet accessor.');\n        }\n        return viewer;\n    }\n\n    /**\n     * Open a URL as a static PDF. For form fillable PDFs you muse use {@link Api.openPDF}\n     * @param url The URL to open (must be absolute).\n     * @param page Which page to open to. Must be >= 1.\n     * @param cache If URL based caching should be used.\n     * @category Open\n     */\n    public static async openURL(url: string, page: number = 1, cache: boolean = true): Promise<BaseViewer> {\n        if (isNaN(page) || page <= 0) {\n            throw new Error(`Page must be > 0, but ${page} was given.`);\n        }\n\n        if (!validateAbsoluteURL(url)) {\n            url = getAbsoluteURL(url);\n        }\n\n        const viewer = new StaticViewer();\n        viewer.render(true);\n\n        await _handleOpen(viewer, url, page, cache);\n\n        return viewer;\n    }\n\n    /**\n     * Shows the user manual to the active user.\n     * @category Utility\n     */\n    public static async showHelp(): Promise<BaseViewer> {\n        await Settings.set(Settings.SETTINGS_KEY.HELP_SEEN, true);\n\n        const lang = game.i18n.lang;\n        let manualPath = getAbsoluteURL(`${Settings.PATH_ASSETS}/manual/${lang}/manual.pdf`);\n        // @ts-ignore\n        const manualExists = await srcExists(manualPath);\n\n        if (!manualExists) {\n            manualPath = getAbsoluteURL(`${Settings.PATH_ASSETS}/manual/en/manual.pdf`);\n        }\n\n        const pdfData: PDFData = {\n            name: game.i18n.localize('PDFOUNDRY.MANUAL.Name'),\n            type: PDFType.Static,\n            code: '',\n            offset: 0,\n            url: manualPath,\n            cache: false,\n        };\n\n        return Api.openPDF(pdfData);\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Setup from './Setup';\n\nSetup.run();\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Api from './Api';\n\n/**\n * Internal settings and helper methods for PDFoundry.\n * @internal\n */\nexport default class Settings {\n    public static readonly MODULE_NAME: string = 'pdfoundry';\n\n    public static get PATH_MODULE() {\n        return `modules/${Settings.MODULE_NAME}`;\n    }\n    public static get PATH_ASSETS() {\n        return `${Settings.PATH_MODULE}/assets`;\n    }\n    public static get PATH_LOCALE() {\n        return `${Settings.PATH_MODULE}/locale`;\n    }\n    public static get PATH_TEMPLATES() {\n        return `${Settings.PATH_MODULE}/templates`;\n    }\n    public static get PATH_PDFJS() {\n        return `${Settings.PATH_MODULE}/pdfjs`;\n    }\n\n    public static get SOCKET_NAME() {\n        return `module.${Settings.MODULE_NAME}`;\n    }\n\n    public static readonly CSS_CLASS = 'pdf-app';\n\n    public static readonly MENU_KEY = 'PDFoundrySettings';\n\n    public static readonly SETTINGS_KEY = {\n        EXISTING_VIEWER: 'ShowInExistingViewer',\n        CACHE_SIZE: 'CacheSize',\n        VIEWER_THEME: 'ViewerTheme',\n        HELP_SEEN: 'HelpSeen',\n        DATA_VERSION: 'DataVersion',\n    };\n    public static readonly FLAGS_KEY = {\n        // PDF Data\n        PDF_DATA: 'PDFData',\n        // Actor Sheets\n        FORM_DATA: 'FormData',\n        SHEET_ID: 'ActorSheet',\n        // Canvas Notes\n        PAGE_NUMBER: 'PageNumber',\n    };\n\n    public static initialize() {\n        Settings.register(Settings.SETTINGS_KEY.CACHE_SIZE, {\n            name: game.i18n.localize('PDFOUNDRY.SETTINGS.CacheSizeName'),\n            hint: game.i18n.localize('PDFOUNDRY.SETTINGS.CacheSizeHint'),\n            scope: 'user',\n            type: Number,\n            default: 256,\n            config: true,\n            onChange: async (mb) => {\n                if (Settings.get(Settings.SETTINGS_KEY.CACHE_SIZE) === mb) {\n                    return;\n                }\n\n                mb = Math.round(mb);\n                mb = Math.max(mb, 64);\n                mb = Math.min(mb, 1024);\n                await Settings.set(Settings.SETTINGS_KEY.CACHE_SIZE, mb);\n            },\n        });\n\n        Settings.register(Settings.SETTINGS_KEY.EXISTING_VIEWER, {\n            name: game.i18n.localize('PDFOUNDRY.SETTINGS.ShowInExistingViewerName'),\n            hint: game.i18n.localize('PDFOUNDRY.SETTINGS.ShowInExistingViewerHint'),\n            scope: 'user',\n            type: Boolean,\n            default: true,\n            config: true,\n        });\n\n        Settings.register(Settings.SETTINGS_KEY.VIEWER_THEME, {\n            name: game.i18n.localize('PDFOUNDRY.SETTINGS.ViewerThemeName'),\n            hint: game.i18n.localize('PDFOUNDRY.SETTINGS.ViewerThemeHint'),\n            scope: 'user',\n            type: String,\n            default: 'fantasy',\n            choices: Api.availableThemes,\n            config: true,\n        });\n\n        Settings.register(Settings.SETTINGS_KEY.HELP_SEEN, {\n            scope: 'user',\n            type: Boolean,\n            default: false,\n            config: false,\n        });\n\n        Settings.register(Settings.SETTINGS_KEY.DATA_VERSION, {\n            scope: 'world',\n            type: String,\n            default: undefined,\n            config: false,\n        });\n    }\n\n    /**\n     * Wrapper around game.settings.register. Ensures scope is correct.\n     * @param key\n     * @param data\n     * @internal\n     */\n    public static register(key: string, data: any) {\n        game.settings.register(Settings.MODULE_NAME, key, data);\n    }\n\n    /**\n     * Wrapper around game.settings.get. Ensures scope is correct.\n     * @param key\n     * @internal\n     */\n    public static get(key: string) {\n        return game.settings.get(Settings.MODULE_NAME, key);\n    }\n\n    /**\n     * Wrapper around game.settings.set. Ensures scope is correct.\n     * @param key\n     * @param value\n     * @internal\n     */\n    public static async set(key: string, value: any) {\n        return game.settings.set(Settings.MODULE_NAME, key, value);\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getAbsoluteURL, getPDFData, isEntityPDF } from './Util';\nimport PreloadEvent from './socket/events/PreloadEvent';\nimport { Socket } from './socket/Socket';\nimport Settings from './Settings';\nimport PDFCache from './cache/PDFCache';\nimport Api, { ViewerTheme } from './Api';\nimport HTMLEnricher from './enricher/HTMLEnricher';\nimport TinyMCEPlugin from './enricher/TinyMCEPlugin';\nimport PDFActorSheetAdapter from './app/PDFActorSheetAdapter';\nimport { PDFType } from './common/types/PDFType';\nimport { PDFConfig } from './app/PDFConfig';\nimport FixMissingTypes from './commands/FixMissingTypes';\nimport PurgeCache from './commands/PurgeCache';\nimport { legacyMigrationRequired, migrateLegacy } from './migrate/MigrateLegacy';\n\n/**\n * A collection of methods used for setting up the API & system state.\n * @internal\n */\nexport default class Setup {\n    /**\n     * Run setup tasks.\n     */\n    public static run() {\n        if (hasProperty(ui, 'PDFoundry')) {\n            Hooks.once('init', async () => {\n                let d = new Dialog({\n                    title: 'PDFoundry: Error',\n                    content: [\n                        '<div style=\"text-align: justify; margin: 0; padding: 0;\">',\n                        '<h1 style=\"color: red\">PDFoundry Is Already Installed</h1>',\n                        '<p style=\"font-weight: bold\">You have enabled the module version of PDFoundry, but the system you ' +\n                            'are using already has PDFoundry installed.</p>',\n                        '<p>1. If you installed PDFoundry using a nightly build, uninstall and reinstall your system with the ' +\n                            '\"Game Systems\" menu in Foundry VTT setup, or simply update the system if an update is available. ' +\n                            'Your world data is safe either way.</p>',\n                        '<p>2. If the system you are using comes with PDFoundry already installed - you must use that version of ' +\n                            'PDFoundry by disabling the module version.</p>',\n                        '<p style=\"font-weight: bold\">The module version of PDFoundry will not function.</p>',\n                        '</div>',\n                    ].join(''),\n                    buttons: {},\n                });\n                d.render(true);\n            });\n            return;\n        }\n\n        // Register the PDFoundry APi on the UI\n        ui['PDFoundry'] = Api;\n\n        // Register the PDF sheet with the class picker\n        Setup.setupSheets();\n\n        // Setup tasks requiring that FVTT is loaded\n        Hooks.once('ready', Setup.lateRun);\n\n        Hooks.on('renderJournalDirectory', Setup.createJournalButton);\n        Hooks.on('renderJournalDirectory', Setup.hookListItems);\n\n        // getItemDirectoryEntryContext - Setup context menu for 'Open PDF' links\n        Hooks.on('getJournalDirectoryEntryContext', Setup.getJournalContextOptions);\n\n        // Cogwheel settings menu\n        Hooks.on('renderSettings', Setup.onRenderSettings);\n\n        // Load base themes\n        Setup.registerThemes();\n\n        // Patch the TextEnricher with a proxy\n        HTMLEnricher.patchEnrich();\n        // Bind click handlers to renderers\n        Hooks.on('renderApplication', (app: Application, html: JQuery) => HTMLEnricher.bindRichTextLinks(html));\n        Hooks.on('renderItemSheet', (app: Application, html: JQuery) => HTMLEnricher.bindRichTextLinks(html));\n        Hooks.on('renderActorSheet', (app: Application, html: JQuery) => HTMLEnricher.bindRichTextLinks(html));\n        Hooks.on('renderChatMessage', (app: Application, html: JQuery) => HTMLEnricher.bindRichTextLinks(html));\n    }\n\n    private static readonly COMMANDS = [new FixMissingTypes(), new PurgeCache()];\n\n    /**\n     * Late setup tasks happen when the system is loaded\n     */\n    public static lateRun() {\n        // Register socket event handlers\n        Socket.initialize();\n\n        // Chat command processing\n        Hooks.on('chatMessage', Setup.onChatMessage);\n\n        // Canvas notes processing\n        Hooks.on('renderNoteConfig', Setup.onNoteConfig);\n        Hooks.on('hoverNote', Setup.onNoteHover);\n\n        // Register TinyMCE drag + drop events\n        TinyMCEPlugin.Register();\n\n        return new Promise(async () => {\n            // Initialize the settings\n            Settings.initialize();\n            await PDFCache.initialize();\n\n            if (legacyMigrationRequired()) {\n                migrateLegacy().then(() => {\n                    Settings.set(Settings.SETTINGS_KEY.DATA_VERSION, 'v0.6.0');\n                });\n            }\n\n            // PDFoundry is ready\n            Setup.userLogin();\n        });\n    }\n\n    /**\n     * Register the PDF sheet and unregister invalid sheet types from it.\n     */\n    public static setupSheets() {\n        // Register actor \"sheet\"\n        Actors.registerSheet(Settings.MODULE_NAME, PDFActorSheetAdapter);\n    }\n\n    /**\n     * Get additional context menu icons for PDF items\n     * @param html\n     * @param options\n     */\n    public static getJournalContextOptions(html: JQuery, options: any[]) {\n        const getJournalEntryFromLi = (html: JQuery): JournalEntry => {\n            const id = html.data('entity-id');\n            return game.journal.get(id);\n        };\n\n        const shouldAdd = (entityHtml: JQuery) => {\n            const journalEntry = getJournalEntryFromLi(entityHtml);\n            return isEntityPDF(journalEntry) && getPDFData(journalEntry)?.type !== PDFType.Actor;\n        };\n\n        if (game.user.isGM) {\n            options.unshift({\n                name: game.i18n.localize('PDFOUNDRY.CONTEXT.PreloadPDF'),\n                icon: '<i class=\"fas fa-download fa-fw\"></i>',\n                condition: shouldAdd,\n                callback: (entityHtml: JQuery) => {\n                    const journalEntry = getJournalEntryFromLi(entityHtml);\n                    const pdf = getPDFData(journalEntry);\n\n                    if (pdf === undefined) {\n                        return;\n                    }\n\n                    const { url } = pdf;\n                    const event = new PreloadEvent(null, getAbsoluteURL(url));\n                    event.emit();\n\n                    PDFCache.preload(url);\n                },\n            });\n        }\n\n        options.unshift({\n            name: game.i18n.localize('PDFOUNDRY.CONTEXT.OpenPDF'),\n            icon: '<i class=\"far fa-file-pdf\"></i>',\n            condition: shouldAdd,\n            callback: (entityHtml: JQuery) => {\n                const journalEntry = getJournalEntryFromLi(entityHtml);\n                const pdf = getPDFData(journalEntry);\n\n                if (pdf === undefined) {\n                    return;\n                }\n\n                if (pdf.type === PDFType.Actor) {\n                    throw new Error(`Unhandled PDF context type ${pdf.type}`);\n                } else {\n                    Api.openPDF(pdf, {\n                        entity: journalEntry,\n                    });\n                }\n            },\n        });\n    }\n\n    private static userLogin() {\n        if (!game.user.isGM) {\n            return;\n        }\n\n        let viewed;\n        try {\n            viewed = Settings.get(Settings.SETTINGS_KEY.HELP_SEEN);\n        } catch (error) {\n            viewed = false;\n        } finally {\n            if (!viewed) {\n                Api.showHelp();\n            }\n        }\n    }\n\n    private static onChatMessage(app, content: string, options) {\n        content = content.toLocaleLowerCase();\n\n        for (let command of Setup.COMMANDS) {\n            if (command.execute(content)) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    /**\n     * Hook handler for rendering the settings tab\n     */\n    public static onRenderSettings(settings: any, html: JQuery, data: any) {\n        const icon = '<i class=\"far fa-file-pdf\"></i>';\n        const button = $(`<button>${icon} ${game.i18n.localize('PDFOUNDRY.SETTINGS.OpenHelp')}</button>`);\n        button.on('click', Api.showHelp);\n\n        html.find('#settings-documentation').append(button);\n    }\n\n    private static async createPDF() {\n        const journalEntry = (await JournalEntry.create({\n            name: game.i18n.localize('PDFOUNDRY.MISC.NewPDF'),\n            [`flags.${Settings.MODULE_NAME}.${Settings.FLAGS_KEY.PDF_DATA}.type`]: PDFType.Static,\n        })) as JournalEntry;\n\n        new PDFConfig(journalEntry).render(true);\n    }\n\n    private static createJournalButton(app: Application, html: JQuery) {\n        if (!game.user.isGM) {\n            return;\n        }\n\n        const button = $(`<button class=\"create-pdf\"><i class=\"fas fa-file-pdf\"></i> ${game.i18n.localize('PDFOUNDRY.MISC.CreatePDF')}</button>`);\n        button.on('click', () => {\n            Setup.createPDF();\n        });\n\n        let footer = html.find('.directory-footer');\n        if (footer.length === 0) {\n            footer = $(`<footer class=\"directory-footer\"></footer>`);\n            html.append(footer);\n        }\n        footer.append(button);\n    }\n\n    private static hookListItems(app: Application, html: JQuery) {\n        const lis = html.find('li.journal');\n\n        for (const li of lis) {\n            const target = $(li);\n            const id = target.data('entity-id');\n            const journalEntry = game.journal.get(id);\n\n            if (isEntityPDF(journalEntry)) {\n                target.find('h4').on('click', (event) => {\n                    event.stopImmediatePropagation();\n                    // @ts-ignore\n                    if (journalEntry.isOwner) {\n                        Setup.onClickPDFName(journalEntry);\n                    } else {\n                        Setup.onClickPDFThumbnail(journalEntry);\n                    }\n                });\n\n                const pdfData = getPDFData(journalEntry);\n                if (pdfData) {\n                    const thumbnail = $(`<img class=\"pdf-thumbnail\" src=\"${Settings.PATH_ASSETS}/pdf_icon.svg\" alt=\"PDF Icon\">`);\n                    target.append(thumbnail);\n\n                    switch (pdfData.type) {\n                        case PDFType.Static:\n                        case PDFType.Fillable:\n                            target.find('img').on('click', (event) => {\n                                event.stopImmediatePropagation();\n                                Setup.onClickPDFThumbnail(journalEntry);\n                            });\n                            break;\n                        case PDFType.Actor:\n                            // Actors can't be opened by link\n                            thumbnail.css('filter', 'grayscale(100%)');\n                            break;\n                    }\n                }\n            }\n        }\n    }\n\n    private static onClickPDFName(journalEntry: JournalEntry) {\n        new PDFConfig(journalEntry).render(true);\n    }\n\n    private static onClickPDFThumbnail(journalEntry: JournalEntry) {\n        const pdfData = getPDFData(journalEntry);\n        if (pdfData) {\n            switch (pdfData.type) {\n                case PDFType.Static:\n                    Api.openPDF(pdfData);\n                    break;\n                case PDFType.Fillable:\n                    Api.openPDF(pdfData, {\n                        entity: journalEntry,\n                    });\n                    break;\n                case PDFType.Actor:\n                    // Pass - no functionality\n                    break;\n            }\n        }\n    }\n\n    private static onNoteConfig(app: NoteConfig, html: JQuery, data: any) {\n        const journalId = data.data.entryId;\n        const journal = game.journal.get(journalId);\n        if (isEntityPDF(journal)) {\n            const container = $(`<div class=\"form-group\"></div>`);\n            const label = $(`<label>${game.i18n.localize('PDFOUNDRY.COMMON.PageNumber')}</label>`);\n\n            let pageNumber = data.data['flags']?.[Settings.MODULE_NAME]?.[Settings.FLAGS_KEY.PAGE_NUMBER];\n            if (pageNumber === undefined) {\n                pageNumber = '';\n            }\n\n            const subContainer = $(`<div class=\"form-fields\"></div>`);\n\n            const input = $(\n                `<input type=\"number\" name=\"flags.${Settings.MODULE_NAME}.${Settings.FLAGS_KEY.PAGE_NUMBER}\" value=\"${pageNumber}\" data-dtype=\"String\">`,\n            );\n\n            subContainer.append(input);\n\n            container.append(label);\n            container.append(subContainer);\n\n            html.find('button[type=submit]').before(container);\n        }\n    }\n\n    private static onNoteHover(note: Note, enter: boolean) {\n        if (!enter) {\n            return;\n        }\n\n        const journal = note.entry as JournalEntry;\n        const pdf = getPDFData(journal);\n        if (isEntityPDF(journal) && pdf) {\n            note.mouseInteractionManager.callbacks['clickLeft2'] = () => {\n                let pageText: string | number | undefined = note.data.flags?.[Settings.MODULE_NAME]?.[Settings.FLAGS_KEY.PAGE_NUMBER];\n                let pageNumber = 0;\n\n                if (typeof pageText === 'string') {\n                    try {\n                        pageNumber = parseInt(pageText);\n                    } catch (e) {\n                        pageNumber = 0;\n                    }\n                } else if (typeof pageText === 'number') {\n                    pageNumber = pageText;\n                }\n\n                if (pageNumber === 0) {\n                    Api.openPDF(pdf);\n                } else {\n                    Api.openPDF(pdf, {\n                        page: pageNumber,\n                    });\n                }\n            };\n        }\n    }\n\n    private static registerThemes() {\n        const themes: ViewerTheme[] = [\n            {\n                id: 'fantasy',\n                name: 'Fantasy (Default)',\n                filePath: `${Settings.PATH_MODULE}/themes/fantasy.css`,\n            },\n            {\n                id: 'dark',\n                name: 'Dark',\n                filePath: `${Settings.PATH_MODULE}/themes/default-dark.css`,\n            },\n            {\n                id: 'light',\n                name: 'Light',\n                filePath: `${Settings.PATH_MODULE}/themes/default-light.css`,\n            },\n            {\n                id: 'net-runner-dark',\n                name: 'Net Runner',\n                filePath: `${Settings.PATH_MODULE}/themes/net-runner.css`,\n            },\n\n            {\n                id: 'gay-pride-light',\n                name: 'Gay Pride (Light)',\n                filePath: `${Settings.PATH_MODULE}/themes/gay-pride-light.css`,\n            },\n            {\n                id: 'gay-pride-dark',\n                name: 'Gay Pride (Dark)',\n                filePath: `${Settings.PATH_MODULE}/themes/gay-pride-dark.css`,\n            },\n            {\n                id: 'trans-light',\n                name: 'Trans Pride (Light)',\n                filePath: `${Settings.PATH_MODULE}/themes/trans-pride-light.css`,\n            },\n            {\n                id: 'trans-dark',\n                name: 'Trans Pride (Dark)',\n                filePath: `${Settings.PATH_MODULE}/themes/trans-pride-dark.css`,\n            },\n            {\n                id: 'nonbinary-light',\n                name: 'Non-binary Pride (Light)',\n                filePath: `${Settings.PATH_MODULE}/themes/nonbinary-pride-light.css`,\n            },\n            {\n                id: 'nonbinary-dark',\n                name: 'Non-binary Pride (Dark)',\n                filePath: `${Settings.PATH_MODULE}/themes/nonbinary-pride-dark.css`,\n            },\n        ];\n\n        for (const theme of themes) {\n            Api.registerTheme(theme.id, theme.name, theme.filePath);\n        }\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A collection of utilities that are used internally or made to be used externally by you.\n *\n * You can access these utilities with `ui.PDFoundry.Utilities`.\n * @moduledefinition Utilities\n */\n\nimport { PDFData, PDFDataDelete, PDFDataUpdate } from './common/types/PDFData';\nimport Settings from './Settings';\nimport { PDFType } from './common/types/PDFType';\nimport { DOMAIN_WHITELIST } from './common/Whitelist';\n\n// *************\n// URL HELPERS\n// *************\n// <editor-fold desc='URL Helpers\">\n\n/**\n * Gets the correct route prefix used to support servers using a route prefix.\n * Appended to all window.location paths.\n * @module Utilities\n */\nexport function getRoutePrefix(): string {\n    let prefixArr = window.location.pathname.split('/');\n    prefixArr.pop(); // don't want the 'game' at the end\n    return prefixArr.join('/');\n}\n\n/**\n * Convert a relative URL to a absolute URL by prepending the window origin to the relative URL.\n * If the URL is of a white listed domain, will simply return the provided URL.\n * @param dataUrl A url to be validated.\n * @see {@link DOMAIN_WHITELIST}\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function getAbsoluteURL(dataUrl: string): string {\n    // Some domains are white listed, these should be considered absolute already\n    for (const domain of DOMAIN_WHITELIST) {\n        if (dataUrl.includes(domain)) {\n            return dataUrl;\n        }\n    }\n\n    return `${window.origin}${getRoutePrefix()}/${dataUrl}`;\n}\n\n/**\n * Returns true if the URL starts with the origin or the domain is one of the\n *  white listed domains.\n * @param dataUrl A url to be validated.\n * @see {@link DOMAIN_WHITELIST}\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function validateAbsoluteURL(dataUrl: string): boolean {\n    // Some domains are white listed\n    for (const domain of DOMAIN_WHITELIST) {\n        if (dataUrl.includes(domain)) {\n            return true;\n        }\n    }\n\n    return dataUrl.startsWith(window.origin);\n}\n\n// </editor-fold>\n\n// *************\n// DATA HELPERS\n// *************\n// <editor-fold desc='Data Helpers\">\n\n/**\n * Returns true if the provided entity contains PDF data\n * @param entity The entity to check. Only JournalEntities are allowed to be PDFs natively.\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function isEntityPDF(entity: Entity): boolean {\n    return entity !== undefined && entity !== null && entity.getFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.PDF_DATA) !== undefined;\n}\n\n/**\n * Pull relevant data from an journal entry, creating a {@link PDFData} object.\n * @param journalEntry The journal entry to pull data from.\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function getPDFData(journalEntry: JournalEntry | null | undefined): PDFData | undefined {\n    if (journalEntry === undefined || journalEntry === null) {\n        return undefined;\n    }\n\n    const pdfData = journalEntry.getFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.PDF_DATA) as PDFData | undefined;\n    if (pdfData === undefined) {\n        return undefined;\n    }\n    pdfData.name = journalEntry.name;\n    return pdfData;\n}\n\n/**\n * Set one or more {@link PDFData} attributes to the provided values. Makes no changes to fields that\n *  are not specified. If you wish to update the PDF name, use Entity.update as normal in Foundry.\n * @param journalEntry The PDF to update the data on.\n * @param pdfData A partial mapping of a {@link PDFData} object.\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function setPDFData(journalEntry: JournalEntry, pdfData: Partial<PDFDataUpdate>) {\n    return journalEntry.setFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.PDF_DATA, pdfData);\n}\n\n/**\n * Deletes a key from the PDF data. Requires the value of the key to be set to null.\n * @param journalEntry The journal entry to delete the key from.\n * @param pdfData A mapping of {key: null} pairs to delete.\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function deletePDFData(journalEntry: JournalEntry, pdfData: Partial<PDFDataDelete>) {\n    const update = {};\n\n    // TODO: Feature request to use Symbols to perform this type of operation\n    for (const key of Object.keys(pdfData)) {\n        update[`flags.${Settings.MODULE_NAME}.${Settings.FLAGS_KEY.PDF_DATA}.-=${key}`] = null;\n    }\n\n    return journalEntry.update(update);\n}\n\n/**\n * Returns true or false if all required data is set such that the PDF is possible to open.\n *  Does not guarantee any specific data for a type of open (e.g. opening as a fillable PDF)\n *  only that the static viewer is able to open the PDF.\n * @param pdfData The PDF data to check.\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function canOpenPDF(pdfData: PDFData) {\n    if (PDFType[pdfData.type] === undefined) {\n        return false;\n    }\n\n    return !(pdfData.url === undefined || pdfData.url === '');\n}\n\n// </editor-fold>\n\n// *************\n// USER HELPERS\n// *************\n// <editor-fold desc='User Helpers\">\n/**\n * Return all users ids except the current user\n * @see {@link Api.Utilities}\n * @module Utilities\n */\nexport function getUserIdsExceptMe() {\n    return game.users\n        .filter((user: User) => {\n            return user.id !== game.userId;\n        })\n        .map((user: User) => user.id);\n}\n\n// </editor-fold>\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PDFType } from '../common/types/PDFType';\nimport SelectApp, { SelectOption } from './SelectApp';\nimport { getPDFData, isEntityPDF } from '../Util';\n\n/**\n * Selects an actor sheet in a pop up window.\n * @internal\n */\nexport default class ActorSheetSelect extends SelectApp {\n    protected get selectTitle(): string {\n        return 'PDFOUNDRY.VIEWER.SelectSheet';\n    }\n\n    protected get selectId(): string {\n        return 'actor-sheet';\n    }\n\n    protected get selectLabel(): string {\n        return 'PDFOUNDRY.VIEWER.SelectSheet';\n    }\n\n    protected get selectOptions(): SelectOption[] {\n        const journals: JournalEntry[] = game.journal.filter((entry: JournalEntry) => {\n            return isEntityPDF(entry) && getPDFData(entry)?.type === PDFType.Actor;\n        });\n\n        return journals.map((entry) => {\n            return {\n                text: entry.data.name,\n                value: entry.id,\n            };\n        });\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\nimport { BUTTON_GITHUB, BUTTON_KOFI } from '../common/helpers/header';\n\n/**\n * Basic app to allow the user to see data keys for actor sheets\n * @internal\n */\nexport default class PDFActorDataBrowser extends Application {\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n\n        options.template = `${Settings.PATH_TEMPLATES}/app/pdf-actor-data-browser.html`;\n        options.width = 600;\n        options.height = 400;\n        options.resizable = true;\n\n        return options;\n    }\n\n    private actor: Actor;\n    private timeout: any;\n\n    constructor(actor: Actor, options?: Application.Options) {\n        super(options);\n        this.actor = actor;\n    }\n\n    get title(): string {\n        return `${this.actor.name}`;\n    }\n\n    protected _getHeaderButtons(): any[] {\n        const buttons = super._getHeaderButtons();\n        buttons.unshift(BUTTON_GITHUB);\n        buttons.unshift(BUTTON_KOFI);\n        buttons.unshift({\n            class: 'pdf-sheet-refresh',\n            icon: 'fas fa-sync',\n            label: game.i18n.localize('PDFOUNDRY.MISC.Refresh'),\n            onclick: () => this.render(),\n        });\n        return buttons;\n    }\n\n    getData(options?: any): any {\n        const data = super.getData(options);\n\n        enum DangerLevel {\n            Safe = 0,\n            Low = 1,\n            High = 2,\n            Critical = 3,\n        }\n        type DataPath = { key: string; value: string; danger: DangerLevel };\n        const flatten = (data: object, current: string = '', danger: DangerLevel = DangerLevel.Safe): DataPath[] => {\n            let results: DataPath[] = [];\n\n            window['actorData'] = this.actor.data.data;\n\n            const path = (curr: string, ...next: (string | number)[]) => {\n                if (curr.length > 0) {\n                    for (let i = 0; i < next.length; i++) {\n                        curr = `${curr}.${next[i]}`;\n                    }\n                    return curr;\n                } else {\n                    return `${next}`;\n                }\n            };\n\n            const wrap = (value: string) => {\n                return `\\{\\{${value}\\}\\}`;\n            };\n\n            const boundDanger = (curr: DangerLevel, next: DangerLevel) => {\n                if (curr < next) {\n                    return next;\n                }\n                return curr;\n            };\n\n            if (data === null) return results;\n            if (data === undefined) return results;\n\n            if (typeof data === 'object') {\n                for (const [key, value] of Object.entries(data)) {\n                    if (Array.isArray(value)) {\n                        // Case 1 : The value is an array\n                        if (value.length === 0) {\n                            results.push({\n                                key: path(current, key),\n                                danger: DangerLevel.Critical,\n                                value: wrap('Empty Array, do not use!'),\n                            });\n                        } else {\n                            for (let i = 0; i < value.length; i++) {\n                                const next = value[i];\n                                results = [...results, ...flatten(next, path(current, key, i), boundDanger(danger, DangerLevel.High))];\n                            }\n                        }\n                    } else if (typeof value === 'object') {\n                        // Case 2 : The value is an object\n                        if (value === null || value === undefined) {\n                            results.push({\n                                key: path(current, key),\n                                danger: DangerLevel.High,\n                                value: wrap('Null/Undefined, be cautious!'),\n                            });\n                        } else if (isObjectEmpty(value)) {\n                            results.push({\n                                key: path(current, key),\n                                danger: DangerLevel.Critical,\n                                value: wrap('Empty Object, do not use!'),\n                            });\n                        } else {\n                            for (let [key2, value2] of Object.entries(value)) {\n                                results = [...results, ...flatten(value2 as any, path(current, key, key2), boundDanger(danger, DangerLevel.Low))];\n                            }\n                        }\n                    } else if (typeof value === 'function') {\n                        // Case 3 : Base Case : The value is a function\n                        results.push({\n                            key: path(current, key),\n                            danger: boundDanger(danger, DangerLevel.Critical),\n                            value: wrap('Function, do not use!'),\n                        });\n                    } else {\n                        // Case 4 : Base Case : The value is a primitive\n                        results.push({\n                            key: path(current, key),\n                            danger: boundDanger(danger, DangerLevel.Safe),\n                            value: (value as any).toString(),\n                        });\n                    }\n                }\n            } else if (typeof data === 'function') {\n                // Case 3 : Base Case : The value is a function\n                results.push({\n                    key: current,\n                    danger: boundDanger(danger, DangerLevel.Critical),\n                    value: wrap('Function, do not use!'),\n                });\n            } else {\n                // Case 4 : Base Case : The value is a primitive\n                results.push({\n                    key: current,\n                    danger: boundDanger(danger, DangerLevel.Safe),\n                    value: data,\n                });\n            }\n\n            return results;\n        };\n\n        const icons = {\n            [DangerLevel.Safe]: '<i class=\"fas fa-check-circle\"></i>',\n            [DangerLevel.Low]: '<i class=\"fas fa-question-circle\"></i>',\n            [DangerLevel.High]: '<i class=\"fas fa-exclamation-triangle\"></i>',\n            [DangerLevel.Critical]: '<i class=\"fas fa-radiation-alt\"></i>',\n        };\n        const tooltips = {\n            [DangerLevel.Safe]: game.i18n.localize('PDFOUNDRY.MISC.DANGER.Safe'),\n            [DangerLevel.Low]: game.i18n.localize('PDFOUNDRY.MISC.DANGER.Low'),\n            [DangerLevel.High]: game.i18n.localize('PDFOUNDRY.MISC.DANGER.High'),\n            [DangerLevel.Critical]: game.i18n.localize('PDFOUNDRY.MISC.DANGER.Critical'),\n        };\n\n        data['paths'] = flatten(this.actor.data.data, 'data');\n        data['paths'].push({\n            key: 'name',\n            value: this.actor.name,\n            danger: DangerLevel.Safe,\n        });\n\n        data['paths'].sort((a: DataPath, b: DataPath) => a.key.localeCompare(b.key));\n        data['paths'] = data['paths'].map((element) => {\n            let splitRoll = element['key'].split('.') as string[];\n            splitRoll.shift();\n\n            return {\n                ...element,\n                icon: icons[element.danger],\n                roll: `@${splitRoll.join('.')}`,\n                tooltip: tooltips[element.danger],\n            };\n        });\n\n        return data;\n    }\n\n    protected activateListeners(html: JQuery) {\n        super.activateListeners(html);\n\n        html.find('i.copy').on('click', async (event) => {\n            const target = $(event.currentTarget);\n\n            await navigator.clipboard.writeText(target.data('value') as string);\n\n            ui.notifications.info(game.i18n.localize('PDFOUNDRY.MISC.CopiedToClipboard'));\n        });\n    }\n\n    render(force?: boolean, options?: Application.RenderOptions): Application {\n        if (this.timeout) {\n            clearTimeout(this.timeout);\n        }\n\n        this.timeout = setTimeout(this.render.bind(this), 10000);\n        return super.render(force, options);\n    }\n\n    close(): Promise<any> {\n        clearTimeout(this.timeout);\n        return super.close();\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ActorViewer from '../viewer/ActorViewer';\nimport Settings from '../Settings';\n\n/**\n * Adapts a FillableViewer to function as a ActorSheet\n * @internal\n */\nexport default class PDFActorSheetAdapter extends ActorSheet {\n    // <editor-fold desc=\"Static Properties\"></editor-fold>\n    // <editor-fold desc=\"Static Methods\"></editor-fold>\n    // <editor-fold desc=\"Properties\">\n\n    private _viewer: ActorViewer;\n    private readonly _options?: Application.Options;\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Constructor & Initialization\">\n\n    constructor(actor: Actor, options?: Application.Options) {\n        super(actor, options);\n\n        this._options = options;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Getters & Setters\">\n\n    public get viewer(): ActorViewer {\n        return this._viewer;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Instance Methods\">\n\n    protected activateListeners(html: JQuery | HTMLElement) {\n        $(this.element).css('display', 'none');\n        this.form = $(html).first().get(0);\n        super.activateListeners(html);\n    }\n\n    protected async _onSubmit(...args): Promise<any> {\n        // PDFoundry handles data in the FillableViewer\n        return;\n    }\n\n    getData(): ActorSheet.Data {\n        return mergeObject(super.getData(), this._viewer.getData());\n    }\n\n    protected _updateObject(event: Event | JQuery.Event, formData: any): Promise<any> {\n        return super._updateObject(event, formData);\n    }\n\n    render(force?: boolean, options?: Application.RenderOptions): Application {\n        if (!this._viewer) {\n            const sheetId = this.actor.getFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.SHEET_ID);\n            this._viewer = new ActorViewer(this.actor, sheetId, this, this._options);\n        }\n\n        // If this window is already open, don't re-render\n        if (this._state === Application.RENDER_STATES.RENDERED) {\n            return this;\n        }\n\n        this._viewer.render(force, options);\n        return super.render(force, options);\n    }\n\n    // TODO: Sandbox compatibility - should force this class to extend CONFIG class instead.\n    async scrollbarSet() {\n        return;\n    }\n\n    async close(): Promise<void> {\n        if (this._viewer) {\n            await this._viewer.close();\n            // @ts-ignore\n            delete this._viewer;\n        }\n        return super.close();\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\nimport Api from '../Api';\nimport { getAbsoluteURL, getPDFData } from '../Util';\nimport { PDFType } from '../common/types/PDFType';\nimport { BUTTON_GITHUB, BUTTON_HELP, BUTTON_KOFI } from '../common/helpers/header';\n\n/**\n * Extends the base ItemSheet for linked PDF viewing.\n * @private\n */\nexport class PDFConfig extends FormApplication {\n    // <editor-fold desc=\"Static Properties\">\n\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n        options.classes = [...options.classes!, Settings.CSS_CLASS];\n        options.template = `${Settings.PATH_TEMPLATES}/sheet/pdf-config.html`;\n        options.width = 650;\n        options.height = 'auto';\n        return options;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Static Methods\"></editor-fold>\n    // <editor-fold desc=\"Properties\">\n\n    public readonly object: JournalEntry;\n    private picker: FilePicker;\n\n    // </editor-fold>\n    // <editor-fold desc=\"Constructor & Initialization\">\n\n    constructor(journalEntry: JournalEntry, options?: Application.Options) {\n        super(journalEntry, options);\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Getters & Setters\">\n\n    public get title(): string {\n        return this.object.name;\n    }\n\n    public get id(): string {\n        return `pdf-${this.object.id}`;\n    }\n\n    protected _getHeaderButtons(): any[] {\n        const buttons = super._getHeaderButtons();\n        buttons.unshift(BUTTON_GITHUB);\n        buttons.unshift(BUTTON_KOFI);\n        buttons.unshift(BUTTON_HELP);\n        return buttons;\n    }\n\n    get isEditable(): boolean {\n        // @ts-ignore TODO: 0.8.x compat\n        return this.object.testUserPermission(game.user, CONST.ENTITY_PERMISSIONS.OWNER);\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Instance Methods\">\n\n    protected activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n\n        const urlInput = html.find('#data-url');\n        const offsetInput = html.find('#data-offset');\n\n        // Default behavior opens the file picker in this form setup, override\n        html.find('input').on('keypress', (event) => {\n            if (event.key === 'Enter') {\n                this._onSubmit(event, { preventClose: true });\n            }\n        });\n        html.find('input, select').on('input', (event) => {\n            this._onSubmit(event, { preventClose: true });\n        });\n\n        // Browse button\n        html.find('#pdf-browse').on('click', async (event) => {\n            event.preventDefault();\n            event.stopImmediatePropagation();\n\n            this.picker =\n                this.picker ??\n                new FilePicker({\n                    // @ts-ignore TODO\n                    callback: () => {\n                        this._onSubmit(new Event('input'), { preventClose: true });\n                    },\n                });\n\n            // @ts-ignore TODO: Foundry Types\n            this.picker.extensions = ['.pdf'];\n            this.picker.field = urlInput[0];\n\n            if (!this.filepickers.includes(this.picker)) {\n                this.filepickers.push(this.picker);\n            }\n\n            let urlValue = urlInput.val();\n            if (urlValue !== undefined) {\n                await this.picker.browse(urlValue.toString().trim());\n            }\n\n            this.picker.render(true);\n        });\n\n        // Test pdf settings button\n        html.find('#pdf-test').on('click', (event) => {\n            event.preventDefault();\n            event.stopImmediatePropagation();\n\n            let urlValue = urlInput.val();\n            let offsetValue = offsetInput.val();\n\n            if (urlValue === null || urlValue === undefined) return;\n            if (offsetValue === null || offsetValue === undefined) return;\n\n            urlValue = urlValue.toString();\n            urlValue = getAbsoluteURL(urlValue);\n\n            if (offsetValue.toString().trim() === '') {\n                offsetValue = 0;\n            }\n            offsetValue = parseInt(offsetValue as string);\n\n            Api.openURL(urlValue, 5 + offsetValue, false);\n        });\n    }\n\n    public getData(): object {\n        const data = super.getData();\n\n        data['types'] = Object.entries(PDFType).map(([key]) => {\n            return {\n                value: PDFType[key],\n                text: `PDFOUNDRY.MISC.PDFTYPE.${key}`,\n            };\n        });\n\n        data['dataPath'] = `flags.${Settings.MODULE_NAME}.${Settings.FLAGS_KEY.PDF_DATA}`;\n        data['flags'] = getPDFData(this.object);\n        data['name'] = this.object.data.name;\n\n        return data;\n    }\n\n    protected async _updateObject(event: Event | JQuery.Event, formData: any): Promise<void> {\n        await this.object.update(formData);\n    }\n\n    // @ts-ignore TODO\n    submit({ updateData }: { updateData?: any }): FormApplication {\n        // @ts-ignore TODO\n        return super.submit({ updateData });\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\n\n/**\n * Callback type for player selection\n * @private\n */\nexport type PDFPlayerSelectCallback = (ids: string[]) => void;\n\n/**\n * An application that allows selection of players.\n * @private\n */\nexport default class PlayerSelect extends Application {\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n        options.classes = ['sheet', 'item'];\n        options.template = `${Settings.PATH_TEMPLATES}/app/pdf-player-select.html`;\n        options.width = 'auto';\n        options.height = 'auto';\n        options.title = game.i18n.localize('PDFOUNDRY.VIEWER.SelectPlayers');\n        return options;\n    }\n\n    private readonly _ids;\n    private readonly _callback: PDFPlayerSelectCallback;\n\n    constructor(ids: string[], cb: PDFPlayerSelectCallback, options?: Application.Options) {\n        super(options);\n\n        this._ids = ids;\n        this._callback = cb;\n    }\n\n    getData(options?: any): any | Promise<any> {\n        const data = super.getData(options);\n\n        const users: any[] = [];\n        for (const id of this._ids) {\n            users.push({\n                name: game.users.get(id).name,\n                id,\n            });\n        }\n\n        users.sort((a, b) => a.name.localeCompare(b.name));\n\n        data['users'] = users;\n        return data;\n    }\n\n    protected activateListeners(html: JQuery<HTMLElement> | HTMLElement): void {\n        super.activateListeners(html);\n\n        const button = $(html).find('#confirm');\n        button.on('click', () => {\n            this._callback(this.collectIds());\n            this.close();\n        });\n    }\n\n    /**\n     * Collect selected ids from the html\n     */\n    private collectIds(): string[] {\n        const ids: string[] = [];\n        const checkboxes = $(this.element).find('input[type=checkbox]');\n        for (let i = 0; i < checkboxes.length; i++) {\n            const checkbox = $(checkboxes[i]);\n            if (checkbox.prop('checked')) {\n                ids.push(checkbox.prop('id'));\n            }\n        }\n        return ids;\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\n\n/**\n * Callback type for select apps\n * @internal\n */\nexport type SelectAppCallback = (value: string, text: string) => void;\n\n/**\n * Data layout for select options\n * @internal\n */\nexport interface SelectOption {\n    text: string;\n    value: string;\n}\n\n/**\n * Base class for app that uses a select drop down\n * @internal\n */\nexport default abstract class SelectApp extends Application {\n    // <editor-fold desc=\"Static Properties\">\n\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n        options.classes = [...options.classes!, Settings.CSS_CLASS];\n        options.template = `${Settings.PATH_TEMPLATES}/app/select-app.html`;\n        options.width = 200;\n        options.height = 'auto';\n        return options;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Static Methods\"></editor-fold>\n    // <editor-fold desc=\"Properties\">\n\n    private readonly _current?: string;\n    private readonly _callback?: SelectAppCallback;\n\n    // </editor-fold>\n    // <editor-fold desc=\"Constructor & Initialization\">\n\n    constructor(callback?: SelectAppCallback, currentValue?: string, options?: Application.Options) {\n        super(options);\n\n        this._current = currentValue;\n        this._callback = callback;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Getters & Setters\">\n\n    public get title(): string {\n        return game.i18n.localize(this.selectTitle);\n    }\n\n    public get id(): string {\n        return this.unique ? this.selectId : super.id;\n    }\n\n    /**\n     * Should duplicate of this app be allowed\n     * @protected\n     */\n    protected get unique(): boolean {\n        return true;\n    }\n\n    /**\n     * The localization string to be used in the header for the title\n     * @protected\n     */\n    protected abstract get selectTitle(): string;\n\n    /**\n     * The localization string to be used in the body to label the select\n     * @protected\n     */\n    protected abstract get selectLabel(): string;\n\n    /**\n     * The id of the select, to preserve uniqueness. Used for app id if not\n     *  unique, and select id attribute for global finds.\n     * @protected\n     */\n    protected abstract get selectId(): string;\n\n    /**\n     * Array of options that will be used for the select options\n     * @protected\n     */\n    protected abstract get selectOptions(): SelectOption[];\n\n    // </editor-fold>\n    // <editor-fold desc=\"Instance Methods\">\n\n    getData(options?: any): any | Promise<any> {\n        const data = super.getData(options);\n\n        data.data = {\n            id: this.selectId,\n            label: this.selectLabel,\n            selected: this._current,\n            options: this.selectOptions,\n        };\n\n        return data;\n    }\n\n    protected activateListeners(html: JQuery): void {\n        super.activateListeners(html);\n\n        const button = html.find(`button#${this.selectId}-confirm`);\n        button.on('click', async (event) => {\n            event.preventDefault();\n            const select = html.find(`#${this.selectId}`) as JQuery<HTMLSelectElement>;\n            const value = select.val() as string;\n            if (value !== this._current && this._callback !== undefined) {\n                this._callback(value, select.find('option:selected').text());\n            }\n            await this.close();\n        });\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * An error that occurs during cache operations\n * @private\n */\nexport class CacheError extends Error {\n    constructor(index: string, store: string, message?: string) {\n        super(`Error in ${index}>${store}: ${message}`);\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CacheError } from './CacheError';\n\n/**\n * Class that deals with getting/setting from an indexed db\n * Mostly exists to separate logic for the PDFCache from logic\n * dealing with the database\n * @private\n */\nexport default class CacheHelper {\n    private _version: number;\n\n    private readonly _indexName: string;\n    private readonly _storeNames: string[];\n\n    private _db: IDBDatabase;\n\n    public static async createAndOpen(indexName: string, storeNames: string[], version: number) {\n        const helper = new CacheHelper(indexName, storeNames, version);\n        await helper.open();\n        return helper;\n    }\n\n    public get ready() {\n        return this._db !== undefined;\n    }\n\n    public constructor(indexName: string, storeNames: string[], version: number) {\n        this._indexName = `${indexName}`;\n        this._storeNames = storeNames;\n        this._version = version;\n    }\n\n    private newTransaction(storeName: string) {\n        const transaction = this._db.transaction(storeName, 'readwrite');\n        const store = transaction.objectStore(storeName);\n        return { transaction, store };\n    }\n\n    public open(): Promise<void> {\n        const that = this;\n        return new Promise<void>(function (resolve, reject) {\n            const request = indexedDB.open(that._indexName, that._version);\n            request.onsuccess = function (event) {\n                that._db = this.result;\n                resolve();\n            };\n            request.onupgradeneeded = function (event) {\n                that._db = this.result;\n                for (let i = 0; i < that._storeNames.length; i++) {\n                    try {\n                        // Create object store if it doesn't exist\n                        that._db.createObjectStore(that._storeNames[i], {});\n                    } catch (error) {\n                        // Otherwise pass\n                    }\n                }\n                resolve();\n            };\n            request.onerror = function (event) {\n                // @ts-ignore\n                reject(event.target.error);\n            };\n        });\n    }\n\n    public set(key: IDBValidKey, value: any, storeName: string, force: boolean = false): Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            if (!this._db) {\n                throw new CacheError(this._indexName, storeName, 'Database is not initialized.');\n            } else {\n                const that = this;\n                let { transaction, store } = this.newTransaction(storeName);\n\n                // Propagate errors upwards, otherwise they fail silently\n                transaction.onerror = function (event) {\n                    // @ts-ignore\n                    reject(event.target.error);\n                };\n\n                const keyRequest = store.getKey(key);\n                keyRequest.onsuccess = function (event) {\n                    // key already exists in the store\n                    if (keyRequest.result) {\n                        // should we force the new value by deleting the old?\n                        if (force) {\n                            that.del(key, storeName).then(() => {\n                                ({ transaction, store } = that.newTransaction(storeName));\n                                store.add(value, key);\n                                resolve();\n                            });\n                        } else {\n                            throw new CacheError(that._indexName, storeName, `Key ${key} already exists.`);\n                        }\n                    } else {\n                        store.add(value, key);\n                        resolve();\n                    }\n                };\n            }\n        });\n    }\n\n    public get(key: IDBValidKey, storeName: string): Promise<any> {\n        return new Promise<void>((resolve, reject) => {\n            if (!this._db) {\n                throw new CacheError(this._indexName, storeName, 'Database is not initialized.');\n            } else {\n                let { transaction, store } = this.newTransaction(storeName);\n\n                // Propagate errors upwards, otherwise they fail silently\n                transaction.onerror = function (event) {\n                    // @ts-ignore\n                    reject(event.target.error);\n                };\n\n                const getRequest = store.get(key);\n                getRequest.onsuccess = function (event) {\n                    resolve(this.result);\n                };\n\n                getRequest.onerror = function (event) {\n                    // @ts-ignore\n                    reject(event.target.error);\n                };\n            }\n        });\n    }\n\n    public del(key: IDBValidKey, storeName: string): Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            try {\n                const { transaction, store } = this.newTransaction(storeName);\n\n                transaction.onerror = function (event) {\n                    // @ts-ignore\n                    reject(event.target.error);\n                };\n                transaction.oncomplete = function (event) {\n                    resolve();\n                };\n\n                store.delete(key);\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    public keys(storeName: string): Promise<IDBValidKey[]> {\n        return new Promise<IDBValidKey[]>((resolve, reject) => {\n            try {\n                const { transaction, store } = this.newTransaction(storeName);\n                const keysRequest = store.getAllKeys();\n\n                keysRequest.onsuccess = function () {\n                    resolve(keysRequest.result);\n                };\n                keysRequest.onerror = function (event) {\n                    // @ts-ignore\n                    reject(event.target.error);\n                };\n\n                return;\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n\n    public clr(storeName: string): Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            try {\n                const { store } = this.newTransaction(storeName);\n                const keys = store.getAllKeys();\n                keys.onsuccess = (result) => {\n                    const promises: Promise<void>[] = [];\n                    for (const key of keys.result) {\n                        promises.push(this.del(key, storeName));\n                    }\n                    Promise.all(promises).then(() => {\n                        resolve();\n                    });\n                };\n            } catch (error) {\n                reject(error);\n            }\n        });\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\nimport CacheHelper from './CacheHelper';\n\n/**\n * Meta information about a cache entry\n * @private\n */\ntype CacheData = {\n    /**\n     * The size in bytes this cache entry takes up.\n     */\n    size: number;\n    /**\n     * The date the cache was last accessed, represented by a ISO string.\n     */\n    dateAccessed: string;\n};\n\n/**\n * Handles caching for PDFs\n * @private\n */\nexport default class PDFCache {\n    // <editor-fold desc=\"Static Properties\">\n    /**\n     * Max size of the cache for the active user, defaults to 256 MB.\n     */\n    private static get MAX_BYTES() {\n        return Settings.get(Settings.SETTINGS_KEY.CACHE_SIZE) * 2 ** 20;\n    }\n\n    private static readonly IDB_NAME: string = 'PDFoundry';\n    private static readonly IDB_VERSION: number = 1;\n\n    private static readonly CACHE: string = `Cache`;\n    private static readonly META: string = `Meta`;\n\n    private static _cacheHelper: CacheHelper;\n    // </editor-fold>\n\n    public static async initialize() {\n        PDFCache._cacheHelper = await CacheHelper.createAndOpen(PDFCache.IDB_NAME, [PDFCache.CACHE, PDFCache.META], PDFCache.IDB_VERSION);\n    }\n\n    /**\n     * Get meta information about a provided key (url).\n     * @param key\n     */\n    public static async getMeta(key: string): Promise<CacheData | null> {\n        try {\n            return await PDFCache._cacheHelper.get(key, PDFCache.META);\n        } catch (error) {\n            return null;\n        }\n    }\n\n    /**\n     * Set meta information about a provided key (url). See {@link CacheData}.\n     * @param key\n     * @param meta\n     */\n    public static async setMeta(key: string, meta: CacheData): Promise<void> {\n        await PDFCache._cacheHelper.set(key, meta, PDFCache.META, true);\n    }\n\n    /**\n     * Get the byte array representing the key (url) from the user's cache.\n     * @param key\n     */\n    public static async getCache(key: string): Promise<Uint8Array | null> {\n        try {\n            const bytes = await PDFCache._cacheHelper.get(key, PDFCache.CACHE);\n            const meta: CacheData = {\n                dateAccessed: new Date().toISOString(),\n                size: bytes.length,\n            };\n            await PDFCache.setMeta(key, meta);\n\n            return bytes;\n        } catch (error) {\n            return null;\n        }\n    }\n\n    /**\n     * Set the value of the cache for the specific key (url) to the provided byte array.\n     * @param key\n     * @param bytes\n     */\n    public static async setCache(key: string, bytes: Uint8Array) {\n        const meta: CacheData = {\n            dateAccessed: new Date().toISOString(),\n            size: bytes.length,\n        };\n\n        await PDFCache._cacheHelper.set(key, bytes, PDFCache.CACHE, true);\n        await PDFCache.setMeta(key, meta);\n        await this.prune();\n    }\n\n    /**\n     * Preload the PDF at the specified key (url), caching it immediately.\n     * @param key\n     */\n    public static preload(key: string): Promise<void> {\n        return new Promise<void>(async (resolve, reject) => {\n            const cachedBytes = await PDFCache.getCache(key);\n            if (cachedBytes !== null && cachedBytes.byteLength > 0) {\n                resolve();\n                return;\n            }\n\n            const response = await fetch(key);\n            if (response.ok) {\n                const fetchedBytes = new Uint8Array(await response.arrayBuffer());\n                if (fetchedBytes.byteLength > 0) {\n                    await PDFCache.setCache(key, fetchedBytes);\n                    resolve();\n                    return;\n                } else {\n                    reject('Fetch failed.');\n                }\n            } else {\n                reject('Fetch failed.');\n            }\n        });\n    }\n\n    /**\n     * Prune the active user's cache until it is below the user's cache size limit.\n     */\n    public static async prune() {\n        const keys = await this._cacheHelper.keys(PDFCache.META);\n\n        let totalBytes = 0;\n        let metas: any[] = [];\n        for (const key of keys) {\n            const meta = await this._cacheHelper.get(key, PDFCache.META);\n            meta.dateAccessed = Date.parse(meta.dateAccessed);\n            meta.size = parseInt(meta.size);\n\n            totalBytes += meta.size;\n\n            metas.push({\n                key,\n                meta,\n            });\n        }\n\n        metas = metas.sort((a, b) => {\n            return a.meta.dateAccessed - b.meta.dateAccessed;\n        });\n\n        for (let i = 0; i < metas.length; i++) {\n            if (totalBytes < PDFCache.MAX_BYTES) {\n                break;\n            }\n\n            const next = metas[i];\n\n            await this._cacheHelper.del(next.key, PDFCache.META);\n            await this._cacheHelper.del(next.key, PDFCache.CACHE);\n\n            totalBytes -= next.meta.size;\n        }\n    }\n\n    /**\n     * Clear the PDF cache\n     */\n    public static async clear() {\n        const keys = await this._cacheHelper.keys(PDFCache.META);\n\n        for (const key of keys) {\n            await this._cacheHelper.del(key, PDFCache.META);\n            await this._cacheHelper.del(key, PDFCache.CACHE);\n        }\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Chat command processor\n * @internal\n */\nexport default abstract class ChatCommand {\n    // <editor-fold desc=\"Getters & Setters\">\n\n    public get CommandPrefix() {\n        return `/pdfoundry`;\n    }\n\n    public abstract get CommandName(): string;\n\n    // </editor-fold>\n    // <editor-fold desc=\"Instance Methods\">\n\n    /**\n     * Execute the command, returning true if the command completes successfully\n     * @param content\n     */\n    public execute(content: string): boolean {\n        const realArgs = content.split(' ');\n        if (realArgs[0] !== this.CommandPrefix) {\n            return false;\n        }\n\n        if (realArgs[1] !== this.CommandName) {\n            return false;\n        }\n\n        // pop first two args\n        realArgs.shift();\n        realArgs.shift();\n\n        this.run(realArgs)\n            .then(() => {\n                let message = game.i18n.localize('PDFOUNDRY.COMMANDS.Success');\n                message = message.replace('$COMMAND_NAME$', this.CommandName);\n                ui.notifications.info(message);\n            })\n            .catch((error) => {\n                let message = game.i18n.localize('PDFOUNDRY.COMMANDS.Failure');\n                message = message.replace('$COMMAND_NAME$', this.CommandName);\n                ui.notifications.error(message);\n                console.error(error);\n            });\n        return true;\n    }\n\n    /**\n     * Run the command\n     * @param args\n     * @protected\n     */\n    protected abstract run(args: string[]): Promise<void>;\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPDFData, setPDFData } from '../Util';\nimport { PDFType } from '../common/types/PDFType';\nimport ChatCommand from './ChatCommand';\n\n/**\n * Fixes missing types\n * @internal\n */\nexport default class FixMissingTypes extends ChatCommand {\n    // <editor-fold desc=\"Getters & Setters\">\n\n    get CommandName(): string {\n        return 'fix-missing-types';\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Instance Methods\">\n\n    protected async run(args: string[]): Promise<void> {\n        let fixedPDFs = 0;\n        const journals = game.journal.filter((je: JournalEntry) => getPDFData(je) !== undefined && getPDFData(je)?.type === undefined) as JournalEntry[];\n        for (const journalEntry of journals) {\n            await setPDFData(journalEntry, {\n                type: PDFType.Static,\n            });\n            fixedPDFs += 1;\n        }\n\n        // @ts-ignore\n        ui.journal.render();\n\n        if (fixedPDFs > 0) {\n            ui.notifications.info(game.i18n.localize('PDFOUNDRY.COMMANDS.FixMissingTypesSuccess'));\n        } else {\n            ui.notifications.info(game.i18n.localize('PDFOUNDRY.COMMANDS.FixMissingTypesFailure'));\n        }\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport ChatCommand from './ChatCommand';\nimport PDFCache from '../cache/PDFCache';\n\n/**\n * @internal\n */\nexport default class PurgeCache extends ChatCommand {\n    // <editor-fold desc=\"Getters & Setters\">\n\n    public get CommandName(): string {\n        return 'purge-cache';\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Instance Methods\">\n\n    protected async run(args: string[]): Promise<void> {\n        await PDFCache.clear();\n\n        ui.notifications.info(game.i18n.localize('PDFOUNDRY.COMMANDS.PurgeCacheSuccess'));\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The domain white list includes domains that are allowed other than 'localhost' or\n *  the equivalent domain the user is running the server on.\n */\nexport const DOMAIN_WHITELIST = ['amazonaws.com', 'digitaloceanspaces.com', 'assets.forge-vtt.com', 'wasabisys.com', 'backblazeb2.com'];\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Api from '../../Api';\nimport Settings from '../../Settings';\n\n/**\n * @internal\n */\nexport default class EventStore<TKeys extends string = string> {\n    private readonly _map: Map<string, Function[]>;\n\n    public constructor() {\n        this._map = new Map<string, Function[]>();\n    }\n\n    /**\n     * Turn on an event callback for the specified event.\n     * @param eventName\n     * @param callback\n     */\n    public on(eventName: TKeys, callback: Function) {\n        if (!this._map.has(eventName)) {\n            this._map.set(eventName, []);\n        }\n\n        const callbacks = this._map.get(eventName) as Function[];\n        for (let i = 0; i < callbacks.length; i++) {\n            if (callbacks[i] === callback) return;\n        }\n        callbacks.push(callback);\n    }\n\n    /**\n     * Like {@see on} but only fires once.\n     * @param eventName\n     * @param callback\n     */\n    public once(eventName: TKeys, callback: Function) {\n        const that = this;\n        const wrapper = function (...args) {\n            callback(args);\n            that.off(eventName, wrapper);\n        };\n        that.on(eventName, wrapper);\n    }\n\n    /**\n     * Turn off an event callback for the specified event.\n     * @param eventName\n     * @param callback\n     */\n    public off(eventName: TKeys, callback: Function) {\n        if (!this._map.has(eventName)) {\n            this._map.set(eventName, []);\n        }\n\n        const callbacks = this._map.get(eventName) as Function[];\n        for (let i = 0; i < callbacks.length; i++) {\n            if (callbacks[i] === callback) {\n                callbacks.splice(i, 1);\n            }\n        }\n    }\n\n    /**\n     * Fire an event and forward the args to all handlers\n     * @param eventName\n     * @param args\n     */\n    public fire(eventName: TKeys, ...args) {\n        if (Api.DEBUG.EVENTS) {\n            console.debug(`${Settings.MODULE_NAME.toUpperCase()}::${eventName}`);\n            console.debug(args);\n        }\n\n        if (!this._map.has(eventName)) {\n            return;\n        }\n\n        const callbacks = this._map.get(eventName) as Function[];\n        for (const callback of callbacks) {\n            callback(...args);\n        }\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Api from '../../Api';\n\n/**\n * Github link header button.\n * @internal\n */\nexport const BUTTON_GITHUB = {\n    class: 'pdf-sheet-github',\n    icon: 'fas fa-external-link-alt',\n    label: 'PDFoundry',\n    onclick: () => window.open('https://github.com/Djphoenix719/PDFoundry', '_blank'),\n};\n\n/**\n * Manual link header button.\n * @internal\n */\nexport const BUTTON_HELP = {\n    class: 'pdf-sheet-manual',\n    icon: 'fas fa-question-circle',\n    label: 'Help',\n    onclick: () => Api.showHelp(),\n};\n\n/**\n * Shameless shill link\n * @internal\n */\nexport const BUTTON_KOFI = {\n    class: 'pdf-sheet-kofi',\n    icon: 'fas fa-coffee',\n    label: '',\n    onclick: () => window.open('https://ko-fi.com/djsmods', '_blank'),\n};\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The type of PDF file, as specified by the user.\n * @module API\n */\nexport enum PDFType {\n    /**\n     * Static PDFs contain no form fillable elements.\n     */\n    Static = 'static',\n    /**\n     * Fillable PDFs are not linked to actor sheets, but do contain form fillable elements.\n     */\n    Fillable = 'fillable',\n    /**\n     * Actor-linked PDFs store their data on the actor, so they can represent actors.\n     */\n    Actor = 'actor',\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Api from '../Api';\n\n/**\n * @private\n * Enriches TinyMCE editor content\n */\nexport default class HTMLEnricher {\n    public static patchEnrich() {\n        const oldEnrich = TextEditor.enrichHTML;\n\n        // @ts-ignore\n        TextEditor.enrichHTML = function (html: string, options: any) {\n            html = oldEnrich.apply(this, [html, options]);\n            html = HTMLEnricher.enrichAll(html);\n            return html;\n        };\n    }\n\n    public static bindRichTextLinks(html: JQuery) {\n        html.find('a.pdfoundry-link').on('click', (event) => {\n            event.preventDefault();\n\n            // This will always be an anchor\n            const target = $(event.currentTarget as HTMLAnchorElement);\n            const ref = target.data('ref') as string;\n            const page = target.data('page') as number;\n\n            // ref can match name or code\n            let pdfData = Api.findPDFData((data) => {\n                return data.name === ref || data.code === ref;\n            });\n\n            if (!pdfData) {\n                ui.notifications.error(`Unable to find a PDF with a name or code matching ${ref}.`);\n                return;\n            }\n\n            if (page === 0) {\n                Api.openPDF(pdfData);\n            } else {\n                Api.openPDF(pdfData, {\n                    page,\n                });\n            }\n        });\n    }\n\n    /**\n     * Replace the first @PDF link in the text with a rich link.\n     * @param text\n     */\n    public static enrich(text: string): string {\n        const sPos = text.indexOf('@');\n        const ePos = text.indexOf('}', sPos);\n\n        const enrichMe = text.slice(sPos, ePos + 1);\n\n        const lBracket = enrichMe.indexOf('[');\n        const rBracket = enrichMe.indexOf(']');\n        const lCurly = enrichMe.indexOf('{');\n        const rCurly = enrichMe.indexOf('}');\n\n        // Required character is missing\n        if (lBracket === -1 || rBracket === -1 || lCurly === -1 || rCurly === -1) {\n            throw new Error(game.i18n.localize('PDFOUNDRY.ENRICH.InvalidFormat'));\n        }\n        // Order is not correct\n        if (rCurly < lCurly || lCurly < rBracket || rBracket < lBracket) {\n            throw new Error(game.i18n.localize('PDFOUNDRY.ENRICH.InvalidFormat'));\n        }\n\n        const options = enrichMe.slice(lBracket + 1, rBracket);\n        // Multiple dividers are not supported\n        if (options.indexOf('|') !== options.lastIndexOf('|')) {\n            throw new Error(game.i18n.localize('PDFOUNDRY.ENRICH.InvalidFormat'));\n        }\n\n        let linkText = enrichMe.slice(lCurly + 1, rCurly);\n        // Empty names are not supported\n        if (linkText === undefined || linkText === '') {\n            throw new Error(game.i18n.localize('PDFOUNDRY.ENRICH.EmptyLinkText'));\n        }\n\n        let pageNumber = 0;\n        const [nameOrCode, queryString] = options.split('|');\n\n        // Getting the PDF without invisible PDFs to check permissions\n        let pdfData = Api.findPDFData((data) => {\n            return data.name === nameOrCode || data.code === nameOrCode;\n        }, false);\n\n        if (pdfData) {\n            // Case 1 - User has permissions to see the PDF\n            if (queryString !== undefined && queryString !== '') {\n                const [_, pageString] = queryString.split('=');\n                try {\n                    pageNumber = parseInt(pageString);\n                } catch (error) {\n                    // Ignore page number\n                }\n            }\n\n            if (pageNumber < 0) {\n                throw new Error('PDFOUNDRY.ERROR.PageMustBePositive');\n            }\n\n            const i18nOpen = game.i18n.localize('PDFOUNDRY.ENRICH.LinkTitleOpen');\n            const i18nPage = game.i18n.localize('PDFOUNDRY.ENRICH.LinkTitlePage');\n            const linkTitle = `${i18nOpen} ${nameOrCode} ${i18nPage} ${pageNumber}`;\n            const result = `<a class=\"pdfoundry-link\" title=\"${linkTitle}\" data-ref=\"${nameOrCode}\" data-page=\"${pageNumber}\">${linkText}</a>`;\n\n            return text.slice(0, sPos) + result + text.slice(ePos + 1);\n        } else {\n            // Case 2 - User does not have permissions to see the PDF\n            return text.slice(0, sPos) + linkText + text.slice(ePos + 1);\n        }\n    }\n\n    /**\n     * Replace all rich text markup with appropriate rich text HTML in the specified text.\n     * @param text\n     */\n    public static enrichAll(text: string): string {\n        while (text.includes('@PDF')) {\n            text = HTMLEnricher.enrich(text);\n        }\n\n        return text;\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { getPDFData, isEntityPDF } from '../Util';\n\n/**\n * @private\n * A plugin for TinyMCE that handles Drag + Drop\n */\nexport default class TinyMCEPlugin {\n    private static pluginName = 'PDFoundry_HTMLEnrich_Drop';\n\n    /**\n     * Register plugin with Foundry + TinyMCE\n     */\n    public static Register() {\n        // @ts-ignore\n        tinyMCE.PluginManager.add(TinyMCEPlugin.pluginName, function (editor) {\n            editor.on('BeforeSetContent', (event) => TinyMCEPlugin.Handle(event));\n        });\n        CONFIG.TinyMCE.plugins = `${TinyMCEPlugin.pluginName} ${CONFIG.TinyMCE.plugins}`;\n    }\n\n    private static Handle(event: any) {\n        if (event.initial) return;\n        if (!event.selection || event.set !== undefined) {\n            return;\n        }\n\n        const initialContent = event.content;\n\n        const lBracket = initialContent.indexOf('[');\n        const rBracket = initialContent.indexOf(']');\n        const entityId = initialContent.slice(lBracket + 1, rBracket);\n\n        const entity = game.journal.get(entityId);\n        if (entity === undefined || !isEntityPDF(entity)) {\n            return;\n        }\n\n        const pdfData = getPDFData(entity);\n        if (pdfData === undefined) {\n            return;\n        }\n\n        const codeOrName = pdfData.code ? pdfData.code : pdfData.name;\n\n        event.content = `@PDF[${codeOrName}|page=1]{${pdfData.name}}`;\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PDFData } from '../common/types/PDFData';\nimport { PDFType } from '../common/types/PDFType';\nimport { setPDFData } from '../Util';\nimport Settings from '../Settings';\n\n/**\n * Should this migration run\n * @internal\n */\nexport function legacyMigrationRequired(): boolean {\n    if (Settings.get(Settings.SETTINGS_KEY.DATA_VERSION) === 'undefined') {\n        if (game.items.find((i: Item) => i.data.type === 'PDFoundry_PDF') !== null) {\n            return true;\n        } else {\n            Settings.set(Settings.SETTINGS_KEY.DATA_VERSION, 'v0.6.0');\n            return false;\n        }\n    } else {\n        return false;\n    }\n}\n\n/**\n * Open the migration window for migration\n * @internal\n */\nexport function migrateLegacy(): Promise<void> {\n    return new Promise<void>(async (resolve, reject) => {\n        let d = new Dialog({\n            title: 'PDFoundry: Migration Required',\n            content: [\n                '<h1>Migration Required</h1>',\n                '<p>PDFoundry must convert legacy items to the new Journal format; You will not be able to use PDFoundry until you do.</p>',\n                '<p>If you wish to backup your world - just in case - you may do so now.</p>',\n                '<p>Please note folder structure will not be preserved.</p>',\n            ].join(''),\n            buttons: {\n                proceed: {\n                    icon: '<i class=\"fas fa-check\"></i>',\n                    label: 'Migrate Now',\n                    callback: () => {\n                        convert()\n                            .then(() => resolve())\n                            .catch(() => reject());\n                    },\n                },\n                cancel: {\n                    icon: '<i class=\"fas fa-times\"></i>',\n                    label: 'Remind Me Later',\n                    callback: () => resolve(),\n                },\n            },\n            default: 'cancel',\n        });\n        d.render(true);\n    });\n}\n\n/**\n * Run the conversion\n * @internal\n */\nasync function convert() {\n    const items = game.items.filter((i: Item) => i.data.type === 'PDFoundry_PDF') as Item[];\n    for (const item of items) {\n        let pdfData = getLegacyData(item);\n        // @ts-ignore\n        const permission = item.data.permission;\n        const journalEntry = (await JournalEntry.create({\n            name: pdfData.name,\n            permission,\n        })) as JournalEntry;\n        // @ts-ignore\n        delete pdfData.name;\n\n        await setPDFData(journalEntry, pdfData);\n        await item.delete({});\n    }\n\n    // @ts-ignore\n    ui.journal.render();\n}\n\n/**\n * Get legacy PDF data & type\n * @param item\n * @internal\n */\nfunction getLegacyData(item: Item): PDFData {\n    const typeMap = {\n        PDFoundry_PDF: PDFType.Static,\n        PDFoundry_FillablePDF: PDFType.Fillable,\n        PDFoundry_FillableActor: PDFType.Actor,\n    };\n    // @ts-ignore\n    let type = typeMap[item.data.data.pdf_type] ?? PDFType.Static;\n    return {\n        name: item.data.name,\n        // @ts-ignore\n        url: item.data.data.url,\n        // @ts-ignore\n        code: item.data.data.code,\n        // @ts-ignore\n        offset: item.data.data.offset,\n        // @ts-ignore\n        cache: item.data.data.cache,\n        type,\n    };\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport PreloadEvent from './events/PreloadEvent';\nimport StaticViewer from '../viewer/StaticViewer';\nimport Api from '../Api';\nimport Settings from '../Settings';\nimport SetViewEvent from './events/SetViewEvent';\nimport PDFCache from '../cache/PDFCache';\n\n/**\n * @private\n */\nexport class Socket {\n    public static initialize() {\n        // @ts-ignore TODO\n        game.socket.on(Settings.SOCKET_NAME, (event) => {\n            try {\n                const { userIds, type, payload } = event;\n                // null = all users, otherwise check if this event effects us\n                if (userIds !== null && !userIds.includes(game.userId)) {\n                    return;\n                }\n\n                if (type === SetViewEvent.EVENT_TYPE) {\n                    Socket.handleSetView(payload);\n                    return;\n                } else if (type === PreloadEvent.EVENT_TYPE) {\n                    Socket.handlePreloadPDF(payload);\n                    return;\n                } else {\n                    if (type.includes('PDFOUNDRY')) {\n                        console.error(`Event of type ${type} has no handler.`);\n                        return;\n                    }\n                }\n            } catch (e) {\n                // Pass\n            }\n        });\n    }\n\n    public static handleSetView(data: any) {\n        if (Settings.get(Settings.SETTINGS_KEY.EXISTING_VIEWER)) {\n            function appIsViewer(app: Application): app is StaticViewer {\n                return app['pdfData'] !== undefined;\n            }\n\n            for (const app of Object.values(ui.windows)) {\n                if (!appIsViewer(app)) {\n                    continue;\n                }\n\n                const pdfData = app.pdfData;\n                if (data.pdfData.url === pdfData.url) {\n                    app.page = data.page;\n                    return;\n                }\n            }\n            // App not found, fall through.\n        }\n        Api.openPDF(data.pdfData, {\n            page: data.page,\n        });\n    }\n\n    public static handlePreloadPDF(data: any) {\n        PDFCache.preload(data.url);\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport SocketEvent from './SocketEvent';\n\n/**\n * @private\n */\nexport default class PreloadEvent extends SocketEvent {\n    public static get EVENT_TYPE() {\n        return `${super.EVENT_TYPE}/PRELOAD_PDF`;\n    }\n\n    get type() {\n        return PreloadEvent.EVENT_TYPE;\n    }\n\n    public url: string;\n\n    constructor(userIds: string[] | null, url: string) {\n        super(userIds);\n\n        this.url = url;\n    }\n\n    protected getPayload(): any {\n        const payload = super.getPayload();\n        payload.url = this.url;\n        return payload;\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport SocketEvent from './SocketEvent';\nimport { PDFData } from '../../common/types/PDFData';\n\n/**\n * @private\n */\nexport default class SetViewEvent extends SocketEvent {\n    public static get EVENT_TYPE() {\n        return `${super.EVENT_TYPE}/SET_VIEW`;\n    }\n\n    get type() {\n        return SetViewEvent.EVENT_TYPE;\n    }\n\n    public page: number;\n    public pdfData: PDFData;\n\n    constructor(userIds: string[] | null, pdfData: PDFData, page: number) {\n        super(userIds);\n\n        this.pdfData = pdfData;\n        this.page = page;\n    }\n\n    protected getPayload() {\n        const payload = super.getPayload();\n        payload.pdfData = this.pdfData;\n        payload.page = this.page;\n        return payload;\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../../Settings';\n\n/**\n * @private\n */\nexport default abstract class SocketEvent {\n    /**\n     * The type of this event.\n     */\n    public static get EVENT_TYPE() {\n        return 'PDFOUNDRY';\n    }\n\n    /**\n     * The type of this event.\n     */\n    public abstract get type();\n\n    /**\n     * The user ids that should handle this event.\n     */\n    protected userIds: string[] | null;\n\n    protected constructor(userIds: string[] | null) {\n        this.userIds = userIds;\n    }\n\n    /**\n     * Get any data that will be sent with the event.\n     */\n    protected getPayload(): any {\n        return {};\n    }\n\n    public emit() {\n        // @ts-ignore TODO\n        game.socket.emit(Settings.SOCKET_NAME, {\n            type: this.type,\n            userIds: this.userIds,\n            payload: this.getPayload(),\n        });\n    }\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\nimport ActorSheetSelect from '../app/ActorSheetSelect';\nimport { getAbsoluteURL, getPDFData } from '../Util';\nimport PDFActorSheetAdapter from '../app/PDFActorSheetAdapter';\nimport FillableViewer from './FillableViewer';\nimport { PDFData } from '../common/types/PDFData';\nimport PDFActorDataBrowser from '../app/PDFActorDataBrowser';\n\n/**\n * The FillableViewer class provides an interface for displaying, serializing, and observing form-fillable PDFs,\n *  all while connecting their data to a specific actor. Extends the Fillable Viewer.\n * @module API\n */\nexport default class ActorViewer extends FillableViewer {\n    // <editor-fold desc=\"Static Properties\"></editor-fold>\n    // <editor-fold desc=\"Static Methods\"></editor-fold>\n\n    // <editor-fold desc=\"Properties\">\n    protected document: Actor;\n    protected actorSheet: PDFActorSheetAdapter;\n    // </editor-fold>\n\n    // <editor-fold desc=\"Constructor & Initialization\">\n    constructor(actor: Actor, pdfData: PDFData, sheet: PDFActorSheetAdapter, options?: Application.Options) {\n        super(actor, pdfData, options);\n\n        this.document = actor;\n        this.actorSheet = sheet;\n    }\n    // </editor-fold>\n\n    // <editor-fold desc=\"Getters & Setters\">\n\n    get title(): string {\n        return this.document.name;\n    }\n\n    /**\n     * Get the URL for the current sheet from the actor flags.\n     */\n    public getSheetId(): string | undefined {\n        return this.document.getFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.SHEET_ID);\n    }\n\n    /**\n     * Save the URL for the current sheet to the actor flags.\n     * @param value\n     */\n    public async setSheetId(value: string | undefined) {\n        if (typeof value === 'string') {\n            return this.document.setFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.SHEET_ID, value);\n        } else {\n            return this.document.unsetFlag(Settings.MODULE_NAME, Settings.FLAGS_KEY.SHEET_ID);\n        }\n    }\n\n    /**\n     * Get pdf data for the currently set PDF sheet id\n     */\n    public getSheetPdf(): PDFData | undefined {\n        const id = this.getSheetId();\n        if (id === undefined) return undefined;\n\n        return getPDFData(game.journal.get(id));\n    }\n\n    protected _getHeaderButtons(): any[] {\n        const buttons: any[] = [];\n\n        buttons.unshift({\n            label: 'Close',\n            class: 'close',\n            icon: 'fas fa-times',\n            // actor sheet is responsible for our clean up\n            onclick: (ev) => this.actorSheet.close(),\n        });\n\n        // @ts-ignore\n        const canConfigure = game.user.isGM || (this.document.owner && game.user.can('TOKEN_CONFIGURE'));\n        if (this.options['editable'] && canConfigure) {\n            buttons.unshift({\n                // @ts-ignore TODO 0.8.x\n                label: this.token ? 'Token' : 'Prototype Token',\n                class: 'configure-token',\n                icon: 'fas fa-user-circle',\n                // @ts-ignore TODO 0.8.x\n                onclick: (ev) => this.actorSheet._onConfigureToken(ev),\n            });\n\n            buttons.unshift({\n                label: 'Sheet',\n                class: 'configure-sheet',\n                icon: 'fas fa-cog',\n                // @ts-ignore TODO 0.8.x\n                onclick: (ev) => this.actorSheet._onConfigureSheet(ev),\n            });\n\n            buttons.unshift({\n                class: 'pdf-sheet-select',\n                icon: 'fas fa-user-cog',\n                label: game.i18n.localize('PDFOUNDRY.VIEWER.SelectSheet'),\n                onclick: () => {\n                    const current = this.getSheetId();\n                    new ActorSheetSelect(async (id) => {\n                        await this.setSheetId(id);\n                        await this.actorSheet.close();\n                        const sheet = this.getSheetPdf();\n\n                        if (!sheet) {\n                            await this.setSheetId(undefined);\n                        }\n\n                        await this.actorSheet.render(true);\n                    }, current).render(true);\n                },\n            });\n\n            if (game.user.isGM) {\n                buttons.unshift({\n                    class: 'pdf-browse-data',\n                    icon: 'fas fa-search',\n                    label: game.i18n.localize('PDFOUNDRY.VIEWER.InspectData'),\n                    onclick: () => {\n                        new PDFActorDataBrowser(this.document).render(true);\n                    },\n                });\n            }\n        }\n\n        return buttons;\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Instance Methods\">\n\n    protected async onViewerReady(): Promise<void> {\n        super.onViewerReady();\n        const sheet = this.getSheetPdf();\n        if (sheet) {\n            const url = getAbsoluteURL(sheet.url);\n            await this.open(url);\n        }\n    }\n\n    async open(pdfSource: string | Uint8Array, page?: number): Promise<void> {\n        if (pdfSource instanceof Uint8Array) {\n            throw new Error('Actor Sheets must be opened by ID');\n        }\n\n        try {\n            await super.open(pdfSource, page);\n        } catch (error) {\n            // @ts-ignore TODO: THIS IS SUPER FUCKING HACK AND THE WHOLE FLOW NEEDS TO BE ANALYZED\n            if (!(await srcExists(pdfSource))) {\n                ui.notifications.error(game.i18n.localize('PDFOUNDRY.ERROR.FileNotFound'));\n                await this.setSheetId(undefined);\n            }\n\n            await this.actorSheet.close();\n            new PDFActorSheetAdapter(this.document, this.options).render(true);\n        }\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Settings from '../Settings';\nimport EventStore from '../common/helpers/events';\nimport { PDFViewerEvent } from '../common/types/PDFHooks';\nimport { PDFjsViewer } from '../common/types/PDFjsViewer';\nimport { PDFjsEventBus } from '../common/types/PDFjsEventBus';\nimport { BUTTON_GITHUB, BUTTON_KOFI } from '../common/helpers/header';\nimport Api from '../Api';\nimport { getAbsoluteURL } from '../Util';\n\n/**\n * The base viewer class from which all other types of viewers inherit.\n * @see {@link StaticViewer}\n * @see {@link FillableViewer}\n * @see {@link ActorViewer}\n * @module API\n */\nexport default abstract class BaseViewer extends Application {\n    // <editor-fold desc=\"Static Properties\">\n\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n        options.classes = ['app', 'window-app', 'pdfoundry-viewer'];\n        options.template = `${Settings.PATH_TEMPLATES}/app/viewer/static.html`;\n        options.title = game.i18n.localize('PDFOUNDRY.VIEWER.ViewPDF');\n        options.width = 8.5 * 100 + 64;\n        options.height = 11 * 100 + 64;\n        options.resizable = true;\n        return options;\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Properties\">\n\n    protected _frame: HTMLIFrameElement;\n    protected _viewer: PDFjsViewer;\n    protected _eventBus: PDFjsEventBus;\n    protected _eventStore: EventStore<PDFViewerEvent>;\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Constructor & Initialization\">\n\n    protected constructor(options?: Application.Options) {\n        super(options);\n        this._eventStore = new EventStore<PDFViewerEvent>();\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Instance Methods\">\n\n    /**\n     * Finish the download and return the byte array for the file.\n     * @returns A promise that resolves to {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array|Uint8Array}\n     *  of file bytes once that download is finished. You can pass this to a viewer to open it, or do something else with it.\n     */\n    public download(): Promise<Uint8Array> {\n        return new Promise<Uint8Array>(async (resolve) => {\n            const viewer = await this.getViewer();\n            let timeout;\n            const returnOrWait = () => {\n                if (viewer.downloadComplete) {\n                    resolve(viewer.pdfDocument.getData());\n                    return;\n                }\n\n                timeout = setTimeout(returnOrWait, 50);\n            };\n            returnOrWait();\n        });\n    }\n\n    /**\n     * Open a PDF\n     * @param pdfSource A URL or byte array to open.\n     * @param page The initial page to open to\n     */\n    public async open(pdfSource: string | Uint8Array, page?: number | string) {\n        const pdfjsViewer = await this.getViewer();\n\n        if (typeof page === 'string') {\n            page = parseInt(page);\n        }\n\n        if (page) {\n            pdfjsViewer.initialBookmark = `page=${page}`;\n        }\n\n        await pdfjsViewer.initializedPromise;\n        await pdfjsViewer.open(pdfSource);\n        await pdfjsViewer.pdfViewer.pagesPromise;\n\n        // See #19 - fixes other scroll modes not loading with initial bookmark\n        if (page && pdfjsViewer.page !== page) {\n            pdfjsViewer.page = page;\n        }\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Getters & Setters\">\n\n    /**\n     * Get the currently viewed page.\n     */\n    public get page() {\n        return this._viewer.page;\n    }\n\n    /**\n     * Set the currently viewed page.\n     * @param value\n     */\n    public set page(value: number) {\n        this._viewer.page = value;\n    }\n\n    /**\n     * Returns the localized name of the window title.\n     * @override\n     */\n    public get title(): string {\n        return game.i18n.localize('PDFOUNDRY.VIEWER.ViewPDF');\n    }\n\n    /**\n     * Wait for the internal PDFjs viewer to be ready and usable.\n     */\n    protected getViewer(): Promise<PDFjsViewer> {\n        if (this._viewer) {\n            return Promise.resolve(this._viewer);\n        }\n\n        return new Promise<any>((resolve) => {\n            let timeout;\n            const returnOrWait = () => {\n                // If our window has finished initializing...\n                if (this._frame) {\n                    // If PDFjs has finished initializing...\n                    if (this._frame.contentWindow && this._frame.contentWindow['PDFViewerApplication']) {\n                        const viewer = this._frame.contentWindow['PDFViewerApplication'];\n\n                        resolve(viewer);\n                        return;\n                    }\n                }\n\n                // If any ifs fall through, try again in a few ms\n                timeout = setTimeout(returnOrWait, 5);\n            };\n            returnOrWait();\n        });\n    }\n\n    /**\n     * Wait for the internal PDFjs eventBus to be ready and usable.\n     */\n    protected getEventBus(): Promise<PDFjsEventBus> {\n        if (this._eventBus) {\n            return Promise.resolve(this._eventBus);\n        }\n\n        return new Promise<any>((resolve) => {\n            this.getViewer().then((viewer) => {\n                let timeout;\n                const returnOrWait = () => {\n                    if (viewer.eventBus) {\n                        resolve(viewer.eventBus);\n                        return;\n                    }\n                    timeout = setTimeout(returnOrWait, 5);\n                };\n                returnOrWait();\n            });\n        });\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Foundry Overrides\">\n\n    protected _getHeaderButtons(): any[] {\n        const buttons = super._getHeaderButtons();\n        buttons.unshift(BUTTON_GITHUB);\n        buttons.unshift(BUTTON_KOFI);\n        return buttons;\n    }\n\n    /**\n     * @internal\n     */\n    public getData(options?: any): any | Promise<any> {\n        const data = super.getData(options);\n        data.viewerFramePath = `${Settings.PATH_PDFJS}/web/viewer.html`;\n        return data;\n    }\n\n    protected async activateListeners(html: JQuery): Promise<void> {\n        this.onViewerOpening();\n        super.activateListeners(html);\n\n        this._frame = html.parent().find('iframe.pdfViewer').get(0) as HTMLIFrameElement;\n        this.getViewer().then(async (viewer) => {\n            this._viewer = viewer;\n\n            const theme = Api.activeTheme;\n            const frameDocument = $(this._frame.contentDocument as Document);\n            const head = frameDocument.find('head');\n            head.append($(`<link href=\"${getAbsoluteURL(theme.filePath)}\" rel=\"stylesheet\" type=\"text/css\" media=\"all\">`));\n\n            this.onViewerOpened();\n\n            this.getEventBus().then((eventBus) => {\n                this._eventBus = eventBus;\n                this._eventBus.on('pagerendered', this.onPageRendered.bind(this));\n                this._eventBus.on('pagechanging', this.onPageChanging.bind(this));\n                this._eventBus.on('updateviewarea', this.onViewAreaUpdated.bind(this));\n                this._eventBus.on('scalechanging', this.onScaleChanging.bind(this));\n\n                this.onViewerReady();\n            });\n        });\n\n        // _getHeaderButtons does not permit title attributes used for tooltips...\n        $(html).parents().parents().find('.pdf-sheet-show-players').prop('title', game.i18n.localize('PDFOUNDRY.VIEWER.ShowToPlayersTitle'));\n    }\n\n    /**\n     * Close the application and un-register references to it within UI mappings\n     * This function returns a Promise which resolves once the window closing animation concludes\n     */\n    public async close(): Promise<void> {\n        this.onViewerClosing();\n\n        await super.close();\n\n        this.onViewerClosed();\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Events\">\n\n    /**\n     * Fires when the viewer window first starts opening\n     * @protected\n     */\n    protected onViewerOpening() {\n        this._eventStore.fire('viewerOpening', this);\n    }\n\n    /**\n     * Fires when the viewer window is fully opened, but not yet ready\n     * @protected\n     */\n    protected onViewerOpened() {\n        this._eventStore.fire('viewerOpened', this);\n    }\n\n    /**\n     * Fires when the viewer window is fully opened and is ready for use\n     * @protected\n     */\n    protected onViewerReady() {\n        this._eventStore.fire('viewerReady', this);\n    }\n\n    /**\n     * Fires when the viewer window first starts closing\n     * @protected\n     */\n    protected onViewerClosing() {\n        this._eventStore.fire('viewerClosing', this);\n    }\n\n    /**\n     * Fires when the viewer window is fully closed\n     * @protected\n     */\n    protected onViewerClosed() {\n        this._eventStore.fire('viewerClosed', this);\n    }\n\n    /**\n     * Occurs during scrolling when a page passes the breakpoint\n     * @param event\n     * @protected\n     */\n    protected onPageChanging(event) {\n        this._eventStore.fire('pageChanging', this, {\n            pageLabel: event.pageLabel,\n            pageNumber: event.pageNumber,\n        });\n    }\n\n    /**\n     * Occurs when a new page is loaded and rendered\n     * @param event\n     * @protected\n     */\n    protected onPageRendered(event) {\n        this._eventStore.fire('pageRendered', this, {\n            pageNumber: event.pageNumber,\n            pageLabel: event.source.pageLabel,\n            width: event.source.width,\n            height: event.source.height,\n            rotation: event.source.rotation,\n            scale: event.source.scale,\n            canvas: event.source.canvas,\n            div: event.source.div,\n            error: event.source.error,\n        });\n    }\n\n    /**\n     * Occurs when the zoom is changed or window scrolled\n     * @param event\n     * @protected\n     */\n    protected onViewAreaUpdated(event) {\n        this._eventStore.fire('viewAreaUpdated', this, {\n            top: event.location.top,\n            left: event.location.left,\n            pageNumber: event.location.pageNumber,\n            rotation: event.location.rotation,\n            scale: event.location.scale,\n        });\n    }\n\n    /**\n     * Occurs when the zoom is changed\n     * @param event\n     * @protected\n     */\n    protected onScaleChanging(event) {\n        this._eventStore.fire('scaleChanging', this, {\n            presetValue: event.presetValue,\n            scale: event.scale,\n        });\n    }\n\n    /**\n     * Register a callback to occur when an event fires. See individual events for descriptions and use {@link Api.DEBUG.EVENTS} to log and analyze events.\n     * @param eventName\n     * @param callback\n     * @category Events\n     */\n    public on(eventName: PDFViewerEvent, callback: Function): void {\n        this._eventStore.on(eventName, callback);\n    }\n\n    /**\n     * Deregister an event that has been registered with {@link on} or {@link once}.\n     * @param eventName\n     * @param callback\n     * @category Events\n     */\n    public off(eventName: PDFViewerEvent, callback: Function): void {\n        this._eventStore.off(eventName, callback);\n    }\n\n    /**\n     * Like {@link on} but only fires on the next occurrence.\n     * @param eventName\n     * @param callback\n     * @category Events\n     */\n    public once(eventName: PDFViewerEvent, callback: Function): void {\n        this._eventStore.once(eventName, callback);\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport BaseViewer from './BaseViewer';\nimport Settings from '../Settings';\nimport { PDFData } from '../common/types/PDFData';\n\n// TODO: Move to wrapped input model to standardize inputs.\n//  Current code is insane and has too much branching.\n//  Factory should be used to create the wrapped inputs.\n// /**\n//  * Wraps an input to standardize operations over various HTML elements.\n//  * @internal\n//  */\n// abstract class FormInput<TElement extends HTMLElement, TValue> {\n//     protected _element: TElement;\n//     protected _name: string;\n//     protected _value: TValue;\n//\n//     public static IsOfType(element: HTMLElement) {\n//         return false;\n//     }\n//\n//     /**\n//      * Return the HTML element for this input.\n//      */\n//     public get element() {\n//         return this._element;\n//     }\n//\n//     /**\n//      * Return the name of this input.\n//      */\n//     public get name() {\n//         return this._name;\n//     }\n//\n//     protected constructor(name: string, element: TElement, value: TValue) {\n//         this._name = name;\n//         this._element = element;\n//         this._value = value;\n//\n//         $(this._element).attr('name', this._name);\n//     }\n//\n//     /**\n//      * Get the value of this input.\n//      */\n//     public abstract get value();\n//\n//     /**\n//      * Set the value of this input.\n//      * @param newValue The value to set to.\n//      */\n//     public abstract set value(newValue: TValue);\n//\n//     public abstract onInputChanged(event: JQuery.ChangeEvent);\n// }\n//\n// class InputInput extends FormInput<HTMLInputElement, string> {\n//     public static IsOfType(element: HTMLElement): element is HTMLInputElement {\n//         return element.tagName === 'INPUT';\n//     }\n//\n//     onInputChanged(event: JQuery.ChangeEvent) {}\n//\n//     public get value() {\n//         return this._value;\n//     }\n//\n//     public set value(newValue: string) {\n//         this._value = newValue;\n//     }\n// }\n\n/**\n * Handles base form fillable support, can be used as a stand alone form fillable viewer.\n * @module API\n */\nexport default class FillableViewer extends BaseViewer {\n    // <editor-fold desc=\"Static Properties\">\n\n    static get defaultOptions() {\n        const options = super.defaultOptions;\n        options.template = `${Settings.PATH_TEMPLATES}/app/viewer/fillable.html`;\n        return options;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Static Methods\">\n\n    /**\n     * Validate the data path of the key.\n     * @param path\n     */\n    protected static dataPathValid(path: string): boolean {\n        return !path.includes('_id');\n    }\n\n    /**\n     * Fix keys by removing invalid characters\n     * @param key\n     */\n    protected static fixKey(key: string): string {\n        if (key.startsWith(`data.`)) {\n            return key;\n        }\n\n        key = key.trim();\n        return key.replace(/\\s/g, '_');\n    }\n\n    /**\n     * Resolve a key path to the proper flattened key\n     * @param key\n     */\n    protected static resolveKeyPath(key: string): string {\n        if (key === 'name') return key;\n        if (key.startsWith(`data.`)) {\n            return this.fixKey(key);\n        }\n\n        return `flags.${Settings.MODULE_NAME}.${Settings.FLAGS_KEY.FORM_DATA}.${this.fixKey(key)}`;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Properties\">\n\n    protected document: Entity;\n    protected pdfData: PDFData;\n    private container: JQuery;\n\n    // </editor-fold>\n    // <editor-fold desc=\"Constructor & Initialization\">\n\n    public constructor(entity: JournalEntry | Actor, pdfData: PDFData, options?: Application.Options) {\n        super(options);\n\n        this.document = entity;\n        this.pdfData = pdfData;\n\n        this.bindHooks();\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Getters & Setters\">\n\n    protected flattenEntity(): Record<string, string> {\n        const data = flattenObject({\n            name: this.document.name,\n            data: this.document.data.data,\n            flags: this.document.data.flags,\n        }) as Record<string, string>;\n\n        // Do not allow non-data keys to make it into the flat object\n        for (const key of Object.keys(data)) {\n            if (!FillableViewer.dataPathValid(key)) {\n                delete data[key];\n            }\n        }\n\n        return data;\n    }\n\n    // </editor-fold>\n    // <editor-fold desc=\"Instance Methods\">\n\n    protected bindHooks(): void {\n        if (this.document.uuid.startsWith('Actor')) {\n            Hooks.on('updateActor', this.onUpdateEntity.bind(this));\n        } else if (this.document.uuid.startsWith('Item')) {\n            Hooks.on('updateItem', this.onUpdateEntity.bind(this));\n        }\n    }\n\n    protected unbindHooks(): void {\n        if (this.document.uuid.startsWith('Actor')) {\n            Hooks.off('updateActor', this.onUpdateEntity.bind(this));\n        } else if (this.document.uuid.startsWith('Item')) {\n            Hooks.off('updateItem', this.onUpdateEntity.bind(this));\n        }\n    }\n\n    protected elementIsCheckbox(element: HTMLElement): element is HTMLInputElement {\n        return element.tagName === 'INPUT' && element.getAttribute('type') === 'checkbox';\n    }\n\n    protected elementIsInput(element: HTMLElement): element is HTMLInputElement | HTMLTextAreaElement {\n        return (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') && element.getAttribute('type') !== 'radio';\n    }\n\n    protected elementIsSelect(element: HTMLElement): element is HTMLSelectElement {\n        return element.tagName === 'SELECT';\n    }\n\n    protected elementIsRadio(element: HTMLElement): element is HTMLInputElement {\n        return element.tagName === 'INPUT' && element.getAttribute('type') === 'radio';\n    }\n\n    protected onPageRendered(event) {\n        const POLL_INTERVAL = 5;\n        const MAX_POLL_TIME = 250;\n        const container = $(event.source.div);\n\n        new Promise<any>((resolve, reject) => {\n            let timeout;\n            let totalWait = 0;\n            let elements: JQuery<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>;\n\n            const returnOrWait = () => {\n                elements = container.find('input, textarea, select') as JQuery<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>;\n\n                if (elements.length > 0) {\n                    clearTimeout(timeout);\n                    resolve(elements);\n                    return;\n                } else if (totalWait < MAX_POLL_TIME) {\n                    totalWait += POLL_INTERVAL;\n                    timeout = setTimeout(returnOrWait, POLL_INTERVAL);\n                } else {\n                    reject({\n                        message: 'Page did not render in the allowed time.',\n                        event,\n                    });\n                }\n            };\n            returnOrWait();\n        })\n            .then((elements: JQuery<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {\n                if (this.container === undefined || this.container.length === 0) {\n                    this.container = $(container.parents().find('#viewerContainer'));\n                }\n\n                this.initializeInputs(elements);\n\n                elements.on('change', this.onInputChanged.bind(this));\n\n                super.onPageRendered(event);\n            })\n            .catch((reason) => console.error(reason));\n    }\n\n    protected onInputChanged(event) {\n        const element = event.currentTarget;\n        let value = '';\n\n        let key = $(element).attr('name');\n        if (key === undefined) {\n            return;\n        }\n\n        key = FillableViewer.resolveKeyPath(key);\n\n        if (!FillableViewer.dataPathValid(key)) {\n            return;\n        }\n\n        if (this.elementIsCheckbox(element)) {\n            value = this.getCheckInputValue($(element));\n        } else if (this.elementIsInput(element)) {\n            value = this.getTextInputValue($(element as HTMLInputElement | HTMLTextAreaElement));\n        } else if (this.elementIsSelect(element)) {\n            value = this.getTextInputValue($(element as HTMLSelectElement));\n        } else if (this.elementIsRadio(element)) {\n            value = this.getRadioInputValue($(element));\n        }\n\n        this.update(\n            this.resolveDelta(this.flattenEntity(), {\n                [key]: value,\n            }),\n        ).then((result) => {\n            const elementsToUpdate = this.container.find('input, textarea, select');\n            this.initializeInputs(elementsToUpdate);\n        });\n    }\n\n    protected initializeInputs(elements: JQuery) {\n        const oldData = this.flattenEntity();\n        const newData = duplicate(oldData);\n\n        // Load data from sheet as initialization data\n        // Fill in existing data where it exists on the actor\n        let write = false;\n        for (const element of elements) {\n            let key = element.getAttribute('name');\n            if (key === null || !FillableViewer.dataPathValid(key)) {\n                continue;\n            }\n\n            key = FillableViewer.resolveKeyPath(key);\n\n            if (this.elementIsCheckbox(element)) {\n                write = this.initializeCheckInput($(element), key, newData) || write;\n            } else if (this.elementIsInput(element)) {\n                write = this.initializeTextInput($(element), key, newData) || write;\n            } else if (this.elementIsSelect(element)) {\n                write = this.initializeTextInput($(element), key, newData) || write;\n            } else if (this.elementIsRadio(element)) {\n                write = this.initializeRadioInput($(element), key, newData) || write;\n            } else {\n                console.error('Unsupported input type in PDF.');\n            }\n        }\n\n        if (write) {\n            this.update(this.resolveDelta(oldData, newData));\n        }\n    }\n\n    protected resolveDelta(oldData: Record<string, any>, newData: Record<string, any>) {\n        // Flags must be fully resolved\n        const delta = { ...flattenObject({ flags: this.document.data.flags }) };\n        for (const [key, newValue] of Object.entries(newData)) {\n            const oldValue = oldData[key];\n\n            // Arrays dont make sense on PDFs which are not dynamic\n            if (Array.isArray(newValue) || Array.isArray(oldValue)) {\n                delete delta[key];\n                continue;\n            }\n\n            // Skip matching values\n            if (oldValue !== undefined && newValue === oldValue) {\n                continue;\n            }\n\n            delta[key] = newValue;\n        }\n\n        return delta;\n    }\n\n    public refreshTitle(): void {\n        $(this.element).find('.window-title').text(this.title);\n    }\n\n    protected onUpdateEntity(actor: Actor, data: Partial<Actor.Data> & { _id: string }, options: { diff: boolean }, id: string) {\n        if (data._id !== this.document.id) {\n            return;\n        }\n\n        const args = duplicate(data);\n        // @ts-ignore\n        delete args['_id'];\n\n        const elementsToUpdate = this.container.find('input, textarea, select');\n        this.initializeInputs(elementsToUpdate);\n        this.refreshTitle();\n    }\n\n    protected async update(delta: object) {\n        // data must be expanded to set properly\n        // TODO: Flags seem to be always set - delta needs checking\n        return this.document.update(expandObject(delta));\n    }\n\n    protected initializeTextInput(\n        input: JQuery<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>,\n        key: string,\n        data: Record<string, string>,\n    ): boolean {\n        let value = data[key];\n        if (value === undefined) {\n            // If value does not exist on actor yet, load from sheet\n            const inputValue = input.val();\n\n            if (inputValue) {\n                // Actor changes were made\n                data[key] = inputValue.toString();\n                return true;\n            }\n        } else {\n            // Otherwise initialize input value to actor value\n            this.setTextInput(input, value);\n        }\n        return false;\n    }\n\n    protected initializeCheckInput(input: JQuery<HTMLInputElement>, key: string, data: Record<string, string>): boolean {\n        let value = data[key];\n        if (value === undefined) {\n            const inputValue = input.attr('checked') !== undefined;\n\n            // Actor changes were made\n            data[key] = inputValue.toString();\n            return true;\n        } else {\n            this.setCheckInput(input, value);\n        }\n        return false;\n    }\n\n    protected initializeRadioInput(input: JQuery<HTMLInputElement>, key: string, data: Record<string, string>): boolean {\n        let value = data[key];\n        if (value === undefined || value === '') {\n            data[key] = this.getRadioInputValue(input);\n            return true;\n        } else {\n            // if we're looking at the right radio for the group enable it\n            if (data[key] === input.attr('id')) {\n                this.setCheckInput(input, 'true');\n            } else {\n                this.setCheckInput(input, 'false');\n            }\n        }\n        return false;\n    }\n\n    protected setTextInput(input: JQuery<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>, value: string) {\n        input.val(value);\n    }\n\n    protected setCheckInput(input: JQuery<HTMLInputElement>, value: string) {\n        if (value === 'true') {\n            input.attr('checked', 'true');\n        } else {\n            input.removeAttr('checked');\n        }\n    }\n\n    protected getTextInputValue(input: JQuery<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>): string {\n        const value = input.val();\n        if (!value) {\n            return '';\n        }\n\n        return value.toString().trim();\n    }\n\n    protected getCheckInputValue(input: JQuery<HTMLInputElement>): string {\n        return (window.getComputedStyle(input.get(0), ':before').content !== 'none').toString();\n    }\n\n    protected getRadioInputValue(input: JQuery<HTMLInputElement>): string {\n        const name = input.attr('name');\n        const elements = $(this.container).find(`input[name=\"${name}\"]`) as JQuery<HTMLElement>;\n        for (let i = 0; i < elements.length; i++) {\n            const element = elements.get(i);\n            if (window.getComputedStyle(element, ':before').content !== 'none') {\n                return element.id;\n            }\n        }\n        return '';\n    }\n\n    async close(): Promise<any> {\n        // await this.setActorData(this.actorData);\n        if (this._viewer) {\n            await this._viewer.close();\n        }\n\n        this.unbindHooks();\n\n        return super.close();\n    }\n\n    // </editor-fold>\n}\n","/* Copyright 2020 Andrew Cuccinello\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { PDFData } from '../common/types/PDFData';\nimport BaseViewer from './BaseViewer';\nimport PlayerSelect from '../app/PlayerSelect';\nimport { getUserIdsExceptMe } from '../Util';\nimport SetViewEvent from '../socket/events/SetViewEvent';\nimport { PDFType } from '../common/types/PDFType';\n\n/**\n * The PDFoundry StaticViewer class opens PDFs and provides event hooks for observing the viewer.\n * Static viewers display a PDF but do not render or instantiate any fillable fields or their data.\n *\n * You cannot create a new instance of this class, you must do so with the API.\n *\n * See {@link Api.openPDF}, {@link Api.openPDFByCode}, {@link Api.openPDFByName}, {@link Api.openURL}\n *  which all return a promise which resolve with an instance of this class.\n * @module API\n */\nexport default class StaticViewer extends BaseViewer {\n    // <editor-fold desc=\"Properties\">\n\n    protected _pdfData: PDFData;\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Constructor & Initialization\">\n\n    constructor(pdfData?: PDFData, options?: Application.Options) {\n        super(options);\n\n        if (pdfData === undefined) {\n            pdfData = {\n                name: game.i18n.localize('PDFOUNDRY.VIEWER.ViewPDF'),\n                code: '',\n                offset: 0,\n                url: '',\n                type: PDFType.Static,\n                cache: false,\n            };\n        }\n\n        this._pdfData = pdfData;\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Getters & Setters\">\n\n    /**\n     * Returns a copy of the PDFData this viewer is using.\n     * Changes to this data will not reflect in the viewer.\n     */\n    public get pdfData() {\n        return duplicate(this._pdfData);\n    }\n\n    public get title(): string {\n        let title = this._pdfData.name;\n        if (this._pdfData.code !== '') {\n            title = `${title} (${this._pdfData.code})`;\n        }\n        return title;\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Foundry Overrides\">\n\n    protected _getHeaderButtons(): any[] {\n        const buttons = super._getHeaderButtons();\n\n        buttons.unshift({\n            class: 'pdf-sheet-show-players',\n            icon: 'fas fa-eye',\n            label: game.i18n.localize('PDFOUNDRY.VIEWER.ShowToPlayersText'),\n            onclick: (event) => this.showTo(event),\n        });\n\n        return buttons;\n    }\n\n    // </editor-fold>\n\n    // <editor-fold desc=\"Instance Methods\">\n\n    /**\n     * Show the current page to GMs.\n     */\n    protected showTo(event: MouseEvent) {\n        const pdfData = this.pdfData;\n        pdfData.offset = 0;\n\n        const ids = getUserIdsExceptMe();\n        if (event.shiftKey) {\n            new SetViewEvent(ids, pdfData, this.page).emit();\n        } else {\n            new PlayerSelect(ids, (filteredIds) => {\n                new SetViewEvent(filteredIds, pdfData, this.page).emit();\n            }).render(true);\n        }\n    }\n    // </editor-fold>\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvcGRmb3VuZHJ5L0FwaS50cyIsInNyYy9wZGZvdW5kcnkvTWFpbi50cyIsInNyYy9wZGZvdW5kcnkvU2V0dGluZ3MudHMiLCJzcmMvcGRmb3VuZHJ5L1NldHVwLnRzIiwic3JjL3BkZm91bmRyeS9VdGlsLnRzIiwic3JjL3BkZm91bmRyeS9hcHAvQWN0b3JTaGVldFNlbGVjdC50cyIsInNyYy9wZGZvdW5kcnkvYXBwL1BERkFjdG9yRGF0YUJyb3dzZXIudHMiLCJzcmMvcGRmb3VuZHJ5L2FwcC9QREZBY3RvclNoZWV0QWRhcHRlci50cyIsInNyYy9wZGZvdW5kcnkvYXBwL1BERkNvbmZpZy50cyIsInNyYy9wZGZvdW5kcnkvYXBwL1BsYXllclNlbGVjdC50cyIsInNyYy9wZGZvdW5kcnkvYXBwL1NlbGVjdEFwcC50cyIsInNyYy9wZGZvdW5kcnkvY2FjaGUvQ2FjaGVFcnJvci50cyIsInNyYy9wZGZvdW5kcnkvY2FjaGUvQ2FjaGVIZWxwZXIudHMiLCJzcmMvcGRmb3VuZHJ5L2NhY2hlL1BERkNhY2hlLnRzIiwic3JjL3BkZm91bmRyeS9jb21tYW5kcy9DaGF0Q29tbWFuZC50cyIsInNyYy9wZGZvdW5kcnkvY29tbWFuZHMvRml4TWlzc2luZ1R5cGVzLnRzIiwic3JjL3BkZm91bmRyeS9jb21tYW5kcy9QdXJnZUNhY2hlLnRzIiwic3JjL3BkZm91bmRyeS9jb21tb24vV2hpdGVsaXN0LnRzIiwic3JjL3BkZm91bmRyeS9jb21tb24vaGVscGVycy9ldmVudHMudHMiLCJzcmMvcGRmb3VuZHJ5L2NvbW1vbi9oZWxwZXJzL2hlYWRlci50cyIsInNyYy9wZGZvdW5kcnkvY29tbW9uL3R5cGVzL1BERlR5cGUudHMiLCJzcmMvcGRmb3VuZHJ5L2VucmljaGVyL0hUTUxFbnJpY2hlci50cyIsInNyYy9wZGZvdW5kcnkvZW5yaWNoZXIvVGlueU1DRVBsdWdpbi50cyIsInNyYy9wZGZvdW5kcnkvbWlncmF0ZS9NaWdyYXRlTGVnYWN5LnRzIiwic3JjL3BkZm91bmRyeS9zb2NrZXQvU29ja2V0LnRzIiwic3JjL3BkZm91bmRyeS9zb2NrZXQvZXZlbnRzL1ByZWxvYWRFdmVudC50cyIsInNyYy9wZGZvdW5kcnkvc29ja2V0L2V2ZW50cy9TZXRWaWV3RXZlbnQudHMiLCJzcmMvcGRmb3VuZHJ5L3NvY2tldC9ldmVudHMvU29ja2V0RXZlbnQudHMiLCJzcmMvcGRmb3VuZHJ5L3ZpZXdlci9BY3RvclZpZXdlci50cyIsInNyYy9wZGZvdW5kcnkvdmlld2VyL0Jhc2VWaWV3ZXIudHMiLCJzcmMvcGRmb3VuZHJ5L3ZpZXdlci9GaWxsYWJsZVZpZXdlci50cyIsInNyYy9wZGZvdW5kcnkvdmlld2VyL1N0YXRpY1ZpZXdlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUNBQTs7Ozs7Ozs7Ozs7OztHQWFHOzs7QUFFSDs7Ozs7R0FLRztBQUVILGlDQVVnQjtBQUNoQix3REFBaUQ7QUFFakQseUNBQWtDO0FBQ2xDLCtDQUF3QztBQUV4QyxvREFBaUQ7QUFDakQsNERBQXFEO0FBVXJEOzs7Ozs7O0dBT0c7QUFDSSxLQUFLLFVBQVUsV0FBVyxDQUFDLE1BQWtCLEVBQUUsR0FBVyxFQUFFLElBQXdCLEVBQUUsS0FBYztJQUN2RyxJQUFJLEtBQUssRUFBRTtRQUNQLE1BQU0sV0FBVyxHQUFHLE1BQU0sa0JBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDakQsOENBQThDO1FBQzlDLElBQUksV0FBVyxFQUFFO1lBQ2IsTUFBTSxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsQ0FBQztTQUN4QzthQUFNO1lBQ0gscUNBQXFDO1lBQ3JDLE1BQU0sTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDN0Isa0RBQWtEO1lBQ2xELE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRTtnQkFDN0Isa0JBQVEsQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ2xDLENBQUMsQ0FBQyxDQUFDO1NBQ047S0FDSjtTQUFNO1FBQ0gsTUFBTSxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztLQUNoQztBQUNMLENBQUM7QUFqQkQsa0NBaUJDO0FBK0JEOzs7OztHQUtHO0FBQ0gsTUFBcUIsR0FBRztJQWlCcEI7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLFFBQVEsQ0FBQyxFQUFVOztRQUM3QixhQUFPLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsbUNBQUksSUFBSSxDQUFDO0lBQzVDLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sS0FBSyxXQUFXO1FBQ3pCLE1BQU0sRUFBRSxHQUFHLGtCQUFRLENBQUMsR0FBRyxDQUFDLGtCQUFRLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQzVELE9BQU8sR0FBRyxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sS0FBSyxlQUFlO1FBQzdCLE1BQU0sU0FBUyxHQUFHLEVBQUUsQ0FBQztRQUNyQixLQUFLLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLEVBQUU7WUFDakQsU0FBUyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUM7U0FDbkQ7UUFDRCxPQUFPLFNBQVMsQ0FBQztJQUNyQixDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSSxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQVUsRUFBRSxJQUFZLEVBQUUsUUFBZ0I7UUFDbEUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDNUIsTUFBTSxJQUFJLEtBQUssQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1NBQ2pFO1FBRUQsSUFBSSxHQUFHLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxFQUFFO1lBQ3pDLE9BQU8sQ0FBQyxJQUFJLENBQUMsK0JBQStCLEVBQUUsMEJBQTBCLENBQUMsQ0FBQztTQUM3RTtRQUVELElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsR0FBRztZQUN4QixFQUFFO1lBQ0YsSUFBSTtZQUNKLFFBQVE7U0FDWCxDQUFDO0lBQ04sQ0FBQztJQUVELGlCQUFpQjtJQUVqQjs7O09BR0c7SUFDSSxNQUFNLEtBQUssU0FBUztRQUN2QixPQUFPO1lBQ0gsY0FBYyxFQUFkLHFCQUFjO1lBQ2QsY0FBYyxFQUFkLHFCQUFjO1lBQ2QsbUJBQW1CLEVBQW5CLDBCQUFtQjtZQUNuQixXQUFXLEVBQVgsa0JBQVc7WUFDWCxVQUFVLEVBQVYsaUJBQVU7WUFDVixVQUFVLEVBQVYsaUJBQVU7WUFDVixhQUFhLEVBQWIsb0JBQWE7WUFDYixVQUFVLEVBQVYsaUJBQVU7WUFDVixrQkFBa0IsRUFBbEIseUJBQWtCO1NBQ3JCLENBQUM7SUFDTixDQUFDO0lBRUQsMENBQTBDO0lBRTFDOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLGFBQWEsQ0FBQyxRQUFzQixFQUFFLGlCQUEwQixJQUFJO1FBQzlFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxZQUEwQixFQUFFLEVBQUU7WUFDcEQsSUFBSSxDQUFDLGtCQUFXLENBQUMsWUFBWSxDQUFDLEVBQUU7Z0JBQzVCLE9BQU8sS0FBSyxDQUFDO2FBQ2hCO1lBRUQsTUFBTSxPQUFPLEdBQUcsaUJBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN6QyxJQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUU7Z0JBQ3ZCLE9BQU8sS0FBSyxDQUFDO2FBQ2hCO1lBRUQsT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLElBQUksY0FBYyxDQUFDLElBQUksUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3pFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLGlCQUFpQixDQUFDLElBQVksRUFBRSxpQkFBMEIsSUFBSTtRQUN4RSxPQUFPLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxJQUFhLEVBQUUsRUFBRTtZQUNyQyxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssSUFBSSxDQUFDO1FBQzlCLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQztJQUN2QixDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0ksTUFBTSxDQUFDLGlCQUFpQixDQUFDLElBQVksRUFBRSxrQkFBMkIsSUFBSSxFQUFFLGlCQUEwQixJQUFJO1FBQ3pHLElBQUksZUFBZSxFQUFFO1lBQ2pCLE9BQU8sR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO2dCQUM1QixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLEtBQUssSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzFELENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQztTQUN0QjthQUFNO1lBQ0gsT0FBTyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQzVCLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxJQUFJLENBQUM7WUFDOUIsQ0FBQyxFQUFFLGNBQWMsQ0FBQyxDQUFDO1NBQ3RCO0lBQ0wsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksTUFBTSxDQUFDLFdBQVcsQ0FBQyxRQUFzQixFQUFFLGlCQUEwQixJQUFJO1FBQzVFLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBQ3pELElBQUksR0FBRyxLQUFLLElBQUksRUFBRTtZQUNkLE9BQU8sU0FBUyxDQUFDO1NBQ3BCO1FBRUQsT0FBTyxpQkFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFRCxpQkFBaUI7SUFFakIsdUNBQXVDO0lBRXZDOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFZLEVBQUUsT0FBd0I7UUFDcEUsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXpDLElBQUksR0FBRyxLQUFLLFNBQVMsRUFBRTtZQUNuQixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1lBRWxFLEVBQUUsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRTlCLE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNoQztRQUVELE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFZLEVBQUUsT0FBd0I7UUFDcEUsTUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXpDLElBQUksR0FBRyxLQUFLLFNBQVMsRUFBRTtZQUNuQixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRWpDLEVBQUUsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUV0QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7U0FDaEM7UUFFRCxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQVksRUFBRSxPQUF3QjtRQUM5RCxJQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUU7WUFDdkIsT0FBTyxHQUFHLEVBQUUsQ0FBQztTQUNoQjtRQUVELElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLEdBQUcsQ0FBQztRQUVqQyxJQUFJLE9BQU8sTUFBTSxLQUFLLFFBQVEsRUFBRTtZQUM1QixJQUFJLE1BQU0sS0FBSyxFQUFFLEVBQUU7Z0JBQ2YsTUFBTSxHQUFHLENBQUMsQ0FBQzthQUNkO2lCQUFNO2dCQUNILE1BQU0sR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDN0I7U0FDSjthQUFNLElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtZQUN4QixNQUFNLEdBQUcsQ0FBQyxDQUFDO1NBQ2Q7UUFFRCxJQUFJLENBQUMsMEJBQW1CLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDM0IsR0FBRyxHQUFHLHFCQUFjLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDN0I7UUFFRCxJQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO1lBQzVCLE9BQU8sQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksR0FBRyxNQUFNLENBQUM7U0FDeEM7UUFFRCxJQUFJLE1BQWtCLENBQUM7UUFFdkIsUUFBUSxHQUFHLENBQUMsSUFBSSxFQUFFO1lBQ2QsS0FBSyxpQkFBTyxDQUFDLE1BQU07Z0JBQ2YsTUFBTSxHQUFHLElBQUksc0JBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDL0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFFcEIsTUFBTSxXQUFXLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO2dCQUNwRCxNQUFNO1lBQ1YsS0FBSyxpQkFBTyxDQUFDLFFBQVE7Z0JBQ2pCLElBQUksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLFlBQVksWUFBWSxDQUFDLEVBQUU7b0JBQzNDLE1BQU0sSUFBSSxLQUFLLENBQUMsMENBQTBDLENBQUMsQ0FBQztpQkFDL0Q7Z0JBRUQsTUFBTSxHQUFHLElBQUksd0JBQWMsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO2dCQUNqRCxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUVwQixNQUFNLFdBQVcsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7Z0JBQ3BELE1BQU07WUFDVixLQUFLLGlCQUFPLENBQUMsS0FBSztnQkFDZCxNQUFNLElBQUksS0FBSyxDQUFDLG1FQUFtRSxDQUFDLENBQUM7U0FDNUY7UUFDRCxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBRUQ7Ozs7OztPQU1HO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBVyxFQUFFLE9BQWUsQ0FBQyxFQUFFLFFBQWlCLElBQUk7UUFDNUUsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsRUFBRTtZQUMxQixNQUFNLElBQUksS0FBSyxDQUFDLHlCQUF5QixJQUFJLGFBQWEsQ0FBQyxDQUFDO1NBQy9EO1FBRUQsSUFBSSxDQUFDLDBCQUFtQixDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQzNCLEdBQUcsR0FBRyxxQkFBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzdCO1FBRUQsTUFBTSxNQUFNLEdBQUcsSUFBSSxzQkFBWSxFQUFFLENBQUM7UUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVwQixNQUFNLFdBQVcsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztRQUU1QyxPQUFPLE1BQU0sQ0FBQztJQUNsQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRO1FBQ3hCLE1BQU0sa0JBQVEsQ0FBQyxHQUFHLENBQUMsa0JBQVEsQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRTFELE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQzVCLElBQUksVUFBVSxHQUFHLHFCQUFjLENBQUMsR0FBRyxrQkFBUSxDQUFDLFdBQVcsV0FBVyxJQUFJLGFBQWEsQ0FBQyxDQUFDO1FBQ3JGLGFBQWE7UUFDYixNQUFNLFlBQVksR0FBRyxNQUFNLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUVqRCxJQUFJLENBQUMsWUFBWSxFQUFFO1lBQ2YsVUFBVSxHQUFHLHFCQUFjLENBQUMsR0FBRyxrQkFBUSxDQUFDLFdBQVcsdUJBQXVCLENBQUMsQ0FBQztTQUMvRTtRQUVELE1BQU0sT0FBTyxHQUFZO1lBQ3JCLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyx1QkFBdUIsQ0FBQztZQUNqRCxJQUFJLEVBQUUsaUJBQU8sQ0FBQyxNQUFNO1lBQ3BCLElBQUksRUFBRSxFQUFFO1lBQ1IsTUFBTSxFQUFFLENBQUM7WUFDVCxHQUFHLEVBQUUsVUFBVTtZQUNmLEtBQUssRUFBRSxLQUFLO1NBQ2YsQ0FBQztRQUVGLE9BQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNoQyxDQUFDOztBQWhUTCxzQkFtVEM7QUFsVEc7OztHQUdHO0FBQ1csU0FBSyxHQUFHO0lBQ2xCLE9BQU87SUFDUDs7T0FFRztJQUNILE1BQU0sRUFBRSxLQUFLO0NBQ2hCLENBQUM7QUFFRixzQ0FBc0M7QUFFdkIsb0JBQWdCLEdBQWtDLEVBQUUsQ0FBQzs7OztBQzlIeEU7Ozs7Ozs7Ozs7Ozs7R0FhRzs7QUFFSCxtQ0FBNEI7QUFFNUIsZUFBSyxDQUFDLEdBQUcsRUFBRSxDQUFDOzs7O0FDakJaOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBRUgsK0JBQXdCO0FBRXhCOzs7R0FHRztBQUNILE1BQXFCLFFBQVE7SUFHbEIsTUFBTSxLQUFLLFdBQVc7UUFDekIsT0FBTyxXQUFXLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM3QyxDQUFDO0lBQ00sTUFBTSxLQUFLLFdBQVc7UUFDekIsT0FBTyxHQUFHLFFBQVEsQ0FBQyxXQUFXLFNBQVMsQ0FBQztJQUM1QyxDQUFDO0lBQ00sTUFBTSxLQUFLLFdBQVc7UUFDekIsT0FBTyxHQUFHLFFBQVEsQ0FBQyxXQUFXLFNBQVMsQ0FBQztJQUM1QyxDQUFDO0lBQ00sTUFBTSxLQUFLLGNBQWM7UUFDNUIsT0FBTyxHQUFHLFFBQVEsQ0FBQyxXQUFXLFlBQVksQ0FBQztJQUMvQyxDQUFDO0lBQ00sTUFBTSxLQUFLLFVBQVU7UUFDeEIsT0FBTyxHQUFHLFFBQVEsQ0FBQyxXQUFXLFFBQVEsQ0FBQztJQUMzQyxDQUFDO0lBRU0sTUFBTSxLQUFLLFdBQVc7UUFDekIsT0FBTyxVQUFVLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM1QyxDQUFDO0lBdUJNLE1BQU0sQ0FBQyxVQUFVO1FBQ3BCLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxVQUFVLEVBQUU7WUFDaEQsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGtDQUFrQyxDQUFDO1lBQzVELElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxrQ0FBa0MsQ0FBQztZQUM1RCxLQUFLLEVBQUUsTUFBTTtZQUNiLElBQUksRUFBRSxNQUFNO1lBQ1osT0FBTyxFQUFFLEdBQUc7WUFDWixNQUFNLEVBQUUsSUFBSTtZQUNaLFFBQVEsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLEVBQUU7Z0JBQ25CLElBQUksUUFBUSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtvQkFDdkQsT0FBTztpQkFDVjtnQkFFRCxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFDcEIsRUFBRSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO2dCQUN0QixFQUFFLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7Z0JBQ3hCLE1BQU0sUUFBUSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUM3RCxDQUFDO1NBQ0osQ0FBQyxDQUFDO1FBRUgsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLGVBQWUsRUFBRTtZQUNyRCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsNkNBQTZDLENBQUM7WUFDdkUsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDZDQUE2QyxDQUFDO1lBQ3ZFLEtBQUssRUFBRSxNQUFNO1lBQ2IsSUFBSSxFQUFFLE9BQU87WUFDYixPQUFPLEVBQUUsSUFBSTtZQUNiLE1BQU0sRUFBRSxJQUFJO1NBQ2YsQ0FBQyxDQUFDO1FBRUgsUUFBUSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLFlBQVksRUFBRTtZQUNsRCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsb0NBQW9DLENBQUM7WUFDOUQsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLG9DQUFvQyxDQUFDO1lBQzlELEtBQUssRUFBRSxNQUFNO1lBQ2IsSUFBSSxFQUFFLE1BQU07WUFDWixPQUFPLEVBQUUsU0FBUztZQUNsQixPQUFPLEVBQUUsYUFBRyxDQUFDLGVBQWU7WUFDNUIsTUFBTSxFQUFFLElBQUk7U0FDZixDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsU0FBUyxFQUFFO1lBQy9DLEtBQUssRUFBRSxNQUFNO1lBQ2IsSUFBSSxFQUFFLE9BQU87WUFDYixPQUFPLEVBQUUsS0FBSztZQUNkLE1BQU0sRUFBRSxLQUFLO1NBQ2hCLENBQUMsQ0FBQztRQUVILFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxZQUFZLEVBQUU7WUFDbEQsS0FBSyxFQUFFLE9BQU87WUFDZCxJQUFJLEVBQUUsTUFBTTtZQUNaLE9BQU8sRUFBRSxTQUFTO1lBQ2xCLE1BQU0sRUFBRSxLQUFLO1NBQ2hCLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBVyxFQUFFLElBQVM7UUFDekMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQVc7UUFDekIsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQVcsRUFBRSxLQUFVO1FBQzNDLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDL0QsQ0FBQzs7QUE3SEwsMkJBOEhDO0FBN0gwQixvQkFBVyxHQUFXLFdBQVcsQ0FBQztBQXNCbEMsa0JBQVMsR0FBRyxTQUFTLENBQUM7QUFFdEIsaUJBQVEsR0FBRyxtQkFBbUIsQ0FBQztBQUUvQixxQkFBWSxHQUFHO0lBQ2xDLGVBQWUsRUFBRSxzQkFBc0I7SUFDdkMsVUFBVSxFQUFFLFdBQVc7SUFDdkIsWUFBWSxFQUFFLGFBQWE7SUFDM0IsU0FBUyxFQUFFLFVBQVU7SUFDckIsWUFBWSxFQUFFLGFBQWE7Q0FDOUIsQ0FBQztBQUNxQixrQkFBUyxHQUFHO0lBQy9CLFdBQVc7SUFDWCxRQUFRLEVBQUUsU0FBUztJQUNuQixlQUFlO0lBQ2YsU0FBUyxFQUFFLFVBQVU7SUFDckIsUUFBUSxFQUFFLFlBQVk7SUFDdEIsZUFBZTtJQUNmLFdBQVcsRUFBRSxZQUFZO0NBQzVCLENBQUM7Ozs7QUMvRE47Ozs7Ozs7Ozs7Ozs7R0FhRzs7QUFFSCxpQ0FBaUU7QUFDakUsK0RBQXdEO0FBQ3hELDRDQUF5QztBQUN6Qyx5Q0FBa0M7QUFDbEMsK0NBQXdDO0FBQ3hDLCtCQUF5QztBQUN6QywwREFBbUQ7QUFDbkQsNERBQXFEO0FBQ3JELHFFQUE4RDtBQUM5RCxvREFBaUQ7QUFDakQsK0NBQTRDO0FBQzVDLGdFQUF5RDtBQUN6RCxzREFBK0M7QUFDL0MsMkRBQWlGO0FBRWpGOzs7R0FHRztBQUNILE1BQXFCLEtBQUs7SUFDdEI7O09BRUc7SUFDSSxNQUFNLENBQUMsR0FBRztRQUNiLElBQUksV0FBVyxDQUFDLEVBQUUsRUFBRSxXQUFXLENBQUMsRUFBRTtZQUM5QixLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxLQUFLLElBQUksRUFBRTtnQkFDMUIsSUFBSSxDQUFDLEdBQUcsSUFBSSxNQUFNLENBQUM7b0JBQ2YsS0FBSyxFQUFFLGtCQUFrQjtvQkFDekIsT0FBTyxFQUFFO3dCQUNMLDJEQUEyRDt3QkFDM0QsNERBQTREO3dCQUM1RCxvR0FBb0c7NEJBQ2hHLGdEQUFnRDt3QkFDcEQsdUdBQXVHOzRCQUNuRyxtR0FBbUc7NEJBQ25HLHlDQUF5Qzt3QkFDN0MsMEdBQTBHOzRCQUN0RyxnREFBZ0Q7d0JBQ3BELHFGQUFxRjt3QkFDckYsUUFBUTtxQkFDWCxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7b0JBQ1YsT0FBTyxFQUFFLEVBQUU7aUJBQ2QsQ0FBQyxDQUFDO2dCQUNILENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbkIsQ0FBQyxDQUFDLENBQUM7WUFDSCxPQUFPO1NBQ1Y7UUFFRCx1Q0FBdUM7UUFDdkMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxHQUFHLGFBQUcsQ0FBQztRQUV0QiwrQ0FBK0M7UUFDL0MsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRXBCLDRDQUE0QztRQUM1QyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFbkMsS0FBSyxDQUFDLEVBQUUsQ0FBQyx3QkFBd0IsRUFBRSxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUM5RCxLQUFLLENBQUMsRUFBRSxDQUFDLHdCQUF3QixFQUFFLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUV4RCx5RUFBeUU7UUFDekUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxLQUFLLENBQUMsd0JBQXdCLENBQUMsQ0FBQztRQUU1RSx5QkFBeUI7UUFDekIsS0FBSyxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUVuRCxtQkFBbUI7UUFDbkIsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO1FBRXZCLHNDQUFzQztRQUN0QyxzQkFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzNCLG1DQUFtQztRQUNuQyxLQUFLLENBQUMsRUFBRSxDQUFDLG1CQUFtQixFQUFFLENBQUMsR0FBZ0IsRUFBRSxJQUFZLEVBQUUsRUFBRSxDQUFDLHNCQUFZLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN4RyxLQUFLLENBQUMsRUFBRSxDQUFDLGlCQUFpQixFQUFFLENBQUMsR0FBZ0IsRUFBRSxJQUFZLEVBQUUsRUFBRSxDQUFDLHNCQUFZLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN0RyxLQUFLLENBQUMsRUFBRSxDQUFDLGtCQUFrQixFQUFFLENBQUMsR0FBZ0IsRUFBRSxJQUFZLEVBQUUsRUFBRSxDQUFDLHNCQUFZLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN2RyxLQUFLLENBQUMsRUFBRSxDQUFDLG1CQUFtQixFQUFFLENBQUMsR0FBZ0IsRUFBRSxJQUFZLEVBQUUsRUFBRSxDQUFDLHNCQUFZLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUM1RyxDQUFDO0lBSUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsT0FBTztRQUNqQixpQ0FBaUM7UUFDakMsZUFBTSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRXBCLDBCQUEwQjtRQUMxQixLQUFLLENBQUMsRUFBRSxDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUM7UUFFN0MsMEJBQTBCO1FBQzFCLEtBQUssQ0FBQyxFQUFFLENBQUMsa0JBQWtCLEVBQUUsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ2pELEtBQUssQ0FBQyxFQUFFLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUV6QyxzQ0FBc0M7UUFDdEMsdUJBQWEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUV6QixPQUFPLElBQUksT0FBTyxDQUFDLEtBQUssSUFBSSxFQUFFO1lBQzFCLDBCQUEwQjtZQUMxQixrQkFBUSxDQUFDLFVBQVUsRUFBRSxDQUFDO1lBQ3RCLE1BQU0sa0JBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUU1QixJQUFJLHVDQUF1QixFQUFFLEVBQUU7Z0JBQzNCLDZCQUFhLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO29CQUN0QixrQkFBUSxDQUFDLEdBQUcsQ0FBQyxrQkFBUSxDQUFDLFlBQVksQ0FBQyxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUM7Z0JBQy9ELENBQUMsQ0FBQyxDQUFDO2FBQ047WUFFRCxxQkFBcUI7WUFDckIsS0FBSyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3RCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLFdBQVc7UUFDckIseUJBQXlCO1FBQ3pCLE1BQU0sQ0FBQyxhQUFhLENBQUMsa0JBQVEsQ0FBQyxXQUFXLEVBQUUsOEJBQW9CLENBQUMsQ0FBQztJQUNyRSxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxJQUFZLEVBQUUsT0FBYztRQUMvRCxNQUFNLHFCQUFxQixHQUFHLENBQUMsSUFBWSxFQUFnQixFQUFFO1lBQ3pELE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDbEMsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNoQyxDQUFDLENBQUM7UUFFRixNQUFNLFNBQVMsR0FBRyxDQUFDLFVBQWtCLEVBQUUsRUFBRTs7WUFDckMsTUFBTSxZQUFZLEdBQUcscUJBQXFCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDdkQsT0FBTyxrQkFBVyxDQUFDLFlBQVksQ0FBQyxJQUFJLE9BQUEsaUJBQVUsQ0FBQyxZQUFZLENBQUMsMENBQUUsSUFBSSxNQUFLLGlCQUFPLENBQUMsS0FBSyxDQUFDO1FBQ3pGLENBQUMsQ0FBQztRQUVGLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDaEIsT0FBTyxDQUFDLE9BQU8sQ0FBQztnQkFDWixJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsOEJBQThCLENBQUM7Z0JBQ3hELElBQUksRUFBRSx1Q0FBdUM7Z0JBQzdDLFNBQVMsRUFBRSxTQUFTO2dCQUNwQixRQUFRLEVBQUUsQ0FBQyxVQUFrQixFQUFFLEVBQUU7b0JBQzdCLE1BQU0sWUFBWSxHQUFHLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxDQUFDO29CQUN2RCxNQUFNLEdBQUcsR0FBRyxpQkFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO29CQUVyQyxJQUFJLEdBQUcsS0FBSyxTQUFTLEVBQUU7d0JBQ25CLE9BQU87cUJBQ1Y7b0JBRUQsTUFBTSxFQUFFLEdBQUcsRUFBRSxHQUFHLEdBQUcsQ0FBQztvQkFDcEIsTUFBTSxLQUFLLEdBQUcsSUFBSSxzQkFBWSxDQUFDLElBQUksRUFBRSxxQkFBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7b0JBQzFELEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQztvQkFFYixrQkFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDMUIsQ0FBQzthQUNKLENBQUMsQ0FBQztTQUNOO1FBRUQsT0FBTyxDQUFDLE9BQU8sQ0FBQztZQUNaLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQywyQkFBMkIsQ0FBQztZQUNyRCxJQUFJLEVBQUUsaUNBQWlDO1lBQ3ZDLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLFFBQVEsRUFBRSxDQUFDLFVBQWtCLEVBQUUsRUFBRTtnQkFDN0IsTUFBTSxZQUFZLEdBQUcscUJBQXFCLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQ3ZELE1BQU0sR0FBRyxHQUFHLGlCQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7Z0JBRXJDLElBQUksR0FBRyxLQUFLLFNBQVMsRUFBRTtvQkFDbkIsT0FBTztpQkFDVjtnQkFFRCxJQUFJLEdBQUcsQ0FBQyxJQUFJLEtBQUssaUJBQU8sQ0FBQyxLQUFLLEVBQUU7b0JBQzVCLE1BQU0sSUFBSSxLQUFLLENBQUMsOEJBQThCLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO2lCQUM3RDtxQkFBTTtvQkFDSCxhQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRTt3QkFDYixNQUFNLEVBQUUsWUFBWTtxQkFDdkIsQ0FBQyxDQUFDO2lCQUNOO1lBQ0wsQ0FBQztTQUNKLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTyxNQUFNLENBQUMsU0FBUztRQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDakIsT0FBTztTQUNWO1FBRUQsSUFBSSxNQUFNLENBQUM7UUFDWCxJQUFJO1lBQ0EsTUFBTSxHQUFHLGtCQUFRLENBQUMsR0FBRyxDQUFDLGtCQUFRLENBQUMsWUFBWSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1NBQzFEO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDWixNQUFNLEdBQUcsS0FBSyxDQUFDO1NBQ2xCO2dCQUFTO1lBQ04sSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFDVCxhQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7YUFDbEI7U0FDSjtJQUNMLENBQUM7SUFFTyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxPQUFlLEVBQUUsT0FBTztRQUN0RCxPQUFPLEdBQUcsT0FBTyxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFFdEMsS0FBSyxJQUFJLE9BQU8sSUFBSSxLQUFLLENBQUMsUUFBUSxFQUFFO1lBQ2hDLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtnQkFDMUIsT0FBTyxLQUFLLENBQUM7YUFDaEI7U0FDSjtRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFRDs7T0FFRztJQUNJLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFhLEVBQUUsSUFBWSxFQUFFLElBQVM7UUFDakUsTUFBTSxJQUFJLEdBQUcsaUNBQWlDLENBQUM7UUFDL0MsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFDLFdBQVcsSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDZCQUE2QixDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ2xHLE1BQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLGFBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUVqQyxJQUFJLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFFTyxNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVM7UUFDMUIsTUFBTSxZQUFZLEdBQUcsQ0FBQyxNQUFNLFlBQVksQ0FBQyxNQUFNLENBQUM7WUFDNUMsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLHVCQUF1QixDQUFDO1lBQ2pELENBQUMsU0FBUyxrQkFBUSxDQUFDLFdBQVcsSUFBSSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLE9BQU8sQ0FBQyxFQUFFLGlCQUFPLENBQUMsTUFBTTtTQUN4RixDQUFDLENBQWlCLENBQUM7UUFFcEIsSUFBSSxxQkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRU8sTUFBTSxDQUFDLG1CQUFtQixDQUFDLEdBQWdCLEVBQUUsSUFBWTtRQUM3RCxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7WUFDakIsT0FBTztTQUNWO1FBRUQsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFDLDhEQUE4RCxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQywwQkFBMEIsQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUMxSSxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUU7WUFDcEIsS0FBSyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ3RCLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1FBQzVDLElBQUksTUFBTSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDckIsTUFBTSxHQUFHLENBQUMsQ0FBQyw0Q0FBNEMsQ0FBQyxDQUFDO1lBQ3pELElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDdkI7UUFDRCxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzFCLENBQUM7SUFFTyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQWdCLEVBQUUsSUFBWTtRQUN2RCxNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBRXBDLEtBQUssTUFBTSxFQUFFLElBQUksR0FBRyxFQUFFO1lBQ2xCLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNyQixNQUFNLEVBQUUsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBRTFDLElBQUksa0JBQVcsQ0FBQyxZQUFZLENBQUMsRUFBRTtnQkFDM0IsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUU7b0JBQ3BDLEtBQUssQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO29CQUNqQyxhQUFhO29CQUNiLElBQUksWUFBWSxDQUFDLE9BQU8sRUFBRTt3QkFDdEIsS0FBSyxDQUFDLGNBQWMsQ0FBQyxZQUFZLENBQUMsQ0FBQztxQkFDdEM7eUJBQU07d0JBQ0gsS0FBSyxDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxDQUFDO3FCQUMzQztnQkFDTCxDQUFDLENBQUMsQ0FBQztnQkFFSCxNQUFNLE9BQU8sR0FBRyxpQkFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO2dCQUN6QyxJQUFJLE9BQU8sRUFBRTtvQkFDVCxNQUFNLFNBQVMsR0FBRyxDQUFDLENBQUMsbUNBQW1DLGtCQUFRLENBQUMsV0FBVyxnQ0FBZ0MsQ0FBQyxDQUFDO29CQUM3RyxNQUFNLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO29CQUV6QixRQUFRLE9BQU8sQ0FBQyxJQUFJLEVBQUU7d0JBQ2xCLEtBQUssaUJBQU8sQ0FBQyxNQUFNLENBQUM7d0JBQ3BCLEtBQUssaUJBQU8sQ0FBQyxRQUFROzRCQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtnQ0FDckMsS0FBSyxDQUFDLHdCQUF3QixFQUFFLENBQUM7Z0NBQ2pDLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxZQUFZLENBQUMsQ0FBQzs0QkFDNUMsQ0FBQyxDQUFDLENBQUM7NEJBQ0gsTUFBTTt3QkFDVixLQUFLLGlCQUFPLENBQUMsS0FBSzs0QkFDZCxpQ0FBaUM7NEJBQ2pDLFNBQVMsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLGlCQUFpQixDQUFDLENBQUM7NEJBQzNDLE1BQU07cUJBQ2I7aUJBQ0o7YUFDSjtTQUNKO0lBQ0wsQ0FBQztJQUVPLE1BQU0sQ0FBQyxjQUFjLENBQUMsWUFBMEI7UUFDcEQsSUFBSSxxQkFBUyxDQUFDLFlBQVksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRU8sTUFBTSxDQUFDLG1CQUFtQixDQUFDLFlBQTBCO1FBQ3pELE1BQU0sT0FBTyxHQUFHLGlCQUFVLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDekMsSUFBSSxPQUFPLEVBQUU7WUFDVCxRQUFRLE9BQU8sQ0FBQyxJQUFJLEVBQUU7Z0JBQ2xCLEtBQUssaUJBQU8sQ0FBQyxNQUFNO29CQUNmLGFBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7b0JBQ3JCLE1BQU07Z0JBQ1YsS0FBSyxpQkFBTyxDQUFDLFFBQVE7b0JBQ2pCLGFBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFO3dCQUNqQixNQUFNLEVBQUUsWUFBWTtxQkFDdkIsQ0FBQyxDQUFDO29CQUNILE1BQU07Z0JBQ1YsS0FBSyxpQkFBTyxDQUFDLEtBQUs7b0JBQ2QsMEJBQTBCO29CQUMxQixNQUFNO2FBQ2I7U0FDSjtJQUNMLENBQUM7SUFFTyxNQUFNLENBQUMsWUFBWSxDQUFDLEdBQWUsRUFBRSxJQUFZLEVBQUUsSUFBUzs7UUFDaEUsTUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDcEMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDNUMsSUFBSSxrQkFBVyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ3RCLE1BQU0sU0FBUyxHQUFHLENBQUMsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sS0FBSyxHQUFHLENBQUMsQ0FBQyxVQUFVLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDZCQUE2QixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRXZGLElBQUksVUFBVSxlQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLDBDQUFHLGtCQUFRLENBQUMsV0FBVywyQ0FBSSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUM5RixJQUFJLFVBQVUsS0FBSyxTQUFTLEVBQUU7Z0JBQzFCLFVBQVUsR0FBRyxFQUFFLENBQUM7YUFDbkI7WUFFRCxNQUFNLFlBQVksR0FBRyxDQUFDLENBQUMsaUNBQWlDLENBQUMsQ0FBQztZQUUxRCxNQUFNLEtBQUssR0FBRyxDQUFDLENBQ1gsb0NBQW9DLGtCQUFRLENBQUMsV0FBVyxJQUFJLGtCQUFRLENBQUMsU0FBUyxDQUFDLFdBQVcsWUFBWSxVQUFVLHdCQUF3QixDQUMzSSxDQUFDO1lBRUYsWUFBWSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUzQixTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3hCLFNBQVMsQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFL0IsSUFBSSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUN0RDtJQUNMLENBQUM7SUFFTyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQVUsRUFBRSxLQUFjO1FBQ2pELElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDUixPQUFPO1NBQ1Y7UUFFRCxNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBcUIsQ0FBQztRQUMzQyxNQUFNLEdBQUcsR0FBRyxpQkFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ2hDLElBQUksa0JBQVcsQ0FBQyxPQUFPLENBQUMsSUFBSSxHQUFHLEVBQUU7WUFDN0IsSUFBSSxDQUFDLHVCQUF1QixDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsR0FBRyxHQUFHLEVBQUU7O2dCQUN4RCxJQUFJLFFBQVEsZUFBZ0MsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLDBDQUFHLGtCQUFRLENBQUMsV0FBVywyQ0FBSSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQkFDdEgsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDO2dCQUVuQixJQUFJLE9BQU8sUUFBUSxLQUFLLFFBQVEsRUFBRTtvQkFDOUIsSUFBSTt3QkFDQSxVQUFVLEdBQUcsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3FCQUNuQztvQkFBQyxPQUFPLENBQUMsRUFBRTt3QkFDUixVQUFVLEdBQUcsQ0FBQyxDQUFDO3FCQUNsQjtpQkFDSjtxQkFBTSxJQUFJLE9BQU8sUUFBUSxLQUFLLFFBQVEsRUFBRTtvQkFDckMsVUFBVSxHQUFHLFFBQVEsQ0FBQztpQkFDekI7Z0JBRUQsSUFBSSxVQUFVLEtBQUssQ0FBQyxFQUFFO29CQUNsQixhQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2lCQUNwQjtxQkFBTTtvQkFDSCxhQUFHLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRTt3QkFDYixJQUFJLEVBQUUsVUFBVTtxQkFDbkIsQ0FBQyxDQUFDO2lCQUNOO1lBQ0wsQ0FBQyxDQUFDO1NBQ0w7SUFDTCxDQUFDO0lBRU8sTUFBTSxDQUFDLGNBQWM7UUFDekIsTUFBTSxNQUFNLEdBQWtCO1lBQzFCO2dCQUNJLEVBQUUsRUFBRSxTQUFTO2dCQUNiLElBQUksRUFBRSxtQkFBbUI7Z0JBQ3pCLFFBQVEsRUFBRSxHQUFHLGtCQUFRLENBQUMsV0FBVyxxQkFBcUI7YUFDekQ7WUFDRDtnQkFDSSxFQUFFLEVBQUUsTUFBTTtnQkFDVixJQUFJLEVBQUUsTUFBTTtnQkFDWixRQUFRLEVBQUUsR0FBRyxrQkFBUSxDQUFDLFdBQVcsMEJBQTBCO2FBQzlEO1lBQ0Q7Z0JBQ0ksRUFBRSxFQUFFLE9BQU87Z0JBQ1gsSUFBSSxFQUFFLE9BQU87Z0JBQ2IsUUFBUSxFQUFFLEdBQUcsa0JBQVEsQ0FBQyxXQUFXLDJCQUEyQjthQUMvRDtZQUNEO2dCQUNJLEVBQUUsRUFBRSxpQkFBaUI7Z0JBQ3JCLElBQUksRUFBRSxZQUFZO2dCQUNsQixRQUFRLEVBQUUsR0FBRyxrQkFBUSxDQUFDLFdBQVcsd0JBQXdCO2FBQzVEO1lBRUQ7Z0JBQ0ksRUFBRSxFQUFFLGlCQUFpQjtnQkFDckIsSUFBSSxFQUFFLG1CQUFtQjtnQkFDekIsUUFBUSxFQUFFLEdBQUcsa0JBQVEsQ0FBQyxXQUFXLDZCQUE2QjthQUNqRTtZQUNEO2dCQUNJLEVBQUUsRUFBRSxnQkFBZ0I7Z0JBQ3BCLElBQUksRUFBRSxrQkFBa0I7Z0JBQ3hCLFFBQVEsRUFBRSxHQUFHLGtCQUFRLENBQUMsV0FBVyw0QkFBNEI7YUFDaEU7WUFDRDtnQkFDSSxFQUFFLEVBQUUsYUFBYTtnQkFDakIsSUFBSSxFQUFFLHFCQUFxQjtnQkFDM0IsUUFBUSxFQUFFLEdBQUcsa0JBQVEsQ0FBQyxXQUFXLCtCQUErQjthQUNuRTtZQUNEO2dCQUNJLEVBQUUsRUFBRSxZQUFZO2dCQUNoQixJQUFJLEVBQUUsb0JBQW9CO2dCQUMxQixRQUFRLEVBQUUsR0FBRyxrQkFBUSxDQUFDLFdBQVcsOEJBQThCO2FBQ2xFO1lBQ0Q7Z0JBQ0ksRUFBRSxFQUFFLGlCQUFpQjtnQkFDckIsSUFBSSxFQUFFLDBCQUEwQjtnQkFDaEMsUUFBUSxFQUFFLEdBQUcsa0JBQVEsQ0FBQyxXQUFXLG1DQUFtQzthQUN2RTtZQUNEO2dCQUNJLEVBQUUsRUFBRSxnQkFBZ0I7Z0JBQ3BCLElBQUksRUFBRSx5QkFBeUI7Z0JBQy9CLFFBQVEsRUFBRSxHQUFHLGtCQUFRLENBQUMsV0FBVyxrQ0FBa0M7YUFDdEU7U0FDSixDQUFDO1FBRUYsS0FBSyxNQUFNLEtBQUssSUFBSSxNQUFNLEVBQUU7WUFDeEIsYUFBRyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzNEO0lBQ0wsQ0FBQzs7QUE1Wkwsd0JBNlpDO0FBbFcyQixjQUFRLEdBQUcsQ0FBQyxJQUFJLHlCQUFlLEVBQUUsRUFBRSxJQUFJLG9CQUFVLEVBQUUsQ0FBQyxDQUFDOzs7O0FDN0ZqRjs7Ozs7Ozs7Ozs7OztHQWFHOzs7QUFVSCx5Q0FBa0M7QUFDbEMsb0RBQWlEO0FBQ2pELGtEQUFzRDtBQUV0RCxnQkFBZ0I7QUFDaEIsY0FBYztBQUNkLGdCQUFnQjtBQUNoQixtQ0FBbUM7QUFFbkM7Ozs7R0FJRztBQUNILFNBQWdCLGNBQWM7SUFDMUIsSUFBSSxTQUFTLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3BELFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLG1DQUFtQztJQUNwRCxPQUFPLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDL0IsQ0FBQztBQUpELHdDQUlDO0FBRUQ7Ozs7Ozs7R0FPRztBQUNILFNBQWdCLGNBQWMsQ0FBQyxPQUFlO0lBQzFDLDZFQUE2RTtJQUM3RSxLQUFLLE1BQU0sTUFBTSxJQUFJLDRCQUFnQixFQUFFO1FBQ25DLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUMxQixPQUFPLE9BQU8sQ0FBQztTQUNsQjtLQUNKO0lBRUQsT0FBTyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEdBQUcsY0FBYyxFQUFFLElBQUksT0FBTyxFQUFFLENBQUM7QUFDNUQsQ0FBQztBQVRELHdDQVNDO0FBRUQ7Ozs7Ozs7R0FPRztBQUNILFNBQWdCLG1CQUFtQixDQUFDLE9BQWU7SUFDL0MsZ0NBQWdDO0lBQ2hDLEtBQUssTUFBTSxNQUFNLElBQUksNEJBQWdCLEVBQUU7UUFDbkMsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQzFCLE9BQU8sSUFBSSxDQUFDO1NBQ2Y7S0FDSjtJQUVELE9BQU8sT0FBTyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDN0MsQ0FBQztBQVRELGtEQVNDO0FBRUQsaUJBQWlCO0FBRWpCLGdCQUFnQjtBQUNoQixlQUFlO0FBQ2YsZ0JBQWdCO0FBQ2hCLG9DQUFvQztBQUVwQzs7Ozs7R0FLRztBQUNILFNBQWdCLFdBQVcsQ0FBQyxNQUFjO0lBQ3RDLE9BQU8sTUFBTSxLQUFLLFNBQVMsSUFBSSxNQUFNLEtBQUssSUFBSSxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsa0JBQVEsQ0FBQyxXQUFXLEVBQUUsa0JBQVEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEtBQUssU0FBUyxDQUFDO0FBQ3RJLENBQUM7QUFGRCxrQ0FFQztBQUVEOzs7OztHQUtHO0FBQ0gsU0FBZ0IsVUFBVSxDQUFDLFlBQTZDO0lBQ3BFLElBQUksWUFBWSxLQUFLLFNBQVMsSUFBSSxZQUFZLEtBQUssSUFBSSxFQUFFO1FBQ3JELE9BQU8sU0FBUyxDQUFDO0tBQ3BCO0lBRUQsTUFBTSxPQUFPLEdBQUcsWUFBWSxDQUFDLE9BQU8sQ0FBQyxrQkFBUSxDQUFDLFdBQVcsRUFBRSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQXdCLENBQUM7SUFDL0csSUFBSSxPQUFPLEtBQUssU0FBUyxFQUFFO1FBQ3ZCLE9BQU8sU0FBUyxDQUFDO0tBQ3BCO0lBQ0QsT0FBTyxDQUFDLElBQUksR0FBRyxZQUFZLENBQUMsSUFBSSxDQUFDO0lBQ2pDLE9BQU8sT0FBTyxDQUFDO0FBQ25CLENBQUM7QUFYRCxnQ0FXQztBQUVEOzs7Ozs7O0dBT0c7QUFDSCxTQUFnQixVQUFVLENBQUMsWUFBMEIsRUFBRSxPQUErQjtJQUNsRixPQUFPLFlBQVksQ0FBQyxPQUFPLENBQUMsa0JBQVEsQ0FBQyxXQUFXLEVBQUUsa0JBQVEsQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQzVGLENBQUM7QUFGRCxnQ0FFQztBQUVEOzs7Ozs7R0FNRztBQUNILFNBQWdCLGFBQWEsQ0FBQyxZQUEwQixFQUFFLE9BQStCO0lBQ3JGLE1BQU0sTUFBTSxHQUFHLEVBQUUsQ0FBQztJQUVsQix5RUFBeUU7SUFDekUsS0FBSyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ3BDLE1BQU0sQ0FBQyxTQUFTLGtCQUFRLENBQUMsV0FBVyxJQUFJLGtCQUFRLENBQUMsU0FBUyxDQUFDLFFBQVEsTUFBTSxHQUFHLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQztLQUMxRjtJQUVELE9BQU8sWUFBWSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBVEQsc0NBU0M7QUFFRDs7Ozs7OztHQU9HO0FBQ0gsU0FBZ0IsVUFBVSxDQUFDLE9BQWdCO0lBQ3ZDLElBQUksaUJBQU8sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssU0FBUyxFQUFFO1FBQ3JDLE9BQU8sS0FBSyxDQUFDO0tBQ2hCO0lBRUQsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxTQUFTLElBQUksT0FBTyxDQUFDLEdBQUcsS0FBSyxFQUFFLENBQUMsQ0FBQztBQUM5RCxDQUFDO0FBTkQsZ0NBTUM7QUFFRCxpQkFBaUI7QUFFakIsZ0JBQWdCO0FBQ2hCLGVBQWU7QUFDZixnQkFBZ0I7QUFDaEIsb0NBQW9DO0FBQ3BDOzs7O0dBSUc7QUFDSCxTQUFnQixrQkFBa0I7SUFDOUIsT0FBTyxJQUFJLENBQUMsS0FBSztTQUNaLE1BQU0sQ0FBQyxDQUFDLElBQVUsRUFBRSxFQUFFO1FBQ25CLE9BQU8sSUFBSSxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ25DLENBQUMsQ0FBQztTQUNELEdBQUcsQ0FBQyxDQUFDLElBQVUsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3RDLENBQUM7QUFORCxnREFNQztBQUVELGlCQUFpQjs7OztBQ3RMakI7Ozs7Ozs7Ozs7Ozs7R0FhRzs7QUFFSCxxREFBa0Q7QUFDbEQsMkNBQXNEO0FBQ3RELGtDQUFrRDtBQUVsRDs7O0dBR0c7QUFDSCxNQUFxQixnQkFBaUIsU0FBUSxtQkFBUztJQUNuRCxJQUFjLFdBQVc7UUFDckIsT0FBTyw4QkFBOEIsQ0FBQztJQUMxQyxDQUFDO0lBRUQsSUFBYyxRQUFRO1FBQ2xCLE9BQU8sYUFBYSxDQUFDO0lBQ3pCLENBQUM7SUFFRCxJQUFjLFdBQVc7UUFDckIsT0FBTyw4QkFBOEIsQ0FBQztJQUMxQyxDQUFDO0lBRUQsSUFBYyxhQUFhO1FBQ3ZCLE1BQU0sUUFBUSxHQUFtQixJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQW1CLEVBQUUsRUFBRTs7WUFDekUsT0FBTyxrQkFBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLE9BQUEsaUJBQVUsQ0FBQyxLQUFLLENBQUMsMENBQUUsSUFBSSxNQUFLLGlCQUFPLENBQUMsS0FBSyxDQUFDO1FBQzNFLENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDMUIsT0FBTztnQkFDSCxJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJO2dCQUNyQixLQUFLLEVBQUUsS0FBSyxDQUFDLEVBQUU7YUFDbEIsQ0FBQztRQUNOLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztDQUNKO0FBekJELG1DQXlCQzs7OztBQ2hERDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILDBDQUFtQztBQUNuQyxxREFBc0U7QUFFdEU7OztHQUdHO0FBQ0gsTUFBcUIsbUJBQW9CLFNBQVEsV0FBVztJQWV4RCxZQUFZLEtBQVksRUFBRSxPQUE2QjtRQUNuRCxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztJQUN2QixDQUFDO0lBakJELE1BQU0sS0FBSyxjQUFjO1FBQ3JCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxjQUFjLENBQUM7UUFFckMsT0FBTyxDQUFDLFFBQVEsR0FBRyxHQUFHLGtCQUFRLENBQUMsY0FBYyxrQ0FBa0MsQ0FBQztRQUNoRixPQUFPLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQztRQUNwQixPQUFPLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztRQUNyQixPQUFPLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztRQUV6QixPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBVUQsSUFBSSxLQUFLO1FBQ0wsT0FBTyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDaEMsQ0FBQztJQUVTLGlCQUFpQjtRQUN2QixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUMxQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUMvQixPQUFPLENBQUMsT0FBTyxDQUFDLG9CQUFXLENBQUMsQ0FBQztRQUM3QixPQUFPLENBQUMsT0FBTyxDQUFDO1lBQ1osS0FBSyxFQUFFLG1CQUFtQjtZQUMxQixJQUFJLEVBQUUsYUFBYTtZQUNuQixLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsd0JBQXdCLENBQUM7WUFDbkQsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUU7U0FDL0IsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQUVELE9BQU8sQ0FBQyxPQUFhO1FBQ2pCLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFcEMsSUFBSyxXQUtKO1FBTEQsV0FBSyxXQUFXO1lBQ1osNkNBQVEsQ0FBQTtZQUNSLDJDQUFPLENBQUE7WUFDUCw2Q0FBUSxDQUFBO1lBQ1IscURBQVksQ0FBQTtRQUNoQixDQUFDLEVBTEksV0FBVyxLQUFYLFdBQVcsUUFLZjtRQUVELE1BQU0sT0FBTyxHQUFHLENBQUMsSUFBWSxFQUFFLFVBQWtCLEVBQUUsRUFBRSxTQUFzQixXQUFXLENBQUMsSUFBSSxFQUFjLEVBQUU7WUFDdkcsSUFBSSxPQUFPLEdBQWUsRUFBRSxDQUFDO1lBRTdCLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7WUFFM0MsTUFBTSxJQUFJLEdBQUcsQ0FBQyxJQUFZLEVBQUUsR0FBRyxJQUF5QixFQUFFLEVBQUU7Z0JBQ3hELElBQUksSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7b0JBQ2pCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO3dCQUNsQyxJQUFJLEdBQUcsR0FBRyxJQUFJLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7cUJBQy9CO29CQUNELE9BQU8sSUFBSSxDQUFDO2lCQUNmO3FCQUFNO29CQUNILE9BQU8sR0FBRyxJQUFJLEVBQUUsQ0FBQztpQkFDcEI7WUFDTCxDQUFDLENBQUM7WUFFRixNQUFNLElBQUksR0FBRyxDQUFDLEtBQWEsRUFBRSxFQUFFO2dCQUMzQixPQUFPLE9BQU8sS0FBSyxNQUFNLENBQUM7WUFDOUIsQ0FBQyxDQUFDO1lBRUYsTUFBTSxXQUFXLEdBQUcsQ0FBQyxJQUFpQixFQUFFLElBQWlCLEVBQUUsRUFBRTtnQkFDekQsSUFBSSxJQUFJLEdBQUcsSUFBSSxFQUFFO29CQUNiLE9BQU8sSUFBSSxDQUFDO2lCQUNmO2dCQUNELE9BQU8sSUFBSSxDQUFDO1lBQ2hCLENBQUMsQ0FBQztZQUVGLElBQUksSUFBSSxLQUFLLElBQUk7Z0JBQUUsT0FBTyxPQUFPLENBQUM7WUFDbEMsSUFBSSxJQUFJLEtBQUssU0FBUztnQkFBRSxPQUFPLE9BQU8sQ0FBQztZQUV2QyxJQUFJLE9BQU8sSUFBSSxLQUFLLFFBQVEsRUFBRTtnQkFDMUIsS0FBSyxNQUFNLENBQUMsR0FBRyxFQUFFLEtBQUssQ0FBQyxJQUFJLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUU7b0JBQzdDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTt3QkFDdEIsaUNBQWlDO3dCQUNqQyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFOzRCQUNwQixPQUFPLENBQUMsSUFBSSxDQUFDO2dDQUNULEdBQUcsRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQztnQ0FDdkIsTUFBTSxFQUFFLFdBQVcsQ0FBQyxRQUFRO2dDQUM1QixLQUFLLEVBQUUsSUFBSSxDQUFDLDBCQUEwQixDQUFDOzZCQUMxQyxDQUFDLENBQUM7eUJBQ047NkJBQU07NEJBQ0gsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0NBQ25DLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztnQ0FDdEIsT0FBTyxHQUFHLENBQUMsR0FBRyxPQUFPLEVBQUUsR0FBRyxPQUFPLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLFdBQVcsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQzs2QkFDMUc7eUJBQ0o7cUJBQ0o7eUJBQU0sSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUU7d0JBQ2xDLGtDQUFrQzt3QkFDbEMsSUFBSSxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxTQUFTLEVBQUU7NEJBQ3ZDLE9BQU8sQ0FBQyxJQUFJLENBQUM7Z0NBQ1QsR0FBRyxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDO2dDQUN2QixNQUFNLEVBQUUsV0FBVyxDQUFDLElBQUk7Z0NBQ3hCLEtBQUssRUFBRSxJQUFJLENBQUMsOEJBQThCLENBQUM7NkJBQzlDLENBQUMsQ0FBQzt5QkFDTjs2QkFBTSxJQUFJLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRTs0QkFDN0IsT0FBTyxDQUFDLElBQUksQ0FBQztnQ0FDVCxHQUFHLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUM7Z0NBQ3ZCLE1BQU0sRUFBRSxXQUFXLENBQUMsUUFBUTtnQ0FDNUIsS0FBSyxFQUFFLElBQUksQ0FBQywyQkFBMkIsQ0FBQzs2QkFDM0MsQ0FBQyxDQUFDO3lCQUNOOzZCQUFNOzRCQUNILEtBQUssSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dDQUM5QyxPQUFPLEdBQUcsQ0FBQyxHQUFHLE9BQU8sRUFBRSxHQUFHLE9BQU8sQ0FBQyxNQUFhLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLEVBQUUsSUFBSSxDQUFDLEVBQUUsV0FBVyxDQUFDLE1BQU0sRUFBRSxXQUFXLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDOzZCQUNySDt5QkFDSjtxQkFDSjt5QkFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLFVBQVUsRUFBRTt3QkFDcEMsK0NBQStDO3dCQUMvQyxPQUFPLENBQUMsSUFBSSxDQUFDOzRCQUNULEdBQUcsRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQzs0QkFDdkIsTUFBTSxFQUFFLFdBQVcsQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDLFFBQVEsQ0FBQzs0QkFDakQsS0FBSyxFQUFFLElBQUksQ0FBQyx1QkFBdUIsQ0FBQzt5QkFDdkMsQ0FBQyxDQUFDO3FCQUNOO3lCQUFNO3dCQUNILGdEQUFnRDt3QkFDaEQsT0FBTyxDQUFDLElBQUksQ0FBQzs0QkFDVCxHQUFHLEVBQUUsSUFBSSxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUM7NEJBQ3ZCLE1BQU0sRUFBRSxXQUFXLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxJQUFJLENBQUM7NEJBQzdDLEtBQUssRUFBRyxLQUFhLENBQUMsUUFBUSxFQUFFO3lCQUNuQyxDQUFDLENBQUM7cUJBQ047aUJBQ0o7YUFDSjtpQkFBTSxJQUFJLE9BQU8sSUFBSSxLQUFLLFVBQVUsRUFBRTtnQkFDbkMsK0NBQStDO2dCQUMvQyxPQUFPLENBQUMsSUFBSSxDQUFDO29CQUNULEdBQUcsRUFBRSxPQUFPO29CQUNaLE1BQU0sRUFBRSxXQUFXLENBQUMsTUFBTSxFQUFFLFdBQVcsQ0FBQyxRQUFRLENBQUM7b0JBQ2pELEtBQUssRUFBRSxJQUFJLENBQUMsdUJBQXVCLENBQUM7aUJBQ3ZDLENBQUMsQ0FBQzthQUNOO2lCQUFNO2dCQUNILGdEQUFnRDtnQkFDaEQsT0FBTyxDQUFDLElBQUksQ0FBQztvQkFDVCxHQUFHLEVBQUUsT0FBTztvQkFDWixNQUFNLEVBQUUsV0FBVyxDQUFDLE1BQU0sRUFBRSxXQUFXLENBQUMsSUFBSSxDQUFDO29CQUM3QyxLQUFLLEVBQUUsSUFBSTtpQkFDZCxDQUFDLENBQUM7YUFDTjtZQUVELE9BQU8sT0FBTyxDQUFDO1FBQ25CLENBQUMsQ0FBQztRQUVGLE1BQU0sS0FBSyxHQUFHO1lBQ1YsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUUscUNBQXFDO1lBQ3pELENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLHdDQUF3QztZQUMzRCxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSw2Q0FBNkM7WUFDakUsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLEVBQUUsc0NBQXNDO1NBQ2pFLENBQUM7UUFDRixNQUFNLFFBQVEsR0FBRztZQUNiLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDRCQUE0QixDQUFDO1lBQ3BFLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDJCQUEyQixDQUFDO1lBQ2xFLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDRCQUE0QixDQUFDO1lBQ3BFLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGdDQUFnQyxDQUFDO1NBQy9FLENBQUM7UUFFRixJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztRQUN0RCxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQ2YsR0FBRyxFQUFFLE1BQU07WUFDWCxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJO1lBQ3RCLE1BQU0sRUFBRSxXQUFXLENBQUMsSUFBSTtTQUMzQixDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBVyxFQUFFLENBQVcsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDN0UsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUMxQyxJQUFJLFNBQVMsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBYSxDQUFDO1lBQ3RELFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUVsQix1Q0FDTyxPQUFPLEtBQ1YsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQzNCLElBQUksRUFBRSxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFDL0IsT0FBTyxFQUFFLFFBQVEsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQ25DO1FBQ04sQ0FBQyxDQUFDLENBQUM7UUFFSCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRVMsaUJBQWlCLENBQUMsSUFBWTtRQUNwQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFOUIsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUM1QyxNQUFNLE1BQU0sR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRXRDLE1BQU0sU0FBUyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQVcsQ0FBQyxDQUFDO1lBRXBFLEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGtDQUFrQyxDQUFDLENBQUMsQ0FBQztRQUNsRixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxNQUFNLENBQUMsS0FBZSxFQUFFLE9BQW1DO1FBQ3ZELElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNkLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDOUI7UUFFRCxJQUFJLENBQUMsT0FBTyxHQUFHLFVBQVUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN6RCxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7SUFFRCxLQUFLO1FBQ0QsWUFBWSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUMzQixPQUFPLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN6QixDQUFDO0NBQ0o7QUFoTkQsc0NBZ05DOzs7O0FDdE9EOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBRUgsdURBQWdEO0FBQ2hELDBDQUFtQztBQUVuQzs7O0dBR0c7QUFDSCxNQUFxQixvQkFBcUIsU0FBUSxVQUFVO0lBUXhELGlCQUFpQjtJQUVqQixvREFBb0Q7SUFFcEQsWUFBWSxLQUFZLEVBQUUsT0FBNkI7UUFDbkQsS0FBSyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUV0QixJQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztJQUM1QixDQUFDO0lBRUQsaUJBQWlCO0lBQ2pCLHlDQUF5QztJQUV6QyxJQUFXLE1BQU07UUFDYixPQUFPLElBQUksQ0FBQyxPQUFPLENBQUM7SUFDeEIsQ0FBQztJQUVELGlCQUFpQjtJQUNqQix3Q0FBd0M7SUFFOUIsaUJBQWlCLENBQUMsSUFBMEI7UUFDbEQsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3ZDLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQUVTLEtBQUssQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJO1FBQzdCLCtDQUErQztRQUMvQyxPQUFPO0lBQ1gsQ0FBQztJQUVELE9BQU87UUFDSCxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ2hFLENBQUM7SUFFUyxhQUFhLENBQUMsS0FBMkIsRUFBRSxRQUFhO1FBQzlELE9BQU8sS0FBSyxDQUFDLGFBQWEsQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVELE1BQU0sQ0FBQyxLQUFlLEVBQUUsT0FBbUM7UUFDdkQsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDZixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxrQkFBUSxDQUFDLFdBQVcsRUFBRSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN0RixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUkscUJBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQzVFO1FBRUQsa0RBQWtEO1FBQ2xELElBQUksSUFBSSxDQUFDLE1BQU0sS0FBSyxXQUFXLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRTtZQUNwRCxPQUFPLElBQUksQ0FBQztTQUNmO1FBRUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3BDLE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUVELHdGQUF3RjtJQUN4RixLQUFLLENBQUMsWUFBWTtRQUNkLE9BQU87SUFDWCxDQUFDO0lBRUQsS0FBSyxDQUFDLEtBQUs7UUFDUCxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDZCxNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDM0IsYUFBYTtZQUNiLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztTQUN2QjtRQUNELE9BQU8sS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3pCLENBQUM7Q0FHSjtBQTdFRCx1Q0E2RUM7Ozs7QUNuR0Q7Ozs7Ozs7Ozs7Ozs7R0FhRzs7O0FBRUgsMENBQW1DO0FBQ25DLGdDQUF5QjtBQUN6QixrQ0FBcUQ7QUFDckQscURBQWtEO0FBQ2xELHFEQUFtRjtBQUVuRjs7O0dBR0c7QUFDSCxNQUFhLFNBQVUsU0FBUSxlQUFlO0lBbUIxQyxpQkFBaUI7SUFDakIsb0RBQW9EO0lBRXBELFlBQVksWUFBMEIsRUFBRSxPQUE2QjtRQUNqRSxLQUFLLENBQUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUF2QkQseUNBQXlDO0lBRXpDLE1BQU0sS0FBSyxjQUFjO1FBQ3JCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxjQUFjLENBQUM7UUFDckMsT0FBTyxDQUFDLE9BQU8sR0FBRyxDQUFDLEdBQUcsT0FBTyxDQUFDLE9BQVEsRUFBRSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzVELE9BQU8sQ0FBQyxRQUFRLEdBQUcsR0FBRyxrQkFBUSxDQUFDLGNBQWMsd0JBQXdCLENBQUM7UUFDdEUsT0FBTyxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7UUFDcEIsT0FBTyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDeEIsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQWdCRCxpQkFBaUI7SUFDakIseUNBQXlDO0lBRXpDLElBQVcsS0FBSztRQUNaLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDNUIsQ0FBQztJQUVELElBQVcsRUFBRTtRQUNULE9BQU8sT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxDQUFDO0lBQ25DLENBQUM7SUFFUyxpQkFBaUI7UUFDdkIsTUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDMUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxzQkFBYSxDQUFDLENBQUM7UUFDL0IsT0FBTyxDQUFDLE9BQU8sQ0FBQyxvQkFBVyxDQUFDLENBQUM7UUFDN0IsT0FBTyxDQUFDLE9BQU8sQ0FBQyxvQkFBVyxDQUFDLENBQUM7UUFDN0IsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQUVELElBQUksVUFBVTtRQUNWLGdDQUFnQztRQUNoQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDckYsQ0FBQztJQUVELGlCQUFpQjtJQUNqQix3Q0FBd0M7SUFFOUIsaUJBQWlCLENBQUMsSUFBWTtRQUNwQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFOUIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN4QyxNQUFNLFdBQVcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBRTlDLHNFQUFzRTtRQUN0RSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUN4QyxJQUFJLEtBQUssQ0FBQyxHQUFHLEtBQUssT0FBTyxFQUFFO2dCQUN2QixJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO2FBQ2pEO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDSCxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUM3QyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDO1FBRUgsZ0JBQWdCO1FBQ2hCLElBQUksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7O1lBQ2pELEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUN2QixLQUFLLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztZQUVqQyxJQUFJLENBQUMsTUFBTSxTQUNQLElBQUksQ0FBQyxNQUFNLG1DQUNYLElBQUksVUFBVSxDQUFDO2dCQUNYLGtCQUFrQjtnQkFDbEIsUUFBUSxFQUFFLEdBQUcsRUFBRTtvQkFDWCxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEVBQUUsWUFBWSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7Z0JBQy9ELENBQUM7YUFDSixDQUFDLENBQUM7WUFFUCxpQ0FBaUM7WUFDakMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNsQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFaEMsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtnQkFDekMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQ3RDO1lBRUQsSUFBSSxRQUFRLEdBQUcsUUFBUSxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQzlCLElBQUksUUFBUSxLQUFLLFNBQVMsRUFBRTtnQkFDeEIsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQzthQUN4RDtZQUVELElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzdCLENBQUMsQ0FBQyxDQUFDO1FBRUgsMkJBQTJCO1FBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ3pDLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUN2QixLQUFLLENBQUMsd0JBQXdCLEVBQUUsQ0FBQztZQUVqQyxJQUFJLFFBQVEsR0FBRyxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDOUIsSUFBSSxXQUFXLEdBQUcsV0FBVyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBRXBDLElBQUksUUFBUSxLQUFLLElBQUksSUFBSSxRQUFRLEtBQUssU0FBUztnQkFBRSxPQUFPO1lBQ3hELElBQUksV0FBVyxLQUFLLElBQUksSUFBSSxXQUFXLEtBQUssU0FBUztnQkFBRSxPQUFPO1lBRTlELFFBQVEsR0FBRyxRQUFRLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDL0IsUUFBUSxHQUFHLHFCQUFjLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFcEMsSUFBSSxXQUFXLENBQUMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFFO2dCQUN0QyxXQUFXLEdBQUcsQ0FBQyxDQUFDO2FBQ25CO1lBQ0QsV0FBVyxHQUFHLFFBQVEsQ0FBQyxXQUFxQixDQUFDLENBQUM7WUFFOUMsYUFBRyxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTSxPQUFPO1FBQ1YsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBRTdCLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLGlCQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUU7WUFDbEQsT0FBTztnQkFDSCxLQUFLLEVBQUUsaUJBQU8sQ0FBQyxHQUFHLENBQUM7Z0JBQ25CLElBQUksRUFBRSwwQkFBMEIsR0FBRyxFQUFFO2FBQ3hDLENBQUM7UUFDTixDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxTQUFTLGtCQUFRLENBQUMsV0FBVyxJQUFJLGtCQUFRLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2xGLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxpQkFBVSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUN4QyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBRXJDLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFUyxLQUFLLENBQUMsYUFBYSxDQUFDLEtBQTJCLEVBQUUsUUFBYTtRQUNwRSxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFRCxrQkFBa0I7SUFDbEIsTUFBTSxDQUFDLEVBQUUsVUFBVSxFQUF3QjtRQUN2QyxrQkFBa0I7UUFDbEIsT0FBTyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsVUFBVSxFQUFFLENBQUMsQ0FBQztJQUN4QyxDQUFDO0NBR0o7QUF0SkQsOEJBc0pDOzs7O0FDL0tEOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBRUgsMENBQW1DO0FBUW5DOzs7R0FHRztBQUNILE1BQXFCLFlBQWEsU0FBUSxXQUFXO0lBY2pELFlBQVksR0FBYSxFQUFFLEVBQTJCLEVBQUUsT0FBNkI7UUFDakYsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRWYsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7UUFDaEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQWxCRCxNQUFNLEtBQUssY0FBYztRQUNyQixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsY0FBYyxDQUFDO1FBQ3JDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDcEMsT0FBTyxDQUFDLFFBQVEsR0FBRyxHQUFHLGtCQUFRLENBQUMsY0FBYyw2QkFBNkIsQ0FBQztRQUMzRSxPQUFPLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztRQUN2QixPQUFPLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztRQUN4QixPQUFPLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGdDQUFnQyxDQUFDLENBQUM7UUFDckUsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQVlELE9BQU8sQ0FBQyxPQUFhO1FBQ2pCLE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFcEMsTUFBTSxLQUFLLEdBQVUsRUFBRSxDQUFDO1FBQ3hCLEtBQUssTUFBTSxFQUFFLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtZQUN4QixLQUFLLENBQUMsSUFBSSxDQUFDO2dCQUNQLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJO2dCQUM3QixFQUFFO2FBQ0wsQ0FBQyxDQUFDO1NBQ047UUFFRCxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFFbkQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUN0QixPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRVMsaUJBQWlCLENBQUMsSUFBdUM7UUFDL0QsS0FBSyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDO1FBRTlCLE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDeEMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsR0FBRyxFQUFFO1lBQ3BCLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUM7WUFDbEMsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ2pCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOztPQUVHO0lBQ0ssVUFBVTtRQUNkLE1BQU0sR0FBRyxHQUFhLEVBQUUsQ0FBQztRQUN6QixNQUFNLFVBQVUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxzQkFBc0IsQ0FBQyxDQUFDO1FBQ2hFLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxVQUFVLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ3hDLE1BQU0sUUFBUSxHQUFHLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUU7Z0JBQzFCLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO2FBQ2pDO1NBQ0o7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNmLENBQUM7Q0FDSjtBQTlERCwrQkE4REM7Ozs7QUN6RkQ7Ozs7Ozs7Ozs7Ozs7R0FhRzs7QUFFSCwwQ0FBbUM7QUFpQm5DOzs7R0FHRztBQUNILE1BQThCLFNBQVUsU0FBUSxXQUFXO0lBbUJ2RCxpQkFBaUI7SUFDakIsb0RBQW9EO0lBRXBELFlBQVksUUFBNEIsRUFBRSxZQUFxQixFQUFFLE9BQTZCO1FBQzFGLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVmLElBQUksQ0FBQyxRQUFRLEdBQUcsWUFBWSxDQUFDO1FBQzdCLElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO0lBQzlCLENBQUM7SUExQkQseUNBQXlDO0lBRXpDLE1BQU0sS0FBSyxjQUFjO1FBQ3JCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxjQUFjLENBQUM7UUFDckMsT0FBTyxDQUFDLE9BQU8sR0FBRyxDQUFDLEdBQUcsT0FBTyxDQUFDLE9BQVEsRUFBRSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQzVELE9BQU8sQ0FBQyxRQUFRLEdBQUcsR0FBRyxrQkFBUSxDQUFDLGNBQWMsc0JBQXNCLENBQUM7UUFDcEUsT0FBTyxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7UUFDcEIsT0FBTyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7UUFDeEIsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztJQW1CRCxpQkFBaUI7SUFDakIseUNBQXlDO0lBRXpDLElBQVcsS0FBSztRQUNaLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2hELENBQUM7SUFFRCxJQUFXLEVBQUU7UUFDVCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7SUFDbEQsQ0FBQztJQUVEOzs7T0FHRztJQUNILElBQWMsTUFBTTtRQUNoQixPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBMkJELGlCQUFpQjtJQUNqQix3Q0FBd0M7SUFFeEMsT0FBTyxDQUFDLE9BQWE7UUFDakIsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVwQyxJQUFJLENBQUMsSUFBSSxHQUFHO1lBQ1IsRUFBRSxFQUFFLElBQUksQ0FBQyxRQUFRO1lBQ2pCLEtBQUssRUFBRSxJQUFJLENBQUMsV0FBVztZQUN2QixRQUFRLEVBQUUsSUFBSSxDQUFDLFFBQVE7WUFDdkIsT0FBTyxFQUFFLElBQUksQ0FBQyxhQUFhO1NBQzlCLENBQUM7UUFFRixPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRVMsaUJBQWlCLENBQUMsSUFBWTtRQUNwQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFOUIsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLElBQUksQ0FBQyxRQUFRLFVBQVUsQ0FBQyxDQUFDO1FBQzVELE1BQU0sQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUMvQixLQUFLLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdkIsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBOEIsQ0FBQztZQUMzRSxNQUFNLEtBQUssR0FBRyxNQUFNLENBQUMsR0FBRyxFQUFZLENBQUM7WUFDckMsSUFBSSxLQUFLLEtBQUssSUFBSSxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsU0FBUyxLQUFLLFNBQVMsRUFBRTtnQkFDekQsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7YUFDaEU7WUFDRCxNQUFNLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUN2QixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FHSjtBQXpHRCw0QkF5R0M7Ozs7QUM3SUQ7Ozs7Ozs7Ozs7Ozs7R0FhRzs7O0FBRUg7OztHQUdHO0FBQ0gsTUFBYSxVQUFXLFNBQVEsS0FBSztJQUNqQyxZQUFZLEtBQWEsRUFBRSxLQUFhLEVBQUUsT0FBZ0I7UUFDdEQsS0FBSyxDQUFDLFlBQVksS0FBSyxJQUFJLEtBQUssS0FBSyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0lBQ3BELENBQUM7Q0FDSjtBQUpELGdDQUlDOzs7O0FDdkJEOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBRUgsNkNBQTBDO0FBRTFDOzs7OztHQUtHO0FBQ0gsTUFBcUIsV0FBVztJQWtCNUIsWUFBbUIsU0FBaUIsRUFBRSxVQUFvQixFQUFFLE9BQWU7UUFDdkUsSUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLFNBQVMsRUFBRSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDO1FBQzlCLElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO0lBQzVCLENBQUM7SUFkTSxNQUFNLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxTQUFpQixFQUFFLFVBQW9CLEVBQUUsT0FBZTtRQUN0RixNQUFNLE1BQU0sR0FBRyxJQUFJLFdBQVcsQ0FBQyxTQUFTLEVBQUUsVUFBVSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQy9ELE1BQU0sTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3BCLE9BQU8sTUFBTSxDQUFDO0lBQ2xCLENBQUM7SUFFRCxJQUFXLEtBQUs7UUFDWixPQUFPLElBQUksQ0FBQyxHQUFHLEtBQUssU0FBUyxDQUFDO0lBQ2xDLENBQUM7SUFRTyxjQUFjLENBQUMsU0FBaUI7UUFDcEMsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsU0FBUyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBQ2pFLE1BQU0sS0FBSyxHQUFHLFdBQVcsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDakQsT0FBTyxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsQ0FBQztJQUNsQyxDQUFDO0lBRU0sSUFBSTtRQUNQLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQztRQUNsQixPQUFPLElBQUksT0FBTyxDQUFPLFVBQVUsT0FBTyxFQUFFLE1BQU07WUFDOUMsTUFBTSxPQUFPLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMvRCxPQUFPLENBQUMsU0FBUyxHQUFHLFVBQVUsS0FBSztnQkFDL0IsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO2dCQUN2QixPQUFPLEVBQUUsQ0FBQztZQUNkLENBQUMsQ0FBQztZQUNGLE9BQU8sQ0FBQyxlQUFlLEdBQUcsVUFBVSxLQUFLO2dCQUNyQyxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7Z0JBQ3ZCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtvQkFDOUMsSUFBSTt3QkFDQSwwQ0FBMEM7d0JBQzFDLElBQUksQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztxQkFDdkQ7b0JBQUMsT0FBTyxLQUFLLEVBQUU7d0JBQ1osaUJBQWlCO3FCQUNwQjtpQkFDSjtnQkFDRCxPQUFPLEVBQUUsQ0FBQztZQUNkLENBQUMsQ0FBQztZQUNGLE9BQU8sQ0FBQyxPQUFPLEdBQUcsVUFBVSxLQUFLO2dCQUM3QixhQUFhO2dCQUNiLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQy9CLENBQUMsQ0FBQztRQUNOLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVNLEdBQUcsQ0FBQyxHQUFnQixFQUFFLEtBQVUsRUFBRSxTQUFpQixFQUFFLFFBQWlCLEtBQUs7UUFDOUUsT0FBTyxJQUFJLE9BQU8sQ0FBTyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUN6QyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtnQkFDWCxNQUFNLElBQUksdUJBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLFNBQVMsRUFBRSw4QkFBOEIsQ0FBQyxDQUFDO2FBQ3BGO2lCQUFNO2dCQUNILE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQztnQkFDbEIsSUFBSSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUU1RCx5REFBeUQ7Z0JBQ3pELFdBQVcsQ0FBQyxPQUFPLEdBQUcsVUFBVSxLQUFLO29CQUNqQyxhQUFhO29CQUNiLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMvQixDQUFDLENBQUM7Z0JBRUYsTUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDckMsVUFBVSxDQUFDLFNBQVMsR0FBRyxVQUFVLEtBQUs7b0JBQ2xDLGtDQUFrQztvQkFDbEMsSUFBSSxVQUFVLENBQUMsTUFBTSxFQUFFO3dCQUNuQixxREFBcUQ7d0JBQ3JELElBQUksS0FBSyxFQUFFOzRCQUNQLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUU7Z0NBQy9CLENBQUMsRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dDQUMxRCxLQUFLLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQztnQ0FDdEIsT0FBTyxFQUFFLENBQUM7NEJBQ2QsQ0FBQyxDQUFDLENBQUM7eUJBQ047NkJBQU07NEJBQ0gsTUFBTSxJQUFJLHVCQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxTQUFTLEVBQUUsT0FBTyxHQUFHLGtCQUFrQixDQUFDLENBQUM7eUJBQ2xGO3FCQUNKO3lCQUFNO3dCQUNILEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxDQUFDO3dCQUN0QixPQUFPLEVBQUUsQ0FBQztxQkFDYjtnQkFDTCxDQUFDLENBQUM7YUFDTDtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVNLEdBQUcsQ0FBQyxHQUFnQixFQUFFLFNBQWlCO1FBQzFDLE9BQU8sSUFBSSxPQUFPLENBQU8sQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDekMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUU7Z0JBQ1gsTUFBTSxJQUFJLHVCQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxTQUFTLEVBQUUsOEJBQThCLENBQUMsQ0FBQzthQUNwRjtpQkFBTTtnQkFDSCxJQUFJLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBRTVELHlEQUF5RDtnQkFDekQsV0FBVyxDQUFDLE9BQU8sR0FBRyxVQUFVLEtBQUs7b0JBQ2pDLGFBQWE7b0JBQ2IsTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQy9CLENBQUMsQ0FBQztnQkFFRixNQUFNLFVBQVUsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQyxVQUFVLENBQUMsU0FBUyxHQUFHLFVBQVUsS0FBSztvQkFDbEMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDekIsQ0FBQyxDQUFDO2dCQUVGLFVBQVUsQ0FBQyxPQUFPLEdBQUcsVUFBVSxLQUFLO29CQUNoQyxhQUFhO29CQUNiLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMvQixDQUFDLENBQUM7YUFDTDtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVNLEdBQUcsQ0FBQyxHQUFnQixFQUFFLFNBQWlCO1FBQzFDLE9BQU8sSUFBSSxPQUFPLENBQU8sQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDekMsSUFBSTtnQkFDQSxNQUFNLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBRTlELFdBQVcsQ0FBQyxPQUFPLEdBQUcsVUFBVSxLQUFLO29CQUNqQyxhQUFhO29CQUNiLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUMvQixDQUFDLENBQUM7Z0JBQ0YsV0FBVyxDQUFDLFVBQVUsR0FBRyxVQUFVLEtBQUs7b0JBQ3BDLE9BQU8sRUFBRSxDQUFDO2dCQUNkLENBQUMsQ0FBQztnQkFFRixLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ3JCO1lBQUMsT0FBTyxLQUFLLEVBQUU7Z0JBQ1osTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ2pCO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRU0sSUFBSSxDQUFDLFNBQWlCO1FBQ3pCLE9BQU8sSUFBSSxPQUFPLENBQWdCLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ2xELElBQUk7Z0JBQ0EsTUFBTSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUUsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO2dCQUM5RCxNQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBRXZDLFdBQVcsQ0FBQyxTQUFTLEdBQUc7b0JBQ3BCLE9BQU8sQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ2hDLENBQUMsQ0FBQztnQkFDRixXQUFXLENBQUMsT0FBTyxHQUFHLFVBQVUsS0FBSztvQkFDakMsYUFBYTtvQkFDYixNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDL0IsQ0FBQyxDQUFDO2dCQUVGLE9BQU87YUFDVjtZQUFDLE9BQU8sS0FBSyxFQUFFO2dCQUNaLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNqQjtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVNLEdBQUcsQ0FBQyxTQUFpQjtRQUN4QixPQUFPLElBQUksT0FBTyxDQUFPLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ3pDLElBQUk7Z0JBQ0EsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBQ2pELE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQztnQkFDaEMsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLE1BQU0sRUFBRSxFQUFFO29CQUN4QixNQUFNLFFBQVEsR0FBb0IsRUFBRSxDQUFDO29CQUNyQyxLQUFLLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7d0JBQzNCLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQztxQkFDM0M7b0JBQ0QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO3dCQUM1QixPQUFPLEVBQUUsQ0FBQztvQkFDZCxDQUFDLENBQUMsQ0FBQztnQkFDUCxDQUFDLENBQUM7YUFDTDtZQUFDLE9BQU8sS0FBSyxFQUFFO2dCQUNaLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQzthQUNqQjtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztDQUNKO0FBcExELDhCQW9MQzs7OztBQzNNRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILDBDQUFtQztBQUNuQywrQ0FBd0M7QUFpQnhDOzs7R0FHRztBQUNILE1BQXFCLFFBQVE7SUFDekIseUNBQXlDO0lBQ3pDOztPQUVHO0lBQ0ssTUFBTSxLQUFLLFNBQVM7UUFDeEIsT0FBTyxrQkFBUSxDQUFDLEdBQUcsQ0FBQyxrQkFBUSxDQUFDLFlBQVksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3BFLENBQUM7SUFTRCxpQkFBaUI7SUFFVixNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVU7UUFDMUIsUUFBUSxDQUFDLFlBQVksR0FBRyxNQUFNLHFCQUFXLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxRQUFRLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDdEksQ0FBQztJQUVEOzs7T0FHRztJQUNJLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQVc7UUFDbkMsSUFBSTtZQUNBLE9BQU8sTUFBTSxRQUFRLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzlEO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDWixPQUFPLElBQUksQ0FBQztTQUNmO0lBQ0wsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFXLEVBQUUsSUFBZTtRQUNwRCxNQUFNLFFBQVEsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNwRSxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBVztRQUNwQyxJQUFJO1lBQ0EsTUFBTSxLQUFLLEdBQUcsTUFBTSxRQUFRLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25FLE1BQU0sSUFBSSxHQUFjO2dCQUNwQixZQUFZLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUU7Z0JBQ3RDLElBQUksRUFBRSxLQUFLLENBQUMsTUFBTTthQUNyQixDQUFDO1lBQ0YsTUFBTSxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUVsQyxPQUFPLEtBQUssQ0FBQztTQUNoQjtRQUFDLE9BQU8sS0FBSyxFQUFFO1lBQ1osT0FBTyxJQUFJLENBQUM7U0FDZjtJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsR0FBVyxFQUFFLEtBQWlCO1FBQ3ZELE1BQU0sSUFBSSxHQUFjO1lBQ3BCLFlBQVksRUFBRSxJQUFJLElBQUksRUFBRSxDQUFDLFdBQVcsRUFBRTtZQUN0QyxJQUFJLEVBQUUsS0FBSyxDQUFDLE1BQU07U0FDckIsQ0FBQztRQUVGLE1BQU0sUUFBUSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ2xFLE1BQU0sUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbEMsTUFBTSxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQUVEOzs7T0FHRztJQUNJLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBVztRQUM3QixPQUFPLElBQUksT0FBTyxDQUFPLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDL0MsTUFBTSxXQUFXLEdBQUcsTUFBTSxRQUFRLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ2pELElBQUksV0FBVyxLQUFLLElBQUksSUFBSSxXQUFXLENBQUMsVUFBVSxHQUFHLENBQUMsRUFBRTtnQkFDcEQsT0FBTyxFQUFFLENBQUM7Z0JBQ1YsT0FBTzthQUNWO1lBRUQsTUFBTSxRQUFRLEdBQUcsTUFBTSxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDbEMsSUFBSSxRQUFRLENBQUMsRUFBRSxFQUFFO2dCQUNiLE1BQU0sWUFBWSxHQUFHLElBQUksVUFBVSxDQUFDLE1BQU0sUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7Z0JBQ2xFLElBQUksWUFBWSxDQUFDLFVBQVUsR0FBRyxDQUFDLEVBQUU7b0JBQzdCLE1BQU0sUUFBUSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEVBQUUsWUFBWSxDQUFDLENBQUM7b0JBQzNDLE9BQU8sRUFBRSxDQUFDO29CQUNWLE9BQU87aUJBQ1Y7cUJBQU07b0JBQ0gsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDO2lCQUMzQjthQUNKO2lCQUFNO2dCQUNILE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQzthQUMzQjtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLO1FBQ3JCLE1BQU0sSUFBSSxHQUFHLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXpELElBQUksVUFBVSxHQUFHLENBQUMsQ0FBQztRQUNuQixJQUFJLEtBQUssR0FBVSxFQUFFLENBQUM7UUFDdEIsS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLEVBQUU7WUFDcEIsTUFBTSxJQUFJLEdBQUcsTUFBTSxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzdELElBQUksQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7WUFDbEQsSUFBSSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRWhDLFVBQVUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDO1lBRXhCLEtBQUssQ0FBQyxJQUFJLENBQUM7Z0JBQ1AsR0FBRztnQkFDSCxJQUFJO2FBQ1AsQ0FBQyxDQUFDO1NBQ047UUFFRCxLQUFLLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUN4QixPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO1FBQ3JELENBQUMsQ0FBQyxDQUFDO1FBRUgsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDbkMsSUFBSSxVQUFVLEdBQUcsUUFBUSxDQUFDLFNBQVMsRUFBRTtnQkFDakMsTUFBTTthQUNUO1lBRUQsTUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBRXRCLE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDckQsTUFBTSxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUV0RCxVQUFVLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7U0FDaEM7SUFDTCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxNQUFNLENBQUMsS0FBSyxDQUFDLEtBQUs7UUFDckIsTUFBTSxJQUFJLEdBQUcsTUFBTSxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFekQsS0FBSyxNQUFNLEdBQUcsSUFBSSxJQUFJLEVBQUU7WUFDcEIsTUFBTSxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2hELE1BQU0sSUFBSSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNwRDtJQUNMLENBQUM7O0FBM0pMLDJCQTRKQztBQW5KMkIsaUJBQVEsR0FBVyxXQUFXLENBQUM7QUFDL0Isb0JBQVcsR0FBVyxDQUFDLENBQUM7QUFFeEIsY0FBSyxHQUFXLE9BQU8sQ0FBQztBQUN4QixhQUFJLEdBQVcsTUFBTSxDQUFDOzs7O0FDbERsRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVIOzs7R0FHRztBQUNILE1BQThCLFdBQVc7SUFDckMseUNBQXlDO0lBRXpDLElBQVcsYUFBYTtRQUNwQixPQUFPLFlBQVksQ0FBQztJQUN4QixDQUFDO0lBSUQsaUJBQWlCO0lBQ2pCLHdDQUF3QztJQUV4Qzs7O09BR0c7SUFDSSxPQUFPLENBQUMsT0FBZTtRQUMxQixNQUFNLFFBQVEsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxhQUFhLEVBQUU7WUFDcEMsT0FBTyxLQUFLLENBQUM7U0FDaEI7UUFFRCxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2xDLE9BQU8sS0FBSyxDQUFDO1NBQ2hCO1FBRUQscUJBQXFCO1FBQ3JCLFFBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUNqQixRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7UUFFakIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUM7YUFDYixJQUFJLENBQUMsR0FBRyxFQUFFO1lBQ1AsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsNEJBQTRCLENBQUMsQ0FBQztZQUMvRCxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDOUQsRUFBRSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbkMsQ0FBQyxDQUFDO2FBQ0QsS0FBSyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDYixJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1lBQy9ELE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLGdCQUFnQixFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUM5RCxFQUFFLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUNoQyxPQUFPLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3pCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztDQVVKO0FBckRELDhCQXFEQzs7OztBQ3hFRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILGtDQUFpRDtBQUNqRCxxREFBa0Q7QUFDbEQsK0NBQXdDO0FBRXhDOzs7R0FHRztBQUNILE1BQXFCLGVBQWdCLFNBQVEscUJBQVc7SUFDcEQseUNBQXlDO0lBRXpDLElBQUksV0FBVztRQUNYLE9BQU8sbUJBQW1CLENBQUM7SUFDL0IsQ0FBQztJQUVELGlCQUFpQjtJQUVqQix3Q0FBd0M7SUFFOUIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFjO1FBQzlCLElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQztRQUNsQixNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQWdCLEVBQUUsRUFBRSxXQUFDLE9BQUEsaUJBQVUsQ0FBQyxFQUFFLENBQUMsS0FBSyxTQUFTLElBQUksT0FBQSxpQkFBVSxDQUFDLEVBQUUsQ0FBQywwQ0FBRSxJQUFJLE1BQUssU0FBUyxDQUFBLEVBQUEsQ0FBbUIsQ0FBQztRQUNqSixLQUFLLE1BQU0sWUFBWSxJQUFJLFFBQVEsRUFBRTtZQUNqQyxNQUFNLGlCQUFVLENBQUMsWUFBWSxFQUFFO2dCQUMzQixJQUFJLEVBQUUsaUJBQU8sQ0FBQyxNQUFNO2FBQ3ZCLENBQUMsQ0FBQztZQUNILFNBQVMsSUFBSSxDQUFDLENBQUM7U0FDbEI7UUFFRCxhQUFhO1FBQ2IsRUFBRSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUVwQixJQUFJLFNBQVMsR0FBRyxDQUFDLEVBQUU7WUFDZixFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQywyQ0FBMkMsQ0FBQyxDQUFDLENBQUM7U0FDMUY7YUFBTTtZQUNILEVBQUUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDJDQUEyQyxDQUFDLENBQUMsQ0FBQztTQUMxRjtJQUNMLENBQUM7Q0FHSjtBQWhDRCxrQ0FnQ0M7Ozs7QUN2REQ7Ozs7Ozs7Ozs7Ozs7R0FhRzs7QUFFSCwrQ0FBd0M7QUFDeEMsZ0RBQXlDO0FBRXpDOztHQUVHO0FBQ0gsTUFBcUIsVUFBVyxTQUFRLHFCQUFXO0lBQy9DLHlDQUF5QztJQUV6QyxJQUFXLFdBQVc7UUFDbEIsT0FBTyxhQUFhLENBQUM7SUFDekIsQ0FBQztJQUVELGlCQUFpQjtJQUVqQix3Q0FBd0M7SUFFOUIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFjO1FBQzlCLE1BQU0sa0JBQVEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUV2QixFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDLENBQUM7SUFDdEYsQ0FBQztDQUdKO0FBbEJELDZCQWtCQzs7OztBQ3ZDRDs7Ozs7Ozs7Ozs7OztHQWFHOzs7QUFFSDs7O0dBR0c7QUFDVSxRQUFBLGdCQUFnQixHQUFHLENBQUMsZUFBZSxFQUFFLHdCQUF3QixFQUFFLHNCQUFzQixFQUFFLGVBQWUsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDOzs7O0FDbkJ4STs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILG1DQUE0QjtBQUM1Qiw2Q0FBc0M7QUFFdEM7O0dBRUc7QUFDSCxNQUFxQixVQUFVO0lBRzNCO1FBQ0ksSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLEdBQUcsRUFBc0IsQ0FBQztJQUM5QyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEVBQUUsQ0FBQyxTQUFnQixFQUFFLFFBQWtCO1FBQzFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUMzQixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLENBQUM7U0FDaEM7UUFFRCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQWUsQ0FBQztRQUN6RCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUN2QyxJQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUMsS0FBSyxRQUFRO2dCQUFFLE9BQU87U0FDekM7UUFDRCxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzdCLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksSUFBSSxDQUFDLFNBQWdCLEVBQUUsUUFBa0I7UUFDNUMsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLE1BQU0sT0FBTyxHQUFHLFVBQVUsR0FBRyxJQUFJO1lBQzdCLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNmLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ2pDLENBQUMsQ0FBQztRQUNGLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksR0FBRyxDQUFDLFNBQWdCLEVBQUUsUUFBa0I7UUFDM0MsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFO1lBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsQ0FBQztTQUNoQztRQUVELE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBZSxDQUFDO1FBQ3pELEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ3ZDLElBQUksU0FBUyxDQUFDLENBQUMsQ0FBQyxLQUFLLFFBQVEsRUFBRTtnQkFDM0IsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7YUFDMUI7U0FDSjtJQUNMLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksSUFBSSxDQUFDLFNBQWdCLEVBQUUsR0FBRyxJQUFJO1FBQ2pDLElBQUksYUFBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUU7WUFDbEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLGtCQUFRLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxLQUFLLFNBQVMsRUFBRSxDQUFDLENBQUM7WUFDckUsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN2QjtRQUVELElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUMzQixPQUFPO1NBQ1Y7UUFFRCxNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQWUsQ0FBQztRQUN6RCxLQUFLLE1BQU0sUUFBUSxJQUFJLFNBQVMsRUFBRTtZQUM5QixRQUFRLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztTQUNyQjtJQUNMLENBQUM7Q0FDSjtBQTVFRCw2QkE0RUM7Ozs7QUNqR0Q7Ozs7Ozs7Ozs7Ozs7R0FhRzs7O0FBRUgsbUNBQTRCO0FBRTVCOzs7R0FHRztBQUNVLFFBQUEsYUFBYSxHQUFHO0lBQ3pCLEtBQUssRUFBRSxrQkFBa0I7SUFDekIsSUFBSSxFQUFFLDBCQUEwQjtJQUNoQyxLQUFLLEVBQUUsV0FBVztJQUNsQixPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQywyQ0FBMkMsRUFBRSxRQUFRLENBQUM7Q0FDcEYsQ0FBQztBQUVGOzs7R0FHRztBQUNVLFFBQUEsV0FBVyxHQUFHO0lBQ3ZCLEtBQUssRUFBRSxrQkFBa0I7SUFDekIsSUFBSSxFQUFFLHdCQUF3QjtJQUM5QixLQUFLLEVBQUUsTUFBTTtJQUNiLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxhQUFHLENBQUMsUUFBUSxFQUFFO0NBQ2hDLENBQUM7QUFFRjs7O0dBR0c7QUFDVSxRQUFBLFdBQVcsR0FBRztJQUN2QixLQUFLLEVBQUUsZ0JBQWdCO0lBQ3ZCLElBQUksRUFBRSxlQUFlO0lBQ3JCLEtBQUssRUFBRSxFQUFFO0lBQ1QsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsMkJBQTJCLEVBQUUsUUFBUSxDQUFDO0NBQ3BFLENBQUM7Ozs7QUNoREY7Ozs7Ozs7Ozs7Ozs7R0FhRzs7O0FBRUg7OztHQUdHO0FBQ0gsSUFBWSxPQWFYO0FBYkQsV0FBWSxPQUFPO0lBQ2Y7O09BRUc7SUFDSCw0QkFBaUIsQ0FBQTtJQUNqQjs7T0FFRztJQUNILGdDQUFxQixDQUFBO0lBQ3JCOztPQUVHO0lBQ0gsMEJBQWUsQ0FBQTtBQUNuQixDQUFDLEVBYlcsT0FBTyxHQUFQLGVBQU8sS0FBUCxlQUFPLFFBYWxCOzs7O0FDaENEOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBRUgsZ0NBQXlCO0FBRXpCOzs7R0FHRztBQUNILE1BQXFCLFlBQVk7SUFDdEIsTUFBTSxDQUFDLFdBQVc7UUFDckIsTUFBTSxTQUFTLEdBQUcsVUFBVSxDQUFDLFVBQVUsQ0FBQztRQUV4QyxhQUFhO1FBQ2IsVUFBVSxDQUFDLFVBQVUsR0FBRyxVQUFVLElBQVksRUFBRSxPQUFZO1lBQ3hELElBQUksR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQzlDLElBQUksR0FBRyxZQUFZLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3BDLE9BQU8sSUFBSSxDQUFDO1FBQ2hCLENBQUMsQ0FBQztJQUNOLENBQUM7SUFFTSxNQUFNLENBQUMsaUJBQWlCLENBQUMsSUFBWTtRQUN4QyxJQUFJLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFO1lBQ2hELEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUV2QixnQ0FBZ0M7WUFDaEMsTUFBTSxNQUFNLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxhQUFrQyxDQUFDLENBQUM7WUFDM0QsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQVcsQ0FBQztZQUN6QyxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBVyxDQUFDO1lBRTNDLDZCQUE2QjtZQUM3QixJQUFJLE9BQU8sR0FBRyxhQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7Z0JBQ25DLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxHQUFHLElBQUksSUFBSSxDQUFDLElBQUksS0FBSyxHQUFHLENBQUM7WUFDbEQsQ0FBQyxDQUFDLENBQUM7WUFFSCxJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNWLEVBQUUsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLHFEQUFxRCxHQUFHLEdBQUcsQ0FBQyxDQUFDO2dCQUNwRixPQUFPO2FBQ1Y7WUFFRCxJQUFJLElBQUksS0FBSyxDQUFDLEVBQUU7Z0JBQ1osYUFBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUN4QjtpQkFBTTtnQkFDSCxhQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRTtvQkFDakIsSUFBSTtpQkFDUCxDQUFDLENBQUM7YUFDTjtRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7T0FHRztJQUNJLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBWTtRQUM3QixNQUFNLElBQUksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQy9CLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO1FBRXJDLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQztRQUU1QyxNQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sUUFBUSxHQUFHLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkMsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyQyxNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXJDLGdDQUFnQztRQUNoQyxJQUFJLFFBQVEsS0FBSyxDQUFDLENBQUMsSUFBSSxRQUFRLEtBQUssQ0FBQyxDQUFDLElBQUksTUFBTSxLQUFLLENBQUMsQ0FBQyxJQUFJLE1BQU0sS0FBSyxDQUFDLENBQUMsRUFBRTtZQUN0RSxNQUFNLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGdDQUFnQyxDQUFDLENBQUMsQ0FBQztTQUN6RTtRQUNELHVCQUF1QjtRQUN2QixJQUFJLE1BQU0sR0FBRyxNQUFNLElBQUksTUFBTSxHQUFHLFFBQVEsSUFBSSxRQUFRLEdBQUcsUUFBUSxFQUFFO1lBQzdELE1BQU0sSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsZ0NBQWdDLENBQUMsQ0FBQyxDQUFDO1NBQ3pFO1FBRUQsTUFBTSxPQUFPLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ3ZELHNDQUFzQztRQUN0QyxJQUFJLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssT0FBTyxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUNuRCxNQUFNLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLGdDQUFnQyxDQUFDLENBQUMsQ0FBQztTQUN6RTtRQUVELElBQUksUUFBUSxHQUFHLFFBQVEsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNsRCxnQ0FBZ0M7UUFDaEMsSUFBSSxRQUFRLEtBQUssU0FBUyxJQUFJLFFBQVEsS0FBSyxFQUFFLEVBQUU7WUFDM0MsTUFBTSxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDLENBQUM7U0FDekU7UUFFRCxJQUFJLFVBQVUsR0FBRyxDQUFDLENBQUM7UUFDbkIsTUFBTSxDQUFDLFVBQVUsRUFBRSxXQUFXLENBQUMsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXJELDhEQUE4RDtRQUM5RCxJQUFJLE9BQU8sR0FBRyxhQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUU7WUFDbkMsT0FBTyxJQUFJLENBQUMsSUFBSSxLQUFLLFVBQVUsSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLFVBQVUsQ0FBQztRQUNoRSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFFVixJQUFJLE9BQU8sRUFBRTtZQUNULCtDQUErQztZQUMvQyxJQUFJLFdBQVcsS0FBSyxTQUFTLElBQUksV0FBVyxLQUFLLEVBQUUsRUFBRTtnQkFDakQsTUFBTSxDQUFDLENBQUMsRUFBRSxVQUFVLENBQUMsR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUMvQyxJQUFJO29CQUNBLFVBQVUsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7aUJBQ3JDO2dCQUFDLE9BQU8sS0FBSyxFQUFFO29CQUNaLHFCQUFxQjtpQkFDeEI7YUFDSjtZQUVELElBQUksVUFBVSxHQUFHLENBQUMsRUFBRTtnQkFDaEIsTUFBTSxJQUFJLEtBQUssQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO2FBQ3pEO1lBRUQsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztZQUN0RSxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO1lBQ3RFLE1BQU0sU0FBUyxHQUFHLEdBQUcsUUFBUSxJQUFJLFVBQVUsSUFBSSxRQUFRLElBQUksVUFBVSxFQUFFLENBQUM7WUFDeEUsTUFBTSxNQUFNLEdBQUcsb0NBQW9DLFNBQVMsZUFBZSxVQUFVLGdCQUFnQixVQUFVLEtBQUssUUFBUSxNQUFNLENBQUM7WUFFbkksT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsR0FBRyxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUM7U0FDOUQ7YUFBTTtZQUNILHlEQUF5RDtZQUN6RCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQztTQUNoRTtJQUNMLENBQUM7SUFFRDs7O09BR0c7SUFDSSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQVk7UUFDaEMsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQzFCLElBQUksR0FBRyxZQUFZLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3BDO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztDQUNKO0FBM0hELCtCQTJIQzs7OztBQ2hKRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILGtDQUFrRDtBQUVsRDs7O0dBR0c7QUFDSCxNQUFxQixhQUFhO0lBRzlCOztPQUVHO0lBQ0ksTUFBTSxDQUFDLFFBQVE7UUFDbEIsYUFBYTtRQUNiLE9BQU8sQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxVQUFVLEVBQUUsVUFBVSxNQUFNO1lBQ2hFLE1BQU0sQ0FBQyxFQUFFLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMxRSxDQUFDLENBQUMsQ0FBQztRQUNILE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxHQUFHLEdBQUcsYUFBYSxDQUFDLFVBQVUsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ3JGLENBQUM7SUFFTyxNQUFNLENBQUMsTUFBTSxDQUFDLEtBQVU7UUFDNUIsSUFBSSxLQUFLLENBQUMsT0FBTztZQUFFLE9BQU87UUFDMUIsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLElBQUksS0FBSyxDQUFDLEdBQUcsS0FBSyxTQUFTLEVBQUU7WUFDN0MsT0FBTztTQUNWO1FBRUQsTUFBTSxjQUFjLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQztRQUVyQyxNQUFNLFFBQVEsR0FBRyxjQUFjLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQzdDLE1BQU0sUUFBUSxHQUFHLGNBQWMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDN0MsTUFBTSxRQUFRLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBRTlELE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzFDLElBQUksTUFBTSxLQUFLLFNBQVMsSUFBSSxDQUFDLGtCQUFXLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDOUMsT0FBTztTQUNWO1FBRUQsTUFBTSxPQUFPLEdBQUcsaUJBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNuQyxJQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUU7WUFDdkIsT0FBTztTQUNWO1FBRUQsTUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztRQUU5RCxLQUFLLENBQUMsT0FBTyxHQUFHLFFBQVEsVUFBVSxZQUFZLE9BQU8sQ0FBQyxJQUFJLEdBQUcsQ0FBQztJQUNsRSxDQUFDOztBQXZDTCxnQ0F3Q0M7QUF2Q2tCLHdCQUFVLEdBQUcsMkJBQTJCLENBQUM7Ozs7QUN0QjVEOzs7Ozs7Ozs7Ozs7O0dBYUc7OztBQUdILHFEQUFrRDtBQUNsRCxrQ0FBcUM7QUFDckMsMENBQW1DO0FBRW5DOzs7R0FHRztBQUNILFNBQWdCLHVCQUF1QjtJQUNuQyxJQUFJLGtCQUFRLENBQUMsR0FBRyxDQUFDLGtCQUFRLENBQUMsWUFBWSxDQUFDLFlBQVksQ0FBQyxLQUFLLFdBQVcsRUFBRTtRQUNsRSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxlQUFlLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDeEUsT0FBTyxJQUFJLENBQUM7U0FDZjthQUFNO1lBQ0gsa0JBQVEsQ0FBQyxHQUFHLENBQUMsa0JBQVEsQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQzNELE9BQU8sS0FBSyxDQUFDO1NBQ2hCO0tBQ0o7U0FBTTtRQUNILE9BQU8sS0FBSyxDQUFDO0tBQ2hCO0FBQ0wsQ0FBQztBQVhELDBEQVdDO0FBRUQ7OztHQUdHO0FBQ0gsU0FBZ0IsYUFBYTtJQUN6QixPQUFPLElBQUksT0FBTyxDQUFPLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7UUFDL0MsSUFBSSxDQUFDLEdBQUcsSUFBSSxNQUFNLENBQUM7WUFDZixLQUFLLEVBQUUsK0JBQStCO1lBQ3RDLE9BQU8sRUFBRTtnQkFDTCw2QkFBNkI7Z0JBQzdCLDJIQUEySDtnQkFDM0gsNkVBQTZFO2dCQUM3RSw0REFBNEQ7YUFDL0QsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQ1YsT0FBTyxFQUFFO2dCQUNMLE9BQU8sRUFBRTtvQkFDTCxJQUFJLEVBQUUsOEJBQThCO29CQUNwQyxLQUFLLEVBQUUsYUFBYTtvQkFDcEIsUUFBUSxFQUFFLEdBQUcsRUFBRTt3QkFDWCxPQUFPLEVBQUU7NkJBQ0osSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDOzZCQUNyQixLQUFLLENBQUMsR0FBRyxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztvQkFDL0IsQ0FBQztpQkFDSjtnQkFDRCxNQUFNLEVBQUU7b0JBQ0osSUFBSSxFQUFFLDhCQUE4QjtvQkFDcEMsS0FBSyxFQUFFLGlCQUFpQjtvQkFDeEIsUUFBUSxFQUFFLEdBQUcsRUFBRSxDQUFDLE9BQU8sRUFBRTtpQkFDNUI7YUFDSjtZQUNELE9BQU8sRUFBRSxRQUFRO1NBQ3BCLENBQUMsQ0FBQztRQUNILENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkIsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBOUJELHNDQThCQztBQUVEOzs7R0FHRztBQUNILEtBQUssVUFBVSxPQUFPO0lBQ2xCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxlQUFlLENBQVcsQ0FBQztJQUN4RixLQUFLLE1BQU0sSUFBSSxJQUFJLEtBQUssRUFBRTtRQUN0QixJQUFJLE9BQU8sR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsYUFBYTtRQUNiLE1BQU0sVUFBVSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO1FBQ3hDLE1BQU0sWUFBWSxHQUFHLENBQUMsTUFBTSxZQUFZLENBQUMsTUFBTSxDQUFDO1lBQzVDLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTtZQUNsQixVQUFVO1NBQ2IsQ0FBQyxDQUFpQixDQUFDO1FBQ3BCLGFBQWE7UUFDYixPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFFcEIsTUFBTSxpQkFBVSxDQUFDLFlBQVksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN4QyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDekI7SUFFRCxhQUFhO0lBQ2IsRUFBRSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUN4QixDQUFDO0FBRUQ7Ozs7R0FJRztBQUNILFNBQVMsYUFBYSxDQUFDLElBQVU7O0lBQzdCLE1BQU0sT0FBTyxHQUFHO1FBQ1osYUFBYSxFQUFFLGlCQUFPLENBQUMsTUFBTTtRQUM3QixxQkFBcUIsRUFBRSxpQkFBTyxDQUFDLFFBQVE7UUFDdkMsdUJBQXVCLEVBQUUsaUJBQU8sQ0FBQyxLQUFLO0tBQ3pDLENBQUM7SUFDRixhQUFhO0lBQ2IsSUFBSSxJQUFJLFNBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQ0FBSSxpQkFBTyxDQUFDLE1BQU0sQ0FBQztJQUM5RCxPQUFPO1FBQ0gsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSTtRQUNwQixhQUFhO1FBQ2IsR0FBRyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUc7UUFDdkIsYUFBYTtRQUNiLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJO1FBQ3pCLGFBQWE7UUFDYixNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTTtRQUM3QixhQUFhO1FBQ2IsS0FBSyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUs7UUFDM0IsSUFBSTtLQUNQLENBQUM7QUFDTixDQUFDOzs7O0FDM0hEOzs7Ozs7Ozs7Ozs7O0dBYUc7OztBQUVILHdEQUFpRDtBQUVqRCxnQ0FBeUI7QUFDekIsMENBQW1DO0FBQ25DLHdEQUFpRDtBQUNqRCxnREFBeUM7QUFFekM7O0dBRUc7QUFDSCxNQUFhLE1BQU07SUFDUixNQUFNLENBQUMsVUFBVTtRQUNwQixrQkFBa0I7UUFDbEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsa0JBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxLQUFLLEVBQUUsRUFBRTtZQUMzQyxJQUFJO2dCQUNBLE1BQU0sRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxHQUFHLEtBQUssQ0FBQztnQkFDekMsNkRBQTZEO2dCQUM3RCxJQUFJLE9BQU8sS0FBSyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRTtvQkFDcEQsT0FBTztpQkFDVjtnQkFFRCxJQUFJLElBQUksS0FBSyxzQkFBWSxDQUFDLFVBQVUsRUFBRTtvQkFDbEMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFDOUIsT0FBTztpQkFDVjtxQkFBTSxJQUFJLElBQUksS0FBSyxzQkFBWSxDQUFDLFVBQVUsRUFBRTtvQkFDekMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDO29CQUNqQyxPQUFPO2lCQUNWO3FCQUFNO29CQUNILElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLENBQUMsRUFBRTt3QkFDNUIsT0FBTyxDQUFDLEtBQUssQ0FBQyxpQkFBaUIsSUFBSSxrQkFBa0IsQ0FBQyxDQUFDO3dCQUN2RCxPQUFPO3FCQUNWO2lCQUNKO2FBQ0o7WUFBQyxPQUFPLENBQUMsRUFBRTtnQkFDUixPQUFPO2FBQ1Y7UUFDTCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTSxNQUFNLENBQUMsYUFBYSxDQUFDLElBQVM7UUFDakMsSUFBSSxrQkFBUSxDQUFDLEdBQUcsQ0FBQyxrQkFBUSxDQUFDLFlBQVksQ0FBQyxlQUFlLENBQUMsRUFBRTtZQUNyRCxTQUFTLFdBQVcsQ0FBQyxHQUFnQjtnQkFDakMsT0FBTyxHQUFHLENBQUMsU0FBUyxDQUFDLEtBQUssU0FBUyxDQUFDO1lBQ3hDLENBQUM7WUFFRCxLQUFLLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUN6QyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxFQUFFO29CQUNuQixTQUFTO2lCQUNaO2dCQUVELE1BQU0sT0FBTyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUM7Z0JBQzVCLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEtBQUssT0FBTyxDQUFDLEdBQUcsRUFBRTtvQkFDbEMsR0FBRyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO29CQUNyQixPQUFPO2lCQUNWO2FBQ0o7WUFDRCwrQkFBK0I7U0FDbEM7UUFDRCxhQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDdEIsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJO1NBQ2xCLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsSUFBUztRQUNwQyxrQkFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDL0IsQ0FBQztDQUNKO0FBeERELHdCQXdEQzs7OztBQ2pGRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILCtDQUF3QztBQUV4Qzs7R0FFRztBQUNILE1BQXFCLFlBQWEsU0FBUSxxQkFBVztJQVdqRCxZQUFZLE9BQXdCLEVBQUUsR0FBVztRQUM3QyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFFZixJQUFJLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQztJQUNuQixDQUFDO0lBZE0sTUFBTSxLQUFLLFVBQVU7UUFDeEIsT0FBTyxHQUFHLEtBQUssQ0FBQyxVQUFVLGNBQWMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsSUFBSSxJQUFJO1FBQ0osT0FBTyxZQUFZLENBQUMsVUFBVSxDQUFDO0lBQ25DLENBQUM7SUFVUyxVQUFVO1FBQ2hCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNuQyxPQUFPLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUM7UUFDdkIsT0FBTyxPQUFPLENBQUM7SUFDbkIsQ0FBQztDQUNKO0FBdEJELCtCQXNCQzs7OztBQzFDRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILCtDQUF3QztBQUd4Qzs7R0FFRztBQUNILE1BQXFCLFlBQWEsU0FBUSxxQkFBVztJQVlqRCxZQUFZLE9BQXdCLEVBQUUsT0FBZ0IsRUFBRSxJQUFZO1FBQ2hFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVmLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0lBQ3JCLENBQUM7SUFoQk0sTUFBTSxLQUFLLFVBQVU7UUFDeEIsT0FBTyxHQUFHLEtBQUssQ0FBQyxVQUFVLFdBQVcsQ0FBQztJQUMxQyxDQUFDO0lBRUQsSUFBSSxJQUFJO1FBQ0osT0FBTyxZQUFZLENBQUMsVUFBVSxDQUFDO0lBQ25DLENBQUM7SUFZUyxVQUFVO1FBQ2hCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUNuQyxPQUFPLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDL0IsT0FBTyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1FBQ3pCLE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7Q0FDSjtBQXpCRCwrQkF5QkM7Ozs7QUM5Q0Q7Ozs7Ozs7Ozs7Ozs7R0FhRzs7QUFFSCw2Q0FBc0M7QUFFdEM7O0dBRUc7QUFDSCxNQUE4QixXQUFXO0lBa0JyQyxZQUFzQixPQUF3QjtRQUMxQyxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztJQUMzQixDQUFDO0lBbkJEOztPQUVHO0lBQ0ksTUFBTSxLQUFLLFVBQVU7UUFDeEIsT0FBTyxXQUFXLENBQUM7SUFDdkIsQ0FBQztJQWdCRDs7T0FFRztJQUNPLFVBQVU7UUFDaEIsT0FBTyxFQUFFLENBQUM7SUFDZCxDQUFDO0lBRU0sSUFBSTtRQUNQLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxrQkFBUSxDQUFDLFdBQVcsRUFBRTtZQUNuQyxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUk7WUFDZixPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU87WUFDckIsT0FBTyxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUU7U0FDN0IsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztDQUNKO0FBckNELDhCQXFDQzs7OztBQ3pERDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILDBDQUFtQztBQUNuQyw4REFBdUQ7QUFDdkQsa0NBQXFEO0FBQ3JELHNFQUErRDtBQUMvRCxxREFBOEM7QUFFOUMsb0VBQTZEO0FBRTdEOzs7O0dBSUc7QUFDSCxNQUFxQixXQUFZLFNBQVEsd0JBQWM7SUFPbkQsaUJBQWlCO0lBRWpCLG9EQUFvRDtJQUNwRCxZQUFZLEtBQVksRUFBRSxPQUFnQixFQUFFLEtBQTJCLEVBQUUsT0FBNkI7UUFDbEcsS0FBSyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFFL0IsSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7UUFDdEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7SUFDNUIsQ0FBQztJQUNELGlCQUFpQjtJQUVqQix5Q0FBeUM7SUFFekMsSUFBSSxLQUFLO1FBQ0wsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztJQUM5QixDQUFDO0lBRUQ7O09BRUc7SUFDSSxVQUFVO1FBQ2IsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxrQkFBUSxDQUFDLFdBQVcsRUFBRSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUNwRixDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksS0FBSyxDQUFDLFVBQVUsQ0FBQyxLQUF5QjtRQUM3QyxJQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtZQUMzQixPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLGtCQUFRLENBQUMsV0FBVyxFQUFFLGtCQUFRLENBQUMsU0FBUyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztTQUMxRjthQUFNO1lBQ0gsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxrQkFBUSxDQUFDLFdBQVcsRUFBRSxrQkFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUNyRjtJQUNMLENBQUM7SUFFRDs7T0FFRztJQUNJLFdBQVc7UUFDZCxNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDN0IsSUFBSSxFQUFFLEtBQUssU0FBUztZQUFFLE9BQU8sU0FBUyxDQUFDO1FBRXZDLE9BQU8saUJBQVUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFUyxpQkFBaUI7UUFDdkIsTUFBTSxPQUFPLEdBQVUsRUFBRSxDQUFDO1FBRTFCLE9BQU8sQ0FBQyxPQUFPLENBQUM7WUFDWixLQUFLLEVBQUUsT0FBTztZQUNkLEtBQUssRUFBRSxPQUFPO1lBQ2QsSUFBSSxFQUFFLGNBQWM7WUFDcEIsOENBQThDO1lBQzlDLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUU7U0FDM0MsQ0FBQyxDQUFDO1FBRUgsYUFBYTtRQUNiLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDO1FBQ2pHLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsSUFBSSxZQUFZLEVBQUU7WUFDMUMsT0FBTyxDQUFDLE9BQU8sQ0FBQztnQkFDWix3QkFBd0I7Z0JBQ3hCLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLGlCQUFpQjtnQkFDL0MsS0FBSyxFQUFFLGlCQUFpQjtnQkFDeEIsSUFBSSxFQUFFLG9CQUFvQjtnQkFDMUIsd0JBQXdCO2dCQUN4QixPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBRSxDQUFDO2FBQ3pELENBQUMsQ0FBQztZQUVILE9BQU8sQ0FBQyxPQUFPLENBQUM7Z0JBQ1osS0FBSyxFQUFFLE9BQU87Z0JBQ2QsS0FBSyxFQUFFLGlCQUFpQjtnQkFDeEIsSUFBSSxFQUFFLFlBQVk7Z0JBQ2xCLHdCQUF3QjtnQkFDeEIsT0FBTyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsQ0FBQzthQUN6RCxDQUFDLENBQUM7WUFFSCxPQUFPLENBQUMsT0FBTyxDQUFDO2dCQUNaLEtBQUssRUFBRSxrQkFBa0I7Z0JBQ3pCLElBQUksRUFBRSxpQkFBaUI7Z0JBQ3ZCLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyw4QkFBOEIsQ0FBQztnQkFDekQsT0FBTyxFQUFFLEdBQUcsRUFBRTtvQkFDVixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7b0JBQ2xDLElBQUksMEJBQWdCLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFO3dCQUM5QixNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7d0JBQzFCLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQzt3QkFDOUIsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO3dCQUVqQyxJQUFJLENBQUMsS0FBSyxFQUFFOzRCQUNSLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQzt5QkFDcEM7d0JBRUQsTUFBTSxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztvQkFDdkMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDN0IsQ0FBQzthQUNKLENBQUMsQ0FBQztZQUVILElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUU7Z0JBQ2hCLE9BQU8sQ0FBQyxPQUFPLENBQUM7b0JBQ1osS0FBSyxFQUFFLGlCQUFpQjtvQkFDeEIsSUFBSSxFQUFFLGVBQWU7b0JBQ3JCLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyw4QkFBOEIsQ0FBQztvQkFDekQsT0FBTyxFQUFFLEdBQUcsRUFBRTt3QkFDVixJQUFJLDZCQUFtQixDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBQ3hELENBQUM7aUJBQ0osQ0FBQyxDQUFDO2FBQ047U0FDSjtRQUVELE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7SUFFRCxpQkFBaUI7SUFFakIsd0NBQXdDO0lBRTlCLEtBQUssQ0FBQyxhQUFhO1FBQ3pCLEtBQUssQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUN0QixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDakMsSUFBSSxLQUFLLEVBQUU7WUFDUCxNQUFNLEdBQUcsR0FBRyxxQkFBYyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUN0QyxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDeEI7SUFDTCxDQUFDO0lBRUQsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUE4QixFQUFFLElBQWE7UUFDcEQsSUFBSSxTQUFTLFlBQVksVUFBVSxFQUFFO1lBQ2pDLE1BQU0sSUFBSSxLQUFLLENBQUMsbUNBQW1DLENBQUMsQ0FBQztTQUN4RDtRQUVELElBQUk7WUFDQSxNQUFNLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO1NBQ3JDO1FBQUMsT0FBTyxLQUFLLEVBQUU7WUFDWixzRkFBc0Y7WUFDdEYsSUFBSSxDQUFDLENBQUMsTUFBTSxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRTtnQkFDL0IsRUFBRSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsOEJBQThCLENBQUMsQ0FBQyxDQUFDO2dCQUMzRSxNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDcEM7WUFFRCxNQUFNLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUM7WUFDOUIsSUFBSSw4QkFBb0IsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDdEU7SUFDTCxDQUFDO0NBR0o7QUF4SkQsOEJBd0pDOzs7O0FDcExEOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBRUgsMENBQW1DO0FBQ25DLHFEQUFrRDtBQUlsRCxxREFBc0U7QUFDdEUsZ0NBQXlCO0FBQ3pCLGtDQUF5QztBQUV6Qzs7Ozs7O0dBTUc7QUFDSCxNQUE4QixVQUFXLFNBQVEsV0FBVztJQXVCeEQsaUJBQWlCO0lBRWpCLG9EQUFvRDtJQUVwRCxZQUFzQixPQUE2QjtRQUMvQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksZ0JBQVUsRUFBa0IsQ0FBQztJQUN4RCxDQUFDO0lBN0JELHlDQUF5QztJQUV6QyxNQUFNLEtBQUssY0FBYztRQUNyQixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsY0FBYyxDQUFDO1FBQ3JDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsQ0FBQyxLQUFLLEVBQUUsWUFBWSxFQUFFLGtCQUFrQixDQUFDLENBQUM7UUFDNUQsT0FBTyxDQUFDLFFBQVEsR0FBRyxHQUFHLGtCQUFRLENBQUMsY0FBYyx5QkFBeUIsQ0FBQztRQUN2RSxPQUFPLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLDBCQUEwQixDQUFDLENBQUM7UUFDL0QsT0FBTyxDQUFDLEtBQUssR0FBRyxHQUFHLEdBQUcsR0FBRyxHQUFHLEVBQUUsQ0FBQztRQUMvQixPQUFPLENBQUMsTUFBTSxHQUFHLEVBQUUsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFDO1FBQy9CLE9BQU8sQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQ3pCLE9BQU8sT0FBTyxDQUFDO0lBQ25CLENBQUM7SUFvQkQsaUJBQWlCO0lBRWpCLHdDQUF3QztJQUV4Qzs7OztPQUlHO0lBQ0ksUUFBUTtRQUNYLE9BQU8sSUFBSSxPQUFPLENBQWEsS0FBSyxFQUFFLE9BQU8sRUFBRSxFQUFFO1lBQzdDLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1lBQ3RDLElBQUksT0FBTyxDQUFDO1lBQ1osTUFBTSxZQUFZLEdBQUcsR0FBRyxFQUFFO2dCQUN0QixJQUFJLE1BQU0sQ0FBQyxnQkFBZ0IsRUFBRTtvQkFDekIsT0FBTyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztvQkFDdEMsT0FBTztpQkFDVjtnQkFFRCxPQUFPLEdBQUcsVUFBVSxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQztZQUMzQyxDQUFDLENBQUM7WUFDRixZQUFZLEVBQUUsQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksS0FBSyxDQUFDLElBQUksQ0FBQyxTQUE4QixFQUFFLElBQXNCO1FBQ3BFLE1BQU0sV0FBVyxHQUFHLE1BQU0sSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBRTNDLElBQUksT0FBTyxJQUFJLEtBQUssUUFBUSxFQUFFO1lBQzFCLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDekI7UUFFRCxJQUFJLElBQUksRUFBRTtZQUNOLFdBQVcsQ0FBQyxlQUFlLEdBQUcsUUFBUSxJQUFJLEVBQUUsQ0FBQztTQUNoRDtRQUVELE1BQU0sV0FBVyxDQUFDLGtCQUFrQixDQUFDO1FBQ3JDLE1BQU0sV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNsQyxNQUFNLFdBQVcsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDO1FBRXpDLHVFQUF1RTtRQUN2RSxJQUFJLElBQUksSUFBSSxXQUFXLENBQUMsSUFBSSxLQUFLLElBQUksRUFBRTtZQUNuQyxXQUFXLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztTQUMzQjtJQUNMLENBQUM7SUFFRCxpQkFBaUI7SUFFakIseUNBQXlDO0lBRXpDOztPQUVHO0lBQ0gsSUFBVyxJQUFJO1FBQ1gsT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztJQUM3QixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsSUFBVyxJQUFJLENBQUMsS0FBYTtRQUN6QixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksR0FBRyxLQUFLLENBQUM7SUFDOUIsQ0FBQztJQUVEOzs7T0FHRztJQUNILElBQVcsS0FBSztRQUNaLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsMEJBQTBCLENBQUMsQ0FBQztJQUMxRCxDQUFDO0lBRUQ7O09BRUc7SUFDTyxTQUFTO1FBQ2YsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2QsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUN4QztRQUVELE9BQU8sSUFBSSxPQUFPLENBQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUNoQyxJQUFJLE9BQU8sQ0FBQztZQUNaLE1BQU0sWUFBWSxHQUFHLEdBQUcsRUFBRTtnQkFDdEIsNkNBQTZDO2dCQUM3QyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUU7b0JBQ2Isd0NBQXdDO29CQUN4QyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLHNCQUFzQixDQUFDLEVBQUU7d0JBQ2hGLE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLHNCQUFzQixDQUFDLENBQUM7d0JBRWpFLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQzt3QkFDaEIsT0FBTztxQkFDVjtpQkFDSjtnQkFFRCxpREFBaUQ7Z0JBQ2pELE9BQU8sR0FBRyxVQUFVLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQzFDLENBQUMsQ0FBQztZQUNGLFlBQVksRUFBRSxDQUFDO1FBQ25CLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOztPQUVHO0lBQ08sV0FBVztRQUNqQixJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDaEIsT0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUMxQztRQUVELE9BQU8sSUFBSSxPQUFPLENBQU0sQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUNoQyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7Z0JBQzdCLElBQUksT0FBTyxDQUFDO2dCQUNaLE1BQU0sWUFBWSxHQUFHLEdBQUcsRUFBRTtvQkFDdEIsSUFBSSxNQUFNLENBQUMsUUFBUSxFQUFFO3dCQUNqQixPQUFPLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO3dCQUN6QixPQUFPO3FCQUNWO29CQUNELE9BQU8sR0FBRyxVQUFVLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDO2dCQUMxQyxDQUFDLENBQUM7Z0JBQ0YsWUFBWSxFQUFFLENBQUM7WUFDbkIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFRCxpQkFBaUI7SUFFakIseUNBQXlDO0lBRS9CLGlCQUFpQjtRQUN2QixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUMxQyxPQUFPLENBQUMsT0FBTyxDQUFDLHNCQUFhLENBQUMsQ0FBQztRQUMvQixPQUFPLENBQUMsT0FBTyxDQUFDLG9CQUFXLENBQUMsQ0FBQztRQUM3QixPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRUQ7O09BRUc7SUFDSSxPQUFPLENBQUMsT0FBYTtRQUN4QixNQUFNLElBQUksR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxlQUFlLEdBQUcsR0FBRyxrQkFBUSxDQUFDLFVBQVUsa0JBQWtCLENBQUM7UUFDaEUsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVTLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxJQUFZO1FBQzFDLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUN2QixLQUFLLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFOUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBc0IsQ0FBQztRQUNqRixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUNuQyxJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztZQUV0QixNQUFNLEtBQUssR0FBRyxhQUFHLENBQUMsV0FBVyxDQUFDO1lBQzlCLE1BQU0sYUFBYSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGVBQTJCLENBQUMsQ0FBQztZQUNqRSxNQUFNLElBQUksR0FBRyxhQUFhLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3hDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLGVBQWUscUJBQWMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLGlEQUFpRCxDQUFDLENBQUMsQ0FBQztZQUUvRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFFdEIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO2dCQUNqQyxJQUFJLENBQUMsU0FBUyxHQUFHLFFBQVEsQ0FBQztnQkFDMUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsY0FBYyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ2xFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO2dCQUNsRSxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ3ZFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO2dCQUVwRSxJQUFJLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDekIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztRQUVILDBFQUEwRTtRQUMxRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDLENBQUM7SUFDekksQ0FBQztJQUVEOzs7T0FHRztJQUNJLEtBQUssQ0FBQyxLQUFLO1FBQ2QsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBRXZCLE1BQU0sS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBRXBCLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRUQsaUJBQWlCO0lBRWpCLDhCQUE4QjtJQUU5Qjs7O09BR0c7SUFDTyxlQUFlO1FBQ3JCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQ7OztPQUdHO0lBQ08sY0FBYztRQUNwQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVEOzs7T0FHRztJQUNPLGFBQWE7UUFDbkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFRDs7O09BR0c7SUFDTyxlQUFlO1FBQ3JCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQ7OztPQUdHO0lBQ08sY0FBYztRQUNwQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDaEQsQ0FBQztJQUVEOzs7O09BSUc7SUFDTyxjQUFjLENBQUMsS0FBSztRQUMxQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxFQUFFO1lBQ3hDLFNBQVMsRUFBRSxLQUFLLENBQUMsU0FBUztZQUMxQixVQUFVLEVBQUUsS0FBSyxDQUFDLFVBQVU7U0FDL0IsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7O09BSUc7SUFDTyxjQUFjLENBQUMsS0FBSztRQUMxQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsSUFBSSxFQUFFO1lBQ3hDLFVBQVUsRUFBRSxLQUFLLENBQUMsVUFBVTtZQUM1QixTQUFTLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTO1lBQ2pDLEtBQUssRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUs7WUFDekIsTUFBTSxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTTtZQUMzQixRQUFRLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxRQUFRO1lBQy9CLEtBQUssRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUs7WUFDekIsTUFBTSxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsTUFBTTtZQUMzQixHQUFHLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHO1lBQ3JCLEtBQUssRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUs7U0FDNUIsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7O09BSUc7SUFDTyxpQkFBaUIsQ0FBQyxLQUFLO1FBQzdCLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLGlCQUFpQixFQUFFLElBQUksRUFBRTtZQUMzQyxHQUFHLEVBQUUsS0FBSyxDQUFDLFFBQVEsQ0FBQyxHQUFHO1lBQ3ZCLElBQUksRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUk7WUFDekIsVUFBVSxFQUFFLEtBQUssQ0FBQyxRQUFRLENBQUMsVUFBVTtZQUNyQyxRQUFRLEVBQUUsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRO1lBQ2pDLEtBQUssRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUs7U0FDOUIsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7O09BSUc7SUFDTyxlQUFlLENBQUMsS0FBSztRQUMzQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxFQUFFO1lBQ3pDLFdBQVcsRUFBRSxLQUFLLENBQUMsV0FBVztZQUM5QixLQUFLLEVBQUUsS0FBSyxDQUFDLEtBQUs7U0FDckIsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVEOzs7OztPQUtHO0lBQ0ksRUFBRSxDQUFDLFNBQXlCLEVBQUUsUUFBa0I7UUFDbkQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNJLEdBQUcsQ0FBQyxTQUF5QixFQUFFLFFBQWtCO1FBQ3BELElBQUksQ0FBQyxXQUFXLENBQUMsR0FBRyxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUM5QyxDQUFDO0lBRUQ7Ozs7O09BS0c7SUFDSSxJQUFJLENBQUMsU0FBeUIsRUFBRSxRQUFrQjtRQUNyRCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDL0MsQ0FBQztDQUdKO0FBcldELDZCQXFXQzs7OztBQ3BZRDs7Ozs7Ozs7Ozs7OztHQWFHOztBQUVILDZDQUFzQztBQUN0QywwQ0FBbUM7QUFHbkMsMkRBQTJEO0FBQzNELHNEQUFzRDtBQUN0RCx3REFBd0Q7QUFDeEQsTUFBTTtBQUNOLDBFQUEwRTtBQUMxRSxlQUFlO0FBQ2YsTUFBTTtBQUNOLG1FQUFtRTtBQUNuRSxvQ0FBb0M7QUFDcEMsK0JBQStCO0FBQy9CLGdDQUFnQztBQUNoQyxFQUFFO0FBQ0YscURBQXFEO0FBQ3JELHdCQUF3QjtBQUN4QixRQUFRO0FBQ1IsRUFBRTtBQUNGLFVBQVU7QUFDVixpREFBaUQ7QUFDakQsVUFBVTtBQUNWLDZCQUE2QjtBQUM3QixnQ0FBZ0M7QUFDaEMsUUFBUTtBQUNSLEVBQUU7QUFDRixVQUFVO0FBQ1Ysd0NBQXdDO0FBQ3hDLFVBQVU7QUFDViwwQkFBMEI7QUFDMUIsNkJBQTZCO0FBQzdCLFFBQVE7QUFDUixFQUFFO0FBQ0YsOEVBQThFO0FBQzlFLDZCQUE2QjtBQUM3QixtQ0FBbUM7QUFDbkMsK0JBQStCO0FBQy9CLEVBQUU7QUFDRixxREFBcUQ7QUFDckQsUUFBUTtBQUNSLEVBQUU7QUFDRixVQUFVO0FBQ1Ysc0NBQXNDO0FBQ3RDLFVBQVU7QUFDVixtQ0FBbUM7QUFDbkMsRUFBRTtBQUNGLFVBQVU7QUFDVixzQ0FBc0M7QUFDdEMsOENBQThDO0FBQzlDLFVBQVU7QUFDVixtREFBbUQ7QUFDbkQsRUFBRTtBQUNGLGlFQUFpRTtBQUNqRSxJQUFJO0FBQ0osRUFBRTtBQUNGLGlFQUFpRTtBQUNqRSxrRkFBa0Y7QUFDbEYsOENBQThDO0FBQzlDLFFBQVE7QUFDUixFQUFFO0FBQ0YsbURBQW1EO0FBQ25ELEVBQUU7QUFDRiwyQkFBMkI7QUFDM0IsOEJBQThCO0FBQzlCLFFBQVE7QUFDUixFQUFFO0FBQ0YsMkNBQTJDO0FBQzNDLGtDQUFrQztBQUNsQyxRQUFRO0FBQ1IsSUFBSTtBQUVKOzs7R0FHRztBQUNILE1BQXFCLGNBQWUsU0FBUSxvQkFBVTtJQXFEbEQsaUJBQWlCO0lBQ2pCLG9EQUFvRDtJQUVwRCxZQUFtQixNQUE0QixFQUFFLE9BQWdCLEVBQUUsT0FBNkI7UUFDNUYsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRWYsSUFBSSxDQUFDLFFBQVEsR0FBRyxNQUFNLENBQUM7UUFDdkIsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFFdkIsSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQ3JCLENBQUM7SUE5REQseUNBQXlDO0lBRXpDLE1BQU0sS0FBSyxjQUFjO1FBQ3JCLE1BQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxjQUFjLENBQUM7UUFDckMsT0FBTyxDQUFDLFFBQVEsR0FBRyxHQUFHLGtCQUFRLENBQUMsY0FBYywyQkFBMkIsQ0FBQztRQUN6RSxPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRUQsaUJBQWlCO0lBQ2pCLHNDQUFzQztJQUV0Qzs7O09BR0c7SUFDTyxNQUFNLENBQUMsYUFBYSxDQUFDLElBQVk7UUFDdkMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVEOzs7T0FHRztJQUNPLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBVztRQUMvQixJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDekIsT0FBTyxHQUFHLENBQUM7U0FDZDtRQUVELEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDakIsT0FBTyxHQUFHLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQztJQUNuQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ08sTUFBTSxDQUFDLGNBQWMsQ0FBQyxHQUFXO1FBQ3ZDLElBQUksR0FBRyxLQUFLLE1BQU07WUFBRSxPQUFPLEdBQUcsQ0FBQztRQUMvQixJQUFJLEdBQUcsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDekIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzNCO1FBRUQsT0FBTyxTQUFTLGtCQUFRLENBQUMsV0FBVyxJQUFJLGtCQUFRLENBQUMsU0FBUyxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUM7SUFDL0YsQ0FBQztJQXFCRCxpQkFBaUI7SUFDakIseUNBQXlDO0lBRS9CLGFBQWE7UUFDbkIsTUFBTSxJQUFJLEdBQUcsYUFBYSxDQUFDO1lBQ3ZCLElBQUksRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUk7WUFDeEIsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLElBQUk7WUFDN0IsS0FBSyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUs7U0FDbEMsQ0FBMkIsQ0FBQztRQUU3Qiw2REFBNkQ7UUFDN0QsS0FBSyxNQUFNLEdBQUcsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ2pDLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxFQUFFO2dCQUNwQyxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNwQjtTQUNKO1FBRUQsT0FBTyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVELGlCQUFpQjtJQUNqQix3Q0FBd0M7SUFFOUIsU0FBUztRQUNmLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ3hDLEtBQUssQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDM0Q7YUFBTSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUM5QyxLQUFLLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQzFEO0lBQ0wsQ0FBQztJQUVTLFdBQVc7UUFDakIsSUFBSSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDeEMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztTQUM1RDthQUFNLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQzlDLEtBQUssQ0FBQyxHQUFHLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDM0Q7SUFDTCxDQUFDO0lBRVMsaUJBQWlCLENBQUMsT0FBb0I7UUFDNUMsT0FBTyxPQUFPLENBQUMsT0FBTyxLQUFLLE9BQU8sSUFBSSxPQUFPLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxLQUFLLFVBQVUsQ0FBQztJQUN0RixDQUFDO0lBRVMsY0FBYyxDQUFDLE9BQW9CO1FBQ3pDLE9BQU8sQ0FBQyxPQUFPLENBQUMsT0FBTyxLQUFLLE9BQU8sSUFBSSxPQUFPLENBQUMsT0FBTyxLQUFLLFVBQVUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEtBQUssT0FBTyxDQUFDO0lBQ3ZILENBQUM7SUFFUyxlQUFlLENBQUMsT0FBb0I7UUFDMUMsT0FBTyxPQUFPLENBQUMsT0FBTyxLQUFLLFFBQVEsQ0FBQztJQUN4QyxDQUFDO0lBRVMsY0FBYyxDQUFDLE9BQW9CO1FBQ3pDLE9BQU8sT0FBTyxDQUFDLE9BQU8sS0FBSyxPQUFPLElBQUksT0FBTyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsS0FBSyxPQUFPLENBQUM7SUFDbkYsQ0FBQztJQUVTLGNBQWMsQ0FBQyxLQUFLO1FBQzFCLE1BQU0sYUFBYSxHQUFHLENBQUMsQ0FBQztRQUN4QixNQUFNLGFBQWEsR0FBRyxHQUFHLENBQUM7UUFDMUIsTUFBTSxTQUFTLEdBQUcsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFdEMsSUFBSSxPQUFPLENBQU0sQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDakMsSUFBSSxPQUFPLENBQUM7WUFDWixJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUM7WUFDbEIsSUFBSSxRQUE0RSxDQUFDO1lBRWpGLE1BQU0sWUFBWSxHQUFHLEdBQUcsRUFBRTtnQkFDdEIsUUFBUSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMseUJBQXlCLENBQXVFLENBQUM7Z0JBRTNILElBQUksUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7b0JBQ3JCLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFDdEIsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO29CQUNsQixPQUFPO2lCQUNWO3FCQUFNLElBQUksU0FBUyxHQUFHLGFBQWEsRUFBRTtvQkFDbEMsU0FBUyxJQUFJLGFBQWEsQ0FBQztvQkFDM0IsT0FBTyxHQUFHLFVBQVUsQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUM7aUJBQ3JEO3FCQUFNO29CQUNILE1BQU0sQ0FBQzt3QkFDSCxPQUFPLEVBQUUsMENBQTBDO3dCQUNuRCxLQUFLO3FCQUNSLENBQUMsQ0FBQztpQkFDTjtZQUNMLENBQUMsQ0FBQztZQUNGLFlBQVksRUFBRSxDQUFDO1FBQ25CLENBQUMsQ0FBQzthQUNHLElBQUksQ0FBQyxDQUFDLFFBQTRFLEVBQUUsRUFBRTtZQUNuRixJQUFJLElBQUksQ0FBQyxTQUFTLEtBQUssU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtnQkFDN0QsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7YUFDcEU7WUFFRCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUM7WUFFaEMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUV0RCxLQUFLLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ2hDLENBQUMsQ0FBQzthQUNELEtBQUssQ0FBQyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFFUyxjQUFjLENBQUMsS0FBSztRQUMxQixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsYUFBYSxDQUFDO1FBQ3BDLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztRQUVmLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDbEMsSUFBSSxHQUFHLEtBQUssU0FBUyxFQUFFO1lBQ25CLE9BQU87U0FDVjtRQUVELEdBQUcsR0FBRyxjQUFjLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXpDLElBQUksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ3BDLE9BQU87U0FDVjtRQUVELElBQUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ2pDLEtBQUssR0FBRyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FDL0M7YUFBTSxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDckMsS0FBSyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsT0FBaUQsQ0FBQyxDQUFDLENBQUM7U0FDeEY7YUFBTSxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDdEMsS0FBSyxHQUFHLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsT0FBNEIsQ0FBQyxDQUFDLENBQUM7U0FDbkU7YUFBTSxJQUFJLElBQUksQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLEVBQUU7WUFDckMsS0FBSyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztTQUMvQztRQUVELElBQUksQ0FBQyxNQUFNLENBQ1AsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLEVBQUU7WUFDcEMsQ0FBQyxHQUFHLENBQUMsRUFBRSxLQUFLO1NBQ2YsQ0FBQyxDQUNMLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUU7WUFDZCxNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLHlCQUF5QixDQUFDLENBQUM7WUFDeEUsSUFBSSxDQUFDLGdCQUFnQixDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDNUMsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0lBRVMsZ0JBQWdCLENBQUMsUUFBZ0I7UUFDdkMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3JDLE1BQU0sT0FBTyxHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUVuQyw4Q0FBOEM7UUFDOUMscURBQXFEO1FBQ3JELElBQUksS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNsQixLQUFLLE1BQU0sT0FBTyxJQUFJLFFBQVEsRUFBRTtZQUM1QixJQUFJLEdBQUcsR0FBRyxPQUFPLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3ZDLElBQUksR0FBRyxLQUFLLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDLEVBQUU7Z0JBQ3BELFNBQVM7YUFDWjtZQUVELEdBQUcsR0FBRyxjQUFjLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRXpDLElBQUksSUFBSSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNqQyxLQUFLLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFDLElBQUksS0FBSyxDQUFDO2FBQ3hFO2lCQUFNLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsRUFBRTtnQkFDckMsS0FBSyxHQUFHLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsR0FBRyxFQUFFLE9BQU8sQ0FBQyxJQUFJLEtBQUssQ0FBQzthQUN2RTtpQkFBTSxJQUFJLElBQUksQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ3RDLEtBQUssR0FBRyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEdBQUcsRUFBRSxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUM7YUFDdkU7aUJBQU0sSUFBSSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNyQyxLQUFLLEdBQUcsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFDLElBQUksS0FBSyxDQUFDO2FBQ3hFO2lCQUFNO2dCQUNILE9BQU8sQ0FBQyxLQUFLLENBQUMsZ0NBQWdDLENBQUMsQ0FBQzthQUNuRDtTQUNKO1FBRUQsSUFBSSxLQUFLLEVBQUU7WUFDUCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7U0FDcEQ7SUFDTCxDQUFDO0lBRVMsWUFBWSxDQUFDLE9BQTRCLEVBQUUsT0FBNEI7UUFDN0UsK0JBQStCO1FBQy9CLE1BQU0sS0FBSyxxQkFBUSxhQUFhLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBRSxDQUFDO1FBQ3hFLEtBQUssTUFBTSxDQUFDLEdBQUcsRUFBRSxRQUFRLENBQUMsSUFBSSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25ELE1BQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUU5Qix1REFBdUQ7WUFDdkQsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEVBQUU7Z0JBQ3BELE9BQU8sS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2dCQUNsQixTQUFTO2FBQ1o7WUFFRCx1QkFBdUI7WUFDdkIsSUFBSSxRQUFRLEtBQUssU0FBUyxJQUFJLFFBQVEsS0FBSyxRQUFRLEVBQUU7Z0JBQ2pELFNBQVM7YUFDWjtZQUVELEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxRQUFRLENBQUM7U0FDekI7UUFFRCxPQUFPLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRU0sWUFBWTtRQUNmLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDM0QsQ0FBQztJQUVTLGNBQWMsQ0FBQyxLQUFZLEVBQUUsSUFBMkMsRUFBRSxPQUEwQixFQUFFLEVBQVU7UUFDdEgsSUFBSSxJQUFJLENBQUMsR0FBRyxLQUFLLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFFO1lBQy9CLE9BQU87U0FDVjtRQUVELE1BQU0sSUFBSSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM3QixhQUFhO1FBQ2IsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFbkIsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1FBQ3hFLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBRVMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFhO1FBQ2hDLHdDQUF3QztRQUN4QywyREFBMkQ7UUFDM0QsT0FBTyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUNyRCxDQUFDO0lBRVMsbUJBQW1CLENBQ3pCLEtBQXlFLEVBQ3pFLEdBQVcsRUFDWCxJQUE0QjtRQUU1QixJQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdEIsSUFBSSxLQUFLLEtBQUssU0FBUyxFQUFFO1lBQ3JCLHdEQUF3RDtZQUN4RCxNQUFNLFVBQVUsR0FBRyxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUM7WUFFL0IsSUFBSSxVQUFVLEVBQUU7Z0JBQ1osMEJBQTBCO2dCQUMxQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUNsQyxPQUFPLElBQUksQ0FBQzthQUNmO1NBQ0o7YUFBTTtZQUNILGtEQUFrRDtZQUNsRCxJQUFJLENBQUMsWUFBWSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztTQUNuQztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFUyxvQkFBb0IsQ0FBQyxLQUErQixFQUFFLEdBQVcsRUFBRSxJQUE0QjtRQUNyRyxJQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdEIsSUFBSSxLQUFLLEtBQUssU0FBUyxFQUFFO1lBQ3JCLE1BQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssU0FBUyxDQUFDO1lBRXZELDBCQUEwQjtZQUMxQixJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQ2xDLE9BQU8sSUFBSSxDQUFDO1NBQ2Y7YUFBTTtZQUNILElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQ3BDO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVTLG9CQUFvQixDQUFDLEtBQStCLEVBQUUsR0FBVyxFQUFFLElBQTRCO1FBQ3JHLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN0QixJQUFJLEtBQUssS0FBSyxTQUFTLElBQUksS0FBSyxLQUFLLEVBQUUsRUFBRTtZQUNyQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzNDLE9BQU8sSUFBSSxDQUFDO1NBQ2Y7YUFBTTtZQUNILDhEQUE4RDtZQUM5RCxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNoQyxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsQ0FBQzthQUNyQztpQkFBTTtnQkFDSCxJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQzthQUN0QztTQUNKO1FBQ0QsT0FBTyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVTLFlBQVksQ0FBQyxLQUF5RSxFQUFFLEtBQWE7UUFDM0csS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNyQixDQUFDO0lBRVMsYUFBYSxDQUFDLEtBQStCLEVBQUUsS0FBYTtRQUNsRSxJQUFJLEtBQUssS0FBSyxNQUFNLEVBQUU7WUFDbEIsS0FBSyxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7U0FDakM7YUFBTTtZQUNILEtBQUssQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7U0FDL0I7SUFDTCxDQUFDO0lBRVMsaUJBQWlCLENBQUMsS0FBeUU7UUFDakcsTUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxLQUFLLEVBQUU7WUFDUixPQUFPLEVBQUUsQ0FBQztTQUNiO1FBRUQsT0FBTyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDbkMsQ0FBQztJQUVTLGtCQUFrQixDQUFDLEtBQStCO1FBQ3hELE9BQU8sQ0FBQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQyxPQUFPLEtBQUssTUFBTSxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUM7SUFDNUYsQ0FBQztJQUVTLGtCQUFrQixDQUFDLEtBQStCO1FBQ3hELE1BQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDaEMsTUFBTSxRQUFRLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxJQUFJLElBQUksQ0FBd0IsQ0FBQztRQUN4RixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUN0QyxNQUFNLE9BQU8sR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLElBQUksTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsQ0FBQyxPQUFPLEtBQUssTUFBTSxFQUFFO2dCQUNoRSxPQUFPLE9BQU8sQ0FBQyxFQUFFLENBQUM7YUFDckI7U0FDSjtRQUNELE9BQU8sRUFBRSxDQUFDO0lBQ2QsQ0FBQztJQUVELEtBQUssQ0FBQyxLQUFLO1FBQ1AsMkNBQTJDO1FBQzNDLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRTtZQUNkLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUM5QjtRQUVELElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUVuQixPQUFPLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN6QixDQUFDO0NBR0o7QUEzWEQsaUNBMlhDOzs7O0FDdGREOzs7Ozs7Ozs7Ozs7O0dBYUc7O0FBR0gsNkNBQXNDO0FBQ3RDLHNEQUErQztBQUMvQyxrQ0FBNkM7QUFDN0MsZ0VBQXlEO0FBQ3pELHFEQUFrRDtBQUVsRDs7Ozs7Ozs7O0dBU0c7QUFDSCxNQUFxQixZQUFhLFNBQVEsb0JBQVU7SUFLaEQsaUJBQWlCO0lBRWpCLG9EQUFvRDtJQUVwRCxZQUFZLE9BQWlCLEVBQUUsT0FBNkI7UUFDeEQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRWYsSUFBSSxPQUFPLEtBQUssU0FBUyxFQUFFO1lBQ3ZCLE9BQU8sR0FBRztnQkFDTixJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsMEJBQTBCLENBQUM7Z0JBQ3BELElBQUksRUFBRSxFQUFFO2dCQUNSLE1BQU0sRUFBRSxDQUFDO2dCQUNULEdBQUcsRUFBRSxFQUFFO2dCQUNQLElBQUksRUFBRSxpQkFBTyxDQUFDLE1BQU07Z0JBQ3BCLEtBQUssRUFBRSxLQUFLO2FBQ2YsQ0FBQztTQUNMO1FBRUQsSUFBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7SUFDNUIsQ0FBQztJQUVELGlCQUFpQjtJQUVqQix5Q0FBeUM7SUFFekM7OztPQUdHO0lBQ0gsSUFBVyxPQUFPO1FBQ2QsT0FBTyxTQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3BDLENBQUM7SUFFRCxJQUFXLEtBQUs7UUFDWixJQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztRQUMvQixJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxLQUFLLEVBQUUsRUFBRTtZQUMzQixLQUFLLEdBQUcsR0FBRyxLQUFLLEtBQUssSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLEdBQUcsQ0FBQztTQUM5QztRQUNELE9BQU8sS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxpQkFBaUI7SUFFakIseUNBQXlDO0lBRS9CLGlCQUFpQjtRQUN2QixNQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUUxQyxPQUFPLENBQUMsT0FBTyxDQUFDO1lBQ1osS0FBSyxFQUFFLHdCQUF3QjtZQUMvQixJQUFJLEVBQUUsWUFBWTtZQUNsQixLQUFLLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsb0NBQW9DLENBQUM7WUFDL0QsT0FBTyxFQUFFLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQztTQUN6QyxDQUFDLENBQUM7UUFFSCxPQUFPLE9BQU8sQ0FBQztJQUNuQixDQUFDO0lBRUQsaUJBQWlCO0lBRWpCLHdDQUF3QztJQUV4Qzs7T0FFRztJQUNPLE1BQU0sQ0FBQyxLQUFpQjtRQUM5QixNQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDO1FBQzdCLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBRW5CLE1BQU0sR0FBRyxHQUFHLHlCQUFrQixFQUFFLENBQUM7UUFDakMsSUFBSSxLQUFLLENBQUMsUUFBUSxFQUFFO1lBQ2hCLElBQUksc0JBQVksQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztTQUNwRDthQUFNO1lBQ0gsSUFBSSxzQkFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDLFdBQVcsRUFBRSxFQUFFO2dCQUNsQyxJQUFJLHNCQUFZLENBQUMsV0FBVyxFQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDN0QsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ25CO0lBQ0wsQ0FBQztDQUVKO0FBcEZELCtCQW9GQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVGhlIFBERm91bmRyeSBBUEkuXG4gKlxuICogWW91IGNhbiBhY2Nlc3MgdGhlIEFQSSB3aXRoIGB1aS5QREZvdW5kcnlgLlxuICogQG1vZHVsZWRlZmluaXRpb24gQVBJXG4gKi9cblxuaW1wb3J0IHtcbiAgICBjYW5PcGVuUERGLFxuICAgIGRlbGV0ZVBERkRhdGEsXG4gICAgZ2V0QWJzb2x1dGVVUkwsXG4gICAgZ2V0UERGRGF0YSxcbiAgICBnZXRSb3V0ZVByZWZpeCxcbiAgICBnZXRVc2VySWRzRXhjZXB0TWUsXG4gICAgaXNFbnRpdHlQREYsXG4gICAgc2V0UERGRGF0YSxcbiAgICB2YWxpZGF0ZUFic29sdXRlVVJMLFxufSBmcm9tICcuL1V0aWwnO1xuaW1wb3J0IFN0YXRpY1ZpZXdlciBmcm9tICcuL3ZpZXdlci9TdGF0aWNWaWV3ZXInO1xuaW1wb3J0IHsgUERGRGF0YSB9IGZyb20gJy4vY29tbW9uL3R5cGVzL1BERkRhdGEnO1xuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4vU2V0dGluZ3MnO1xuaW1wb3J0IFBERkNhY2hlIGZyb20gJy4vY2FjaGUvUERGQ2FjaGUnO1xuaW1wb3J0IEJhc2VWaWV3ZXIgZnJvbSAnLi92aWV3ZXIvQmFzZVZpZXdlcic7XG5pbXBvcnQgeyBQREZUeXBlIH0gZnJvbSAnLi9jb21tb24vdHlwZXMvUERGVHlwZSc7XG5pbXBvcnQgRmlsbGFibGVWaWV3ZXIgZnJvbSAnLi92aWV3ZXIvRmlsbGFibGVWaWV3ZXInO1xuXG4vLyBub2luc3BlY3Rpb24gSlNVbnVzZWRHbG9iYWxTeW1ib2xzXG5cbi8qKlxuICogQSBmdW5jdGlvbiB0byBwYXNzZWQgdG8ge0BsaW5rIEFwaS5maW5kUERGRGF0YX0gdG8gZmluZCB1c2VyIHNwZWNpZmllZCBQREYgZGF0YS5cbiAqIEBtb2R1bGUgQVBJXG4gKi9cbmV4cG9ydCB0eXBlIFBERlZhbGlkYXRvciA9IChkYXRhOiBQREZEYXRhKSA9PiBib29sZWFuO1xuXG4vKipcbiAqIE9wZW4gdGhlIHNwZWNpZmllZCBQREYgaW4gYSBwcm92aWRlZCB2aWV3ZXJcbiAqIEBwYXJhbSB2aWV3ZXJcbiAqIEBwYXJhbSB1cmxcbiAqIEBwYXJhbSBwYWdlXG4gKiBAcGFyYW0gY2FjaGVcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gX2hhbmRsZU9wZW4odmlld2VyOiBCYXNlVmlld2VyLCB1cmw6IHN0cmluZywgcGFnZTogbnVtYmVyIHwgdW5kZWZpbmVkLCBjYWNoZTogYm9vbGVhbikge1xuICAgIGlmIChjYWNoZSkge1xuICAgICAgICBjb25zdCBjYWNoZWRCeXRlcyA9IGF3YWl0IFBERkNhY2hlLmdldENhY2hlKHVybCk7XG4gICAgICAgIC8vIElmIHdlIGhhdmUgYSBjYWNoZSBoaXQgb3BlbiB0aGUgY2FjaGVkIGRhdGFcbiAgICAgICAgaWYgKGNhY2hlZEJ5dGVzKSB7XG4gICAgICAgICAgICBhd2FpdCB2aWV3ZXIub3BlbihjYWNoZWRCeXRlcywgcGFnZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBPdGhlcndpc2Ugd2Ugc2hvdWxkIG9wZW4gaXQgYnkgdXJsXG4gICAgICAgICAgICBhd2FpdCB2aWV3ZXIub3Blbih1cmwsIHBhZ2UpO1xuICAgICAgICAgICAgLy8gQW5kIHdoZW4gdGhlIGRvd25sb2FkIGlzIGNvbXBsZXRlIHNldCB0aGUgY2FjaGVcbiAgICAgICAgICAgIHZpZXdlci5kb3dubG9hZCgpLnRoZW4oKGJ5dGVzKSA9PiB7XG4gICAgICAgICAgICAgICAgUERGQ2FjaGUuc2V0Q2FjaGUodXJsLCBieXRlcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGF3YWl0IHZpZXdlci5vcGVuKHVybCwgcGFnZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIE9wdGlvbnMgcGFzc2VkIHRvIHRoZSB7QGxpbmsgQXBpLm9wZW5QREZ9IGZ1bmN0aW9uLlxuICogQG1vZHVsZSBBUElcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQREZPcGVuT3B0aW9ucyB7XG4gICAgLyoqXG4gICAgICogVGhlIHBhZ2UgdG8gb3BlbiB0by4gSWYgbm90IHNwZWNpZmllZCwgUERGb3VuZHJ5IHdpbGwgYXR0ZW1wdCB0byBvcGVuIHRoZVxuICAgICAqICBsYXN0IHBhZ2UgdGhlIHVzZXIgd2FzIHZpZXdpbmcuXG4gICAgICovXG4gICAgcGFnZT86IG51bWJlcjtcbiAgICAvKipcbiAgICAgKiBJZiB5b3UncmUgb3BlbmluZyBhIGZpbGxhYmxlIHBkZiwgeW91IG11c3Qgc3BlY2lmeSBhbiBlbnRpdHkgZm9yIGRhdGEgc3RvcmFnZS5cbiAgICAgKi9cbiAgICBlbnRpdHk/OiBKb3VybmFsRW50cnk7XG59XG5cbi8qKlxuICogQSBkZWZpbml0aW9uIGZvciBhIHZpZXdlciB0aGVtZS5cbiAqIEBtb2R1bGUgQVBJXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVmlld2VyVGhlbWUge1xuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgZmlsZVBhdGg6IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgUERGb3VuZHJ5IEFQSVxuICpcbiAqIFlvdSBjYW4gYWNjZXNzIHRoZSBBUEkgd2l0aCBgdWkuUERGb3VuZHJ5YC5cbiAqIEBtb2R1bGUgQVBJXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gICAgLyoqXG4gICAgICogRW5hYmxlIGFkZGl0aW9uYWwgZGVidWcgaW5mb3JtYXRpb24gZm9yIHRoZSBzcGVjaWZpZWQgY2F0ZWdvcnkuXG4gICAgICogQGNhdGVnb3J5IERlYnVnXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBERUJVRyA9IHtcbiAgICAgICAgLy8gVE9ET1xuICAgICAgICAvKipcbiAgICAgICAgICogV2hlbiBzZXQgdG8gdHJ1ZSwgZW5hYmxlcyB0aGUgbG9nZ2luZyBldmVudCBuYW1lcyBhbmQgYXJndW1lbnRzIHRvIGNvbnNvbGUuXG4gICAgICAgICAqL1xuICAgICAgICBFVkVOVFM6IGZhbHNlLFxuICAgIH07XG5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIlN0YXRpYyBNZXRob2RzXCI+XG5cbiAgICBwcml2YXRlIHN0YXRpYyBfYXZhaWxhYmxlVGhlbWVzOiB7IFtpZDogc3RyaW5nXTogVmlld2VyVGhlbWUgfSA9IHt9O1xuXG4gICAgLyoqXG4gICAgICogR2V0IGEgZnVsbCB0aGVtZSBkZWZpbml0aW9uIGJ5IGlkLlxuICAgICAqIEBwYXJhbSBpZCBUaGUgdW5pcXVlIGlkIG9mIHRoZSB0aGVtZSB0byBsb29rdXAuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXRUaGVtZShpZDogc3RyaW5nKTogVmlld2VyVGhlbWUgfCBudWxsIHtcbiAgICAgICAgcmV0dXJuIEFwaS5fYXZhaWxhYmxlVGhlbWVzW2lkXSA/PyBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudGx5IGVuYWJsZWQgdGhlbWUgaWQuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXQgYWN0aXZlVGhlbWUoKTogVmlld2VyVGhlbWUge1xuICAgICAgICBjb25zdCBpZCA9IFNldHRpbmdzLmdldChTZXR0aW5ncy5TRVRUSU5HU19LRVkuVklFV0VSX1RIRU1FKTtcbiAgICAgICAgcmV0dXJuIEFwaS5fYXZhaWxhYmxlVGhlbWVzW2lkXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgYSBtYXAgb2YgdGhlbWVzIGF2YWlsYWJsZSBmb3IgdXNlLlxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZ2V0IGF2YWlsYWJsZVRoZW1lcygpIHtcbiAgICAgICAgY29uc3QgdGhlbWVzTWFwID0ge307XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKEFwaS5fYXZhaWxhYmxlVGhlbWVzKSkge1xuICAgICAgICAgICAgdGhlbWVzTWFwW2tleV0gPSBBcGkuX2F2YWlsYWJsZVRoZW1lc1trZXldLm5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoZW1lc01hcDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIHRoZW1lIGZvciB1c2Ugd2l0aCBQREZvdW5kcnkuIFlvdSBtdXN0IHJlZ2lzdGVyIGEgdGhlbWUgYmVmb3JlIGByZWFkeWAuIERvIHNvIGluIGBzZXR1cGAuXG4gICAgICogQHBhcmFtIGlkIFRoZSB1bmlxdWUgaWQgb2YgdGhlIHRoZW1lLiBQcm92aWRpbmcgYW4gYWxyZWFkeSBleGlzdGluZyBpZCB3aWxsIG92ZXItd3JpdGUgdGhlIGV4aXN0aW5nIHRoZW1lLlxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSB1c2VyLWZhY2luZyBkaXNwbGF5IG5hbWUgb2YgdGhlIHRoZW1lLlxuICAgICAqIEBwYXJhbSBmaWxlUGF0aCBUaGUgcmVsYXRpdmUgcGF0aCBvZiB0aGUgdGhlbWUgY3NzIGZpbGVcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHJlZ2lzdGVyVGhlbWUoaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBmaWxlUGF0aDogc3RyaW5nKSB7XG4gICAgICAgIGlmICghZmlsZVBhdGguZW5kc1dpdGgoJy5jc3MnKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbWF5IG9ubHkgcmVnaXN0ZXIgY3NzIGZpbGVzIGFzIHRoZW1lcy4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChBcGkuX2F2YWlsYWJsZVRoZW1lcy5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgUERGb3VuZHJ5IHRoZW1lIHdpdGggaWQgb2YgXCIke2lkfVwiIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCFgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2F2YWlsYWJsZVRoZW1lc1tpZF0gPSB7XG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLyoqXG4gICAgICogQSByZWZlcmVuY2UgdG8gdGhlIHVuY2xhc3NpZmllZCB1dGlsaXR5IGZ1bmN0aW9ucy5cbiAgICAgKiBAY2F0ZWdvcnkgVXRpbGl0eVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZ2V0IFV0aWxpdGllcygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFJvdXRlUHJlZml4LFxuICAgICAgICAgICAgZ2V0QWJzb2x1dGVVUkwsXG4gICAgICAgICAgICB2YWxpZGF0ZUFic29sdXRlVVJMLFxuICAgICAgICAgICAgaXNFbnRpdHlQREYsXG4gICAgICAgICAgICBnZXRQREZEYXRhLFxuICAgICAgICAgICAgc2V0UERGRGF0YSxcbiAgICAgICAgICAgIGRlbGV0ZVBERkRhdGEsXG4gICAgICAgICAgICBjYW5PcGVuUERGLFxuICAgICAgICAgICAgZ2V0VXNlcklkc0V4Y2VwdE1lLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiR2V0UERGRGF0YSBNZXRob2RzXCI+XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIGEgUERGIGNvbnRhaW5pbmcgam91cm5hbCBlbnRyeSBmcm9tIHRoZSBqb3VybmFscyBkaXJlY3RvcnkgdXNpbmcgYSBzcGVjaWZpZWQgY29tcGFyZXIuXG4gICAgICogQHBhcmFtIGNvbXBhcmVyIFRoZSBmdW5jdGlvbiB0byBjb21wYXJlIFBERiBkYXRhIHdpdGguXG4gICAgICogQHBhcmFtIGFsbG93SW52aXNpYmxlIElmIHRydWUsIFBERnMgaGlkZGVuIGZyb20gdGhlIGFjdGl2ZSB1c2VyIHdpbGwgYmUgcmV0dXJuZWQuXG4gICAgICogQGNhdGVnb3J5IFBERkRhdGFcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZpbmRQREZFbnRpdHkoY29tcGFyZXI6IFBERlZhbGlkYXRvciwgYWxsb3dJbnZpc2libGU6IGJvb2xlYW4gPSB0cnVlKTogSm91cm5hbEVudHJ5IHwgbnVsbCB7XG4gICAgICAgIHJldHVybiBnYW1lLmpvdXJuYWwuZmluZCgoam91cm5hbEVudHJ5OiBKb3VybmFsRW50cnkpID0+IHtcbiAgICAgICAgICAgIGlmICghaXNFbnRpdHlQREYoam91cm5hbEVudHJ5KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcGRmRGF0YSA9IGdldFBERkRhdGEoam91cm5hbEVudHJ5KTtcbiAgICAgICAgICAgIGlmIChwZGZEYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiAoam91cm5hbEVudHJ5LnZpc2libGUgfHwgYWxsb3dJbnZpc2libGUpICYmIGNvbXBhcmVyKHBkZkRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgbWV0aG9kLiBBbGlhcyBmb3Ige0BsaW5rIEFwaS5maW5kUERGRGF0YX0gd2l0aCBhIGNvbXBhcmVyIHRoYXQgc2VhcmNoZXMgYnkgUERGIENvZGUuXG4gICAgICogQHBhcmFtIGNvZGUgV2hpY2ggY29kZSB0byBzZWFyY2ggZm9yIGEgUERGIHdpdGguXG4gICAgICogQHBhcmFtIGFsbG93SW52aXNpYmxlIFNlZSBhbGxvd1Zpc2libGUgb24ge0BsaW5rIGZpbmRQREZFbnRpdHl9XG4gICAgICogQGNhdGVnb3J5IFBERkRhdGFcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGZpbmRQREZEYXRhQnlDb2RlKGNvZGU6IHN0cmluZywgYWxsb3dJbnZpc2libGU6IGJvb2xlYW4gPSB0cnVlKTogUERGRGF0YSB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiBBcGkuZmluZFBERkRhdGEoKGRhdGE6IFBERkRhdGEpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmNvZGUgPT09IGNvZGU7XG4gICAgICAgIH0sIGFsbG93SW52aXNpYmxlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgbWV0aG9kLiBBbGlhcyBmb3Ige0BsaW5rIEFwaS5maW5kUERGRGF0YX0gd2l0aCBhIGNvbXBhcmVyIHRoYXQgc2VhcmNoZXMgYnkgUERGIE5hbWUuXG4gICAgICogQHBhcmFtIG5hbWUgV2hpY2ggbmFtZSB0byBzZWFyY2ggZm9yIGEgUERGIHdpdGguXG4gICAgICogQHBhcmFtIGNhc2VJbnNlbnNpdGl2ZSBJZiBhIGNhc2UgaW5zZW5zaXRpdmUgc2VhcmNoIHNob3VsZCBiZSBkb25lLlxuICAgICAqIEBwYXJhbSBhbGxvd0ludmlzaWJsZSBTZWUgYWxsb3dWaXNpYmxlIG9uIHtAbGluayBmaW5kUERGRW50aXR5fVxuICAgICAqIEBjYXRlZ29yeSBQREZEYXRhXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBmaW5kUERGRGF0YUJ5TmFtZShuYW1lOiBzdHJpbmcsIGNhc2VJbnNlbnNpdGl2ZTogYm9vbGVhbiA9IHRydWUsIGFsbG93SW52aXNpYmxlOiBib29sZWFuID0gdHJ1ZSk6IFBERkRhdGEgfCB1bmRlZmluZWQge1xuICAgICAgICBpZiAoY2FzZUluc2Vuc2l0aXZlKSB7XG4gICAgICAgICAgICByZXR1cm4gQXBpLmZpbmRQREZEYXRhKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEubmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB9LCBhbGxvd0ludmlzaWJsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gQXBpLmZpbmRQREZEYXRhKChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEubmFtZSA9PT0gbmFtZTtcbiAgICAgICAgICAgIH0sIGFsbG93SW52aXNpYmxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmRzIGEgUERGIGVudGl0eSBjcmVhdGVkIGJ5IHRoZSB1c2VyIGFuZCBjb25zdHJ1Y3RzIGEge0BsaW5rIFBERkRhdGF9IG9iamVjdCBvZiB0aGUgcmVzdWx0aW5nIFBERidzIGRhdGEuXG4gICAgICogQHBhcmFtIGNvbXBhcmVyIEEgY29tcGFyaXNvbiBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgdXNlZC5cbiAgICAgKiBAcGFyYW0gYWxsb3dJbnZpc2libGUgU2VlIGFsbG93VmlzaWJsZSBvbiB7QGxpbmsgZmluZFBERkVudGl0eX1cbiAgICAgKiBAY2F0ZWdvcnkgUERGRGF0YVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgZmluZFBERkRhdGEoY29tcGFyZXI6IFBERlZhbGlkYXRvciwgYWxsb3dJbnZpc2libGU6IGJvb2xlYW4gPSB0cnVlKTogUERGRGF0YSB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGNvbnN0IHBkZiA9IHRoaXMuZmluZFBERkVudGl0eShjb21wYXJlciwgYWxsb3dJbnZpc2libGUpO1xuICAgICAgICBpZiAocGRmID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGdldFBERkRhdGEocGRmKTtcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJPcGVuUERGIE1ldGhvZHNcIj5cblxuICAgIC8qKlxuICAgICAqIE9wZW4gdGhlIFBERiB3aXRoIHRoZSBwcm92aWRlZCBjb2RlIHRvIHRoZSBzcGVjaWZpZWQgcGFnZS5cbiAgICAgKiBIZWxwZXIgZm9yIHtAbGluayBmaW5kUERGRGF0YUJ5Q29kZX0gdGhlbiB7QGxpbmsgb3BlblBERn0uXG4gICAgICogQGNhdGVnb3J5IE9wZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIG9wZW5QREZCeUNvZGUoY29kZTogc3RyaW5nLCBvcHRpb25zPzogUERGT3Blbk9wdGlvbnMpOiBQcm9taXNlPEJhc2VWaWV3ZXI+IHtcbiAgICAgICAgY29uc3QgcGRmID0gdGhpcy5maW5kUERGRGF0YUJ5Q29kZShjb2RlKTtcblxuICAgICAgICBpZiAocGRmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRVJST1IuTm9QREZXaXRoQ29kZScpO1xuXG4gICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKGVycm9yKTtcblxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLm9wZW5QREYocGRmLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcGVuIHRoZSBQREYgd2l0aCB0aGUgcHJvdmlkZWQgY29kZSB0byB0aGUgc3BlY2lmaWVkIHBhZ2UuXG4gICAgICogSGVscGVyIGZvciB7QGxpbmsgZmluZFBERkRhdGFCeUNvZGV9IHRoZW4ge0BsaW5rIG9wZW5QREZ9LlxuICAgICAqIEBjYXRlZ29yeSBPcGVuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBvcGVuUERGQnlOYW1lKG5hbWU6IHN0cmluZywgb3B0aW9ucz86IFBERk9wZW5PcHRpb25zKTogUHJvbWlzZTxCYXNlVmlld2VyPiB7XG4gICAgICAgIGNvbnN0IHBkZiA9IHRoaXMuZmluZFBERkRhdGFCeU5hbWUobmFtZSk7XG5cbiAgICAgICAgaWYgKHBkZiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRVJST1IuTm9QREZXaXRoTmFtZScpO1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG5cbiAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnMuZXJyb3IoZXJyb3IubWVzc2FnZSk7XG5cbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcy5vcGVuUERGKHBkZiwgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3BlbiB0aGUgcHJvdmlkZWQge0BsaW5rIFBERkRhdGF9IHRvIHRoZSBzcGVjaWZpZWQgcGFnZS5cbiAgICAgKiBAcGFyYW0gcGRmIFRoZSBQREYgdG8gb3Blbi4gU2VlIHtAbGluayBBcGkuZmluZFBERkRhdGF9LlxuICAgICAqIEBwYXJhbSBvcHRpb25zIFRoZSBzcGVjaWZpZWQgb3B0aW9ucyBmb3IgUERGcy5cbiAgICAgKiBAY2F0ZWdvcnkgT3BlblxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgb3BlblBERihwZGY6IFBERkRhdGEsIG9wdGlvbnM/OiBQREZPcGVuT3B0aW9ucyk6IFByb21pc2U8QmFzZVZpZXdlcj4ge1xuICAgICAgICBpZiAob3B0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBvcHRpb25zID0ge307XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgeyB1cmwsIG9mZnNldCwgY2FjaGUgfSA9IHBkZjtcblxuICAgICAgICBpZiAodHlwZW9mIG9mZnNldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlmIChvZmZzZXQgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gcGFyc2VJbnQob2Zmc2V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChvZmZzZXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXZhbGlkYXRlQWJzb2x1dGVVUkwodXJsKSkge1xuICAgICAgICAgICAgdXJsID0gZ2V0QWJzb2x1dGVVUkwodXJsKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLnBhZ2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgb3B0aW9ucy5wYWdlID0gb3B0aW9ucy5wYWdlICsgb2Zmc2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHZpZXdlcjogQmFzZVZpZXdlcjtcblxuICAgICAgICBzd2l0Y2ggKHBkZi50eXBlKSB7XG4gICAgICAgICAgICBjYXNlIFBERlR5cGUuU3RhdGljOlxuICAgICAgICAgICAgICAgIHZpZXdlciA9IG5ldyBTdGF0aWNWaWV3ZXIocGRmKTtcbiAgICAgICAgICAgICAgICB2aWV3ZXIucmVuZGVyKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgYXdhaXQgX2hhbmRsZU9wZW4odmlld2VyLCB1cmwsIG9wdGlvbnMucGFnZSwgY2FjaGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBQREZUeXBlLkZpbGxhYmxlOlxuICAgICAgICAgICAgICAgIGlmICghKG9wdGlvbnMuZW50aXR5IGluc3RhbmNlb2YgSm91cm5hbEVudHJ5KSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Byb3ZpZGVkIGVudGl0eSB3YXMgbm90IGEgam91cm5hbCBlbnRyeS4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2aWV3ZXIgPSBuZXcgRmlsbGFibGVWaWV3ZXIob3B0aW9ucy5lbnRpdHksIHBkZik7XG4gICAgICAgICAgICAgICAgdmlld2VyLnJlbmRlcih0cnVlKTtcblxuICAgICAgICAgICAgICAgIGF3YWl0IF9oYW5kbGVPcGVuKHZpZXdlciwgdXJsLCBvcHRpb25zLnBhZ2UsIGNhY2hlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUERGVHlwZS5BY3RvcjpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FjdG9yIHNoZWV0cyBjYW4gb25seSBiZSBvcGVuZWQgdGhyb3VnaCB0aGUgYWN0b3Iuc2hlZXQgYWNjZXNzb3IuJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXdlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPcGVuIGEgVVJMIGFzIGEgc3RhdGljIFBERi4gRm9yIGZvcm0gZmlsbGFibGUgUERGcyB5b3UgbXVzZSB1c2Uge0BsaW5rIEFwaS5vcGVuUERGfVxuICAgICAqIEBwYXJhbSB1cmwgVGhlIFVSTCB0byBvcGVuIChtdXN0IGJlIGFic29sdXRlKS5cbiAgICAgKiBAcGFyYW0gcGFnZSBXaGljaCBwYWdlIHRvIG9wZW4gdG8uIE11c3QgYmUgPj0gMS5cbiAgICAgKiBAcGFyYW0gY2FjaGUgSWYgVVJMIGJhc2VkIGNhY2hpbmcgc2hvdWxkIGJlIHVzZWQuXG4gICAgICogQGNhdGVnb3J5IE9wZW5cbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIG9wZW5VUkwodXJsOiBzdHJpbmcsIHBhZ2U6IG51bWJlciA9IDEsIGNhY2hlOiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8QmFzZVZpZXdlcj4ge1xuICAgICAgICBpZiAoaXNOYU4ocGFnZSkgfHwgcGFnZSA8PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBhZ2UgbXVzdCBiZSA+IDAsIGJ1dCAke3BhZ2V9IHdhcyBnaXZlbi5gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdmFsaWRhdGVBYnNvbHV0ZVVSTCh1cmwpKSB7XG4gICAgICAgICAgICB1cmwgPSBnZXRBYnNvbHV0ZVVSTCh1cmwpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgdmlld2VyID0gbmV3IFN0YXRpY1ZpZXdlcigpO1xuICAgICAgICB2aWV3ZXIucmVuZGVyKHRydWUpO1xuXG4gICAgICAgIGF3YWl0IF9oYW5kbGVPcGVuKHZpZXdlciwgdXJsLCBwYWdlLCBjYWNoZSk7XG5cbiAgICAgICAgcmV0dXJuIHZpZXdlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93cyB0aGUgdXNlciBtYW51YWwgdG8gdGhlIGFjdGl2ZSB1c2VyLlxuICAgICAqIEBjYXRlZ29yeSBVdGlsaXR5XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBzaG93SGVscCgpOiBQcm9taXNlPEJhc2VWaWV3ZXI+IHtcbiAgICAgICAgYXdhaXQgU2V0dGluZ3Muc2V0KFNldHRpbmdzLlNFVFRJTkdTX0tFWS5IRUxQX1NFRU4sIHRydWUpO1xuXG4gICAgICAgIGNvbnN0IGxhbmcgPSBnYW1lLmkxOG4ubGFuZztcbiAgICAgICAgbGV0IG1hbnVhbFBhdGggPSBnZXRBYnNvbHV0ZVVSTChgJHtTZXR0aW5ncy5QQVRIX0FTU0VUU30vbWFudWFsLyR7bGFuZ30vbWFudWFsLnBkZmApO1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IG1hbnVhbEV4aXN0cyA9IGF3YWl0IHNyY0V4aXN0cyhtYW51YWxQYXRoKTtcblxuICAgICAgICBpZiAoIW1hbnVhbEV4aXN0cykge1xuICAgICAgICAgICAgbWFudWFsUGF0aCA9IGdldEFic29sdXRlVVJMKGAke1NldHRpbmdzLlBBVEhfQVNTRVRTfS9tYW51YWwvZW4vbWFudWFsLnBkZmApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGRmRGF0YTogUERGRGF0YSA9IHtcbiAgICAgICAgICAgIG5hbWU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLk1BTlVBTC5OYW1lJyksXG4gICAgICAgICAgICB0eXBlOiBQREZUeXBlLlN0YXRpYyxcbiAgICAgICAgICAgIGNvZGU6ICcnLFxuICAgICAgICAgICAgb2Zmc2V0OiAwLFxuICAgICAgICAgICAgdXJsOiBtYW51YWxQYXRoLFxuICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBBcGkub3BlblBERihwZGZEYXRhKTtcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFNldHVwIGZyb20gJy4vU2V0dXAnO1xuXG5TZXR1cC5ydW4oKTtcbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBBcGkgZnJvbSAnLi9BcGknO1xuXG4vKipcbiAqIEludGVybmFsIHNldHRpbmdzIGFuZCBoZWxwZXIgbWV0aG9kcyBmb3IgUERGb3VuZHJ5LlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldHRpbmdzIHtcbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IE1PRFVMRV9OQU1FOiBzdHJpbmcgPSAncGRmb3VuZHJ5JztcblxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0IFBBVEhfTU9EVUxFKCkge1xuICAgICAgICByZXR1cm4gYG1vZHVsZXMvJHtTZXR0aW5ncy5NT0RVTEVfTkFNRX1gO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGdldCBQQVRIX0FTU0VUUygpIHtcbiAgICAgICAgcmV0dXJuIGAke1NldHRpbmdzLlBBVEhfTU9EVUxFfS9hc3NldHNgO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGdldCBQQVRIX0xPQ0FMRSgpIHtcbiAgICAgICAgcmV0dXJuIGAke1NldHRpbmdzLlBBVEhfTU9EVUxFfS9sb2NhbGVgO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGdldCBQQVRIX1RFTVBMQVRFUygpIHtcbiAgICAgICAgcmV0dXJuIGAke1NldHRpbmdzLlBBVEhfTU9EVUxFfS90ZW1wbGF0ZXNgO1xuICAgIH1cbiAgICBwdWJsaWMgc3RhdGljIGdldCBQQVRIX1BERkpTKCkge1xuICAgICAgICByZXR1cm4gYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3BkZmpzYDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGdldCBTT0NLRVRfTkFNRSgpIHtcbiAgICAgICAgcmV0dXJuIGBtb2R1bGUuJHtTZXR0aW5ncy5NT0RVTEVfTkFNRX1gO1xuICAgIH1cblxuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgQ1NTX0NMQVNTID0gJ3BkZi1hcHAnO1xuXG4gICAgcHVibGljIHN0YXRpYyByZWFkb25seSBNRU5VX0tFWSA9ICdQREZvdW5kcnlTZXR0aW5ncyc7XG5cbiAgICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFNFVFRJTkdTX0tFWSA9IHtcbiAgICAgICAgRVhJU1RJTkdfVklFV0VSOiAnU2hvd0luRXhpc3RpbmdWaWV3ZXInLFxuICAgICAgICBDQUNIRV9TSVpFOiAnQ2FjaGVTaXplJyxcbiAgICAgICAgVklFV0VSX1RIRU1FOiAnVmlld2VyVGhlbWUnLFxuICAgICAgICBIRUxQX1NFRU46ICdIZWxwU2VlbicsXG4gICAgICAgIERBVEFfVkVSU0lPTjogJ0RhdGFWZXJzaW9uJyxcbiAgICB9O1xuICAgIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgRkxBR1NfS0VZID0ge1xuICAgICAgICAvLyBQREYgRGF0YVxuICAgICAgICBQREZfREFUQTogJ1BERkRhdGEnLFxuICAgICAgICAvLyBBY3RvciBTaGVldHNcbiAgICAgICAgRk9STV9EQVRBOiAnRm9ybURhdGEnLFxuICAgICAgICBTSEVFVF9JRDogJ0FjdG9yU2hlZXQnLFxuICAgICAgICAvLyBDYW52YXMgTm90ZXNcbiAgICAgICAgUEFHRV9OVU1CRVI6ICdQYWdlTnVtYmVyJyxcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBpbml0aWFsaXplKCkge1xuICAgICAgICBTZXR0aW5ncy5yZWdpc3RlcihTZXR0aW5ncy5TRVRUSU5HU19LRVkuQ0FDSEVfU0laRSwge1xuICAgICAgICAgICAgbmFtZTogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuQ2FjaGVTaXplTmFtZScpLFxuICAgICAgICAgICAgaGludDogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuQ2FjaGVTaXplSGludCcpLFxuICAgICAgICAgICAgc2NvcGU6ICd1c2VyJyxcbiAgICAgICAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgICAgICAgIGRlZmF1bHQ6IDI1NixcbiAgICAgICAgICAgIGNvbmZpZzogdHJ1ZSxcbiAgICAgICAgICAgIG9uQ2hhbmdlOiBhc3luYyAobWIpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoU2V0dGluZ3MuZ2V0KFNldHRpbmdzLlNFVFRJTkdTX0tFWS5DQUNIRV9TSVpFKSA9PT0gbWIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1iID0gTWF0aC5yb3VuZChtYik7XG4gICAgICAgICAgICAgICAgbWIgPSBNYXRoLm1heChtYiwgNjQpO1xuICAgICAgICAgICAgICAgIG1iID0gTWF0aC5taW4obWIsIDEwMjQpO1xuICAgICAgICAgICAgICAgIGF3YWl0IFNldHRpbmdzLnNldChTZXR0aW5ncy5TRVRUSU5HU19LRVkuQ0FDSEVfU0laRSwgbWIpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3MucmVnaXN0ZXIoU2V0dGluZ3MuU0VUVElOR1NfS0VZLkVYSVNUSU5HX1ZJRVdFUiwge1xuICAgICAgICAgICAgbmFtZTogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuU2hvd0luRXhpc3RpbmdWaWV3ZXJOYW1lJyksXG4gICAgICAgICAgICBoaW50OiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5TRVRUSU5HUy5TaG93SW5FeGlzdGluZ1ZpZXdlckhpbnQnKSxcbiAgICAgICAgICAgIHNjb3BlOiAndXNlcicsXG4gICAgICAgICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZzogdHJ1ZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3MucmVnaXN0ZXIoU2V0dGluZ3MuU0VUVElOR1NfS0VZLlZJRVdFUl9USEVNRSwge1xuICAgICAgICAgICAgbmFtZTogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuU0VUVElOR1MuVmlld2VyVGhlbWVOYW1lJyksXG4gICAgICAgICAgICBoaW50OiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5TRVRUSU5HUy5WaWV3ZXJUaGVtZUhpbnQnKSxcbiAgICAgICAgICAgIHNjb3BlOiAndXNlcicsXG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0OiAnZmFudGFzeScsXG4gICAgICAgICAgICBjaG9pY2VzOiBBcGkuYXZhaWxhYmxlVGhlbWVzLFxuICAgICAgICAgICAgY29uZmlnOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICBTZXR0aW5ncy5yZWdpc3RlcihTZXR0aW5ncy5TRVRUSU5HU19LRVkuSEVMUF9TRUVOLCB7XG4gICAgICAgICAgICBzY29wZTogJ3VzZXInLFxuICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgY29uZmlnOiBmYWxzZSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgU2V0dGluZ3MucmVnaXN0ZXIoU2V0dGluZ3MuU0VUVElOR1NfS0VZLkRBVEFfVkVSU0lPTiwge1xuICAgICAgICAgICAgc2NvcGU6ICd3b3JsZCcsXG4gICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICBjb25maWc6IGZhbHNlLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcGVyIGFyb3VuZCBnYW1lLnNldHRpbmdzLnJlZ2lzdGVyLiBFbnN1cmVzIHNjb3BlIGlzIGNvcnJlY3QuXG4gICAgICogQHBhcmFtIGtleVxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyByZWdpc3RlcihrZXk6IHN0cmluZywgZGF0YTogYW55KSB7XG4gICAgICAgIGdhbWUuc2V0dGluZ3MucmVnaXN0ZXIoU2V0dGluZ3MuTU9EVUxFX05BTUUsIGtleSwgZGF0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV3JhcHBlciBhcm91bmQgZ2FtZS5zZXR0aW5ncy5nZXQuIEVuc3VyZXMgc2NvcGUgaXMgY29ycmVjdC5cbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXQoa2V5OiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGdhbWUuc2V0dGluZ3MuZ2V0KFNldHRpbmdzLk1PRFVMRV9OQU1FLCBrZXkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdyYXBwZXIgYXJvdW5kIGdhbWUuc2V0dGluZ3Muc2V0LiBFbnN1cmVzIHNjb3BlIGlzIGNvcnJlY3QuXG4gICAgICogQHBhcmFtIGtleVxuICAgICAqIEBwYXJhbSB2YWx1ZVxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgc2V0KGtleTogc3RyaW5nLCB2YWx1ZTogYW55KSB7XG4gICAgICAgIHJldHVybiBnYW1lLnNldHRpbmdzLnNldChTZXR0aW5ncy5NT0RVTEVfTkFNRSwga2V5LCB2YWx1ZSk7XG4gICAgfVxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgZ2V0QWJzb2x1dGVVUkwsIGdldFBERkRhdGEsIGlzRW50aXR5UERGIH0gZnJvbSAnLi9VdGlsJztcbmltcG9ydCBQcmVsb2FkRXZlbnQgZnJvbSAnLi9zb2NrZXQvZXZlbnRzL1ByZWxvYWRFdmVudCc7XG5pbXBvcnQgeyBTb2NrZXQgfSBmcm9tICcuL3NvY2tldC9Tb2NrZXQnO1xuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4vU2V0dGluZ3MnO1xuaW1wb3J0IFBERkNhY2hlIGZyb20gJy4vY2FjaGUvUERGQ2FjaGUnO1xuaW1wb3J0IEFwaSwgeyBWaWV3ZXJUaGVtZSB9IGZyb20gJy4vQXBpJztcbmltcG9ydCBIVE1MRW5yaWNoZXIgZnJvbSAnLi9lbnJpY2hlci9IVE1MRW5yaWNoZXInO1xuaW1wb3J0IFRpbnlNQ0VQbHVnaW4gZnJvbSAnLi9lbnJpY2hlci9UaW55TUNFUGx1Z2luJztcbmltcG9ydCBQREZBY3RvclNoZWV0QWRhcHRlciBmcm9tICcuL2FwcC9QREZBY3RvclNoZWV0QWRhcHRlcic7XG5pbXBvcnQgeyBQREZUeXBlIH0gZnJvbSAnLi9jb21tb24vdHlwZXMvUERGVHlwZSc7XG5pbXBvcnQgeyBQREZDb25maWcgfSBmcm9tICcuL2FwcC9QREZDb25maWcnO1xuaW1wb3J0IEZpeE1pc3NpbmdUeXBlcyBmcm9tICcuL2NvbW1hbmRzL0ZpeE1pc3NpbmdUeXBlcyc7XG5pbXBvcnQgUHVyZ2VDYWNoZSBmcm9tICcuL2NvbW1hbmRzL1B1cmdlQ2FjaGUnO1xuaW1wb3J0IHsgbGVnYWN5TWlncmF0aW9uUmVxdWlyZWQsIG1pZ3JhdGVMZWdhY3kgfSBmcm9tICcuL21pZ3JhdGUvTWlncmF0ZUxlZ2FjeSc7XG5cbi8qKlxuICogQSBjb2xsZWN0aW9uIG9mIG1ldGhvZHMgdXNlZCBmb3Igc2V0dGluZyB1cCB0aGUgQVBJICYgc3lzdGVtIHN0YXRlLlxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNldHVwIHtcbiAgICAvKipcbiAgICAgKiBSdW4gc2V0dXAgdGFza3MuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBydW4oKSB7XG4gICAgICAgIGlmIChoYXNQcm9wZXJ0eSh1aSwgJ1BERm91bmRyeScpKSB7XG4gICAgICAgICAgICBIb29rcy5vbmNlKCdpbml0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBkID0gbmV3IERpYWxvZyh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnUERGb3VuZHJ5OiBFcnJvcicsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICc8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjoganVzdGlmeTsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwO1wiPicsXG4gICAgICAgICAgICAgICAgICAgICAgICAnPGgxIHN0eWxlPVwiY29sb3I6IHJlZFwiPlBERm91bmRyeSBJcyBBbHJlYWR5IEluc3RhbGxlZDwvaDE+JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICc8cCBzdHlsZT1cImZvbnQtd2VpZ2h0OiBib2xkXCI+WW91IGhhdmUgZW5hYmxlZCB0aGUgbW9kdWxlIHZlcnNpb24gb2YgUERGb3VuZHJ5LCBidXQgdGhlIHN5c3RlbSB5b3UgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2FyZSB1c2luZyBhbHJlYWR5IGhhcyBQREZvdW5kcnkgaW5zdGFsbGVkLjwvcD4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxwPjEuIElmIHlvdSBpbnN0YWxsZWQgUERGb3VuZHJ5IHVzaW5nIGEgbmlnaHRseSBidWlsZCwgdW5pbnN0YWxsIGFuZCByZWluc3RhbGwgeW91ciBzeXN0ZW0gd2l0aCB0aGUgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1wiR2FtZSBTeXN0ZW1zXCIgbWVudSBpbiBGb3VuZHJ5IFZUVCBzZXR1cCwgb3Igc2ltcGx5IHVwZGF0ZSB0aGUgc3lzdGVtIGlmIGFuIHVwZGF0ZSBpcyBhdmFpbGFibGUuICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdZb3VyIHdvcmxkIGRhdGEgaXMgc2FmZSBlaXRoZXIgd2F5LjwvcD4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxwPjIuIElmIHRoZSBzeXN0ZW0geW91IGFyZSB1c2luZyBjb21lcyB3aXRoIFBERm91bmRyeSBhbHJlYWR5IGluc3RhbGxlZCAtIHlvdSBtdXN0IHVzZSB0aGF0IHZlcnNpb24gb2YgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1BERm91bmRyeSBieSBkaXNhYmxpbmcgdGhlIG1vZHVsZSB2ZXJzaW9uLjwvcD4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzxwIHN0eWxlPVwiZm9udC13ZWlnaHQ6IGJvbGRcIj5UaGUgbW9kdWxlIHZlcnNpb24gb2YgUERGb3VuZHJ5IHdpbGwgbm90IGZ1bmN0aW9uLjwvcD4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJzwvZGl2PicsXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbignJyksXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbnM6IHt9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGQucmVuZGVyKHRydWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSZWdpc3RlciB0aGUgUERGb3VuZHJ5IEFQaSBvbiB0aGUgVUlcbiAgICAgICAgdWlbJ1BERm91bmRyeSddID0gQXBpO1xuXG4gICAgICAgIC8vIFJlZ2lzdGVyIHRoZSBQREYgc2hlZXQgd2l0aCB0aGUgY2xhc3MgcGlja2VyXG4gICAgICAgIFNldHVwLnNldHVwU2hlZXRzKCk7XG5cbiAgICAgICAgLy8gU2V0dXAgdGFza3MgcmVxdWlyaW5nIHRoYXQgRlZUVCBpcyBsb2FkZWRcbiAgICAgICAgSG9va3Mub25jZSgncmVhZHknLCBTZXR1cC5sYXRlUnVuKTtcblxuICAgICAgICBIb29rcy5vbigncmVuZGVySm91cm5hbERpcmVjdG9yeScsIFNldHVwLmNyZWF0ZUpvdXJuYWxCdXR0b24pO1xuICAgICAgICBIb29rcy5vbigncmVuZGVySm91cm5hbERpcmVjdG9yeScsIFNldHVwLmhvb2tMaXN0SXRlbXMpO1xuXG4gICAgICAgIC8vIGdldEl0ZW1EaXJlY3RvcnlFbnRyeUNvbnRleHQgLSBTZXR1cCBjb250ZXh0IG1lbnUgZm9yICdPcGVuIFBERicgbGlua3NcbiAgICAgICAgSG9va3Mub24oJ2dldEpvdXJuYWxEaXJlY3RvcnlFbnRyeUNvbnRleHQnLCBTZXR1cC5nZXRKb3VybmFsQ29udGV4dE9wdGlvbnMpO1xuXG4gICAgICAgIC8vIENvZ3doZWVsIHNldHRpbmdzIG1lbnVcbiAgICAgICAgSG9va3Mub24oJ3JlbmRlclNldHRpbmdzJywgU2V0dXAub25SZW5kZXJTZXR0aW5ncyk7XG5cbiAgICAgICAgLy8gTG9hZCBiYXNlIHRoZW1lc1xuICAgICAgICBTZXR1cC5yZWdpc3RlclRoZW1lcygpO1xuXG4gICAgICAgIC8vIFBhdGNoIHRoZSBUZXh0RW5yaWNoZXIgd2l0aCBhIHByb3h5XG4gICAgICAgIEhUTUxFbnJpY2hlci5wYXRjaEVucmljaCgpO1xuICAgICAgICAvLyBCaW5kIGNsaWNrIGhhbmRsZXJzIHRvIHJlbmRlcmVyc1xuICAgICAgICBIb29rcy5vbigncmVuZGVyQXBwbGljYXRpb24nLCAoYXBwOiBBcHBsaWNhdGlvbiwgaHRtbDogSlF1ZXJ5KSA9PiBIVE1MRW5yaWNoZXIuYmluZFJpY2hUZXh0TGlua3MoaHRtbCkpO1xuICAgICAgICBIb29rcy5vbigncmVuZGVySXRlbVNoZWV0JywgKGFwcDogQXBwbGljYXRpb24sIGh0bWw6IEpRdWVyeSkgPT4gSFRNTEVucmljaGVyLmJpbmRSaWNoVGV4dExpbmtzKGh0bWwpKTtcbiAgICAgICAgSG9va3Mub24oJ3JlbmRlckFjdG9yU2hlZXQnLCAoYXBwOiBBcHBsaWNhdGlvbiwgaHRtbDogSlF1ZXJ5KSA9PiBIVE1MRW5yaWNoZXIuYmluZFJpY2hUZXh0TGlua3MoaHRtbCkpO1xuICAgICAgICBIb29rcy5vbigncmVuZGVyQ2hhdE1lc3NhZ2UnLCAoYXBwOiBBcHBsaWNhdGlvbiwgaHRtbDogSlF1ZXJ5KSA9PiBIVE1MRW5yaWNoZXIuYmluZFJpY2hUZXh0TGlua3MoaHRtbCkpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IENPTU1BTkRTID0gW25ldyBGaXhNaXNzaW5nVHlwZXMoKSwgbmV3IFB1cmdlQ2FjaGUoKV07XG5cbiAgICAvKipcbiAgICAgKiBMYXRlIHNldHVwIHRhc2tzIGhhcHBlbiB3aGVuIHRoZSBzeXN0ZW0gaXMgbG9hZGVkXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBsYXRlUnVuKCkge1xuICAgICAgICAvLyBSZWdpc3RlciBzb2NrZXQgZXZlbnQgaGFuZGxlcnNcbiAgICAgICAgU29ja2V0LmluaXRpYWxpemUoKTtcblxuICAgICAgICAvLyBDaGF0IGNvbW1hbmQgcHJvY2Vzc2luZ1xuICAgICAgICBIb29rcy5vbignY2hhdE1lc3NhZ2UnLCBTZXR1cC5vbkNoYXRNZXNzYWdlKTtcblxuICAgICAgICAvLyBDYW52YXMgbm90ZXMgcHJvY2Vzc2luZ1xuICAgICAgICBIb29rcy5vbigncmVuZGVyTm90ZUNvbmZpZycsIFNldHVwLm9uTm90ZUNvbmZpZyk7XG4gICAgICAgIEhvb2tzLm9uKCdob3Zlck5vdGUnLCBTZXR1cC5vbk5vdGVIb3Zlcik7XG5cbiAgICAgICAgLy8gUmVnaXN0ZXIgVGlueU1DRSBkcmFnICsgZHJvcCBldmVudHNcbiAgICAgICAgVGlueU1DRVBsdWdpbi5SZWdpc3RlcigpO1xuXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBJbml0aWFsaXplIHRoZSBzZXR0aW5nc1xuICAgICAgICAgICAgU2V0dGluZ3MuaW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgYXdhaXQgUERGQ2FjaGUuaW5pdGlhbGl6ZSgpO1xuXG4gICAgICAgICAgICBpZiAobGVnYWN5TWlncmF0aW9uUmVxdWlyZWQoKSkge1xuICAgICAgICAgICAgICAgIG1pZ3JhdGVMZWdhY3koKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgU2V0dGluZ3Muc2V0KFNldHRpbmdzLlNFVFRJTkdTX0tFWS5EQVRBX1ZFUlNJT04sICd2MC42LjAnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gUERGb3VuZHJ5IGlzIHJlYWR5XG4gICAgICAgICAgICBTZXR1cC51c2VyTG9naW4oKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXIgdGhlIFBERiBzaGVldCBhbmQgdW5yZWdpc3RlciBpbnZhbGlkIHNoZWV0IHR5cGVzIGZyb20gaXQuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBzZXR1cFNoZWV0cygpIHtcbiAgICAgICAgLy8gUmVnaXN0ZXIgYWN0b3IgXCJzaGVldFwiXG4gICAgICAgIEFjdG9ycy5yZWdpc3RlclNoZWV0KFNldHRpbmdzLk1PRFVMRV9OQU1FLCBQREZBY3RvclNoZWV0QWRhcHRlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGFkZGl0aW9uYWwgY29udGV4dCBtZW51IGljb25zIGZvciBQREYgaXRlbXNcbiAgICAgKiBAcGFyYW0gaHRtbFxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBnZXRKb3VybmFsQ29udGV4dE9wdGlvbnMoaHRtbDogSlF1ZXJ5LCBvcHRpb25zOiBhbnlbXSkge1xuICAgICAgICBjb25zdCBnZXRKb3VybmFsRW50cnlGcm9tTGkgPSAoaHRtbDogSlF1ZXJ5KTogSm91cm5hbEVudHJ5ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gaHRtbC5kYXRhKCdlbnRpdHktaWQnKTtcbiAgICAgICAgICAgIHJldHVybiBnYW1lLmpvdXJuYWwuZ2V0KGlkKTtcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBzaG91bGRBZGQgPSAoZW50aXR5SHRtbDogSlF1ZXJ5KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBqb3VybmFsRW50cnkgPSBnZXRKb3VybmFsRW50cnlGcm9tTGkoZW50aXR5SHRtbCk7XG4gICAgICAgICAgICByZXR1cm4gaXNFbnRpdHlQREYoam91cm5hbEVudHJ5KSAmJiBnZXRQREZEYXRhKGpvdXJuYWxFbnRyeSk/LnR5cGUgIT09IFBERlR5cGUuQWN0b3I7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGdhbWUudXNlci5pc0dNKSB7XG4gICAgICAgICAgICBvcHRpb25zLnVuc2hpZnQoe1xuICAgICAgICAgICAgICAgIG5hbWU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLkNPTlRFWFQuUHJlbG9hZFBERicpLFxuICAgICAgICAgICAgICAgIGljb246ICc8aSBjbGFzcz1cImZhcyBmYS1kb3dubG9hZCBmYS1md1wiPjwvaT4nLFxuICAgICAgICAgICAgICAgIGNvbmRpdGlvbjogc2hvdWxkQWRkLFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoZW50aXR5SHRtbDogSlF1ZXJ5KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGpvdXJuYWxFbnRyeSA9IGdldEpvdXJuYWxFbnRyeUZyb21MaShlbnRpdHlIdG1sKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGRmID0gZ2V0UERGRGF0YShqb3VybmFsRW50cnkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwZGYgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyB1cmwgfSA9IHBkZjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBuZXcgUHJlbG9hZEV2ZW50KG51bGwsIGdldEFic29sdXRlVVJMKHVybCkpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5lbWl0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgUERGQ2FjaGUucHJlbG9hZCh1cmwpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG9wdGlvbnMudW5zaGlmdCh7XG4gICAgICAgICAgICBuYW1lOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5DT05URVhULk9wZW5QREYnKSxcbiAgICAgICAgICAgIGljb246ICc8aSBjbGFzcz1cImZhciBmYS1maWxlLXBkZlwiPjwvaT4nLFxuICAgICAgICAgICAgY29uZGl0aW9uOiBzaG91bGRBZGQsXG4gICAgICAgICAgICBjYWxsYmFjazogKGVudGl0eUh0bWw6IEpRdWVyeSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGpvdXJuYWxFbnRyeSA9IGdldEpvdXJuYWxFbnRyeUZyb21MaShlbnRpdHlIdG1sKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwZGYgPSBnZXRQREZEYXRhKGpvdXJuYWxFbnRyeSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGRmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChwZGYudHlwZSA9PT0gUERGVHlwZS5BY3Rvcikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCBQREYgY29udGV4dCB0eXBlICR7cGRmLnR5cGV9YCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgQXBpLm9wZW5QREYocGRmLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbnRpdHk6IGpvdXJuYWxFbnRyeSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgdXNlckxvZ2luKCkge1xuICAgICAgICBpZiAoIWdhbWUudXNlci5pc0dNKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdmlld2VkO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmlld2VkID0gU2V0dGluZ3MuZ2V0KFNldHRpbmdzLlNFVFRJTkdTX0tFWS5IRUxQX1NFRU4pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdmlld2VkID0gZmFsc2U7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBpZiAoIXZpZXdlZCkge1xuICAgICAgICAgICAgICAgIEFwaS5zaG93SGVscCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgb25DaGF0TWVzc2FnZShhcHAsIGNvbnRlbnQ6IHN0cmluZywgb3B0aW9ucykge1xuICAgICAgICBjb250ZW50ID0gY29udGVudC50b0xvY2FsZUxvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGZvciAobGV0IGNvbW1hbmQgb2YgU2V0dXAuQ09NTUFORFMpIHtcbiAgICAgICAgICAgIGlmIChjb21tYW5kLmV4ZWN1dGUoY29udGVudCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSG9vayBoYW5kbGVyIGZvciByZW5kZXJpbmcgdGhlIHNldHRpbmdzIHRhYlxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgb25SZW5kZXJTZXR0aW5ncyhzZXR0aW5nczogYW55LCBodG1sOiBKUXVlcnksIGRhdGE6IGFueSkge1xuICAgICAgICBjb25zdCBpY29uID0gJzxpIGNsYXNzPVwiZmFyIGZhLWZpbGUtcGRmXCI+PC9pPic7XG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9ICQoYDxidXR0b24+JHtpY29ufSAke2dhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlNFVFRJTkdTLk9wZW5IZWxwJyl9PC9idXR0b24+YCk7XG4gICAgICAgIGJ1dHRvbi5vbignY2xpY2snLCBBcGkuc2hvd0hlbHApO1xuXG4gICAgICAgIGh0bWwuZmluZCgnI3NldHRpbmdzLWRvY3VtZW50YXRpb24nKS5hcHBlbmQoYnV0dG9uKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBhc3luYyBjcmVhdGVQREYoKSB7XG4gICAgICAgIGNvbnN0IGpvdXJuYWxFbnRyeSA9IChhd2FpdCBKb3VybmFsRW50cnkuY3JlYXRlKHtcbiAgICAgICAgICAgIG5hbWU6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLk1JU0MuTmV3UERGJyksXG4gICAgICAgICAgICBbYGZsYWdzLiR7U2V0dGluZ3MuTU9EVUxFX05BTUV9LiR7U2V0dGluZ3MuRkxBR1NfS0VZLlBERl9EQVRBfS50eXBlYF06IFBERlR5cGUuU3RhdGljLFxuICAgICAgICB9KSkgYXMgSm91cm5hbEVudHJ5O1xuXG4gICAgICAgIG5ldyBQREZDb25maWcoam91cm5hbEVudHJ5KS5yZW5kZXIodHJ1ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSm91cm5hbEJ1dHRvbihhcHA6IEFwcGxpY2F0aW9uLCBodG1sOiBKUXVlcnkpIHtcbiAgICAgICAgaWYgKCFnYW1lLnVzZXIuaXNHTSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gJChgPGJ1dHRvbiBjbGFzcz1cImNyZWF0ZS1wZGZcIj48aSBjbGFzcz1cImZhcyBmYS1maWxlLXBkZlwiPjwvaT4gJHtnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5NSVNDLkNyZWF0ZVBERicpfTwvYnV0dG9uPmApO1xuICAgICAgICBidXR0b24ub24oJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgU2V0dXAuY3JlYXRlUERGKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBmb290ZXIgPSBodG1sLmZpbmQoJy5kaXJlY3RvcnktZm9vdGVyJyk7XG4gICAgICAgIGlmIChmb290ZXIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBmb290ZXIgPSAkKGA8Zm9vdGVyIGNsYXNzPVwiZGlyZWN0b3J5LWZvb3RlclwiPjwvZm9vdGVyPmApO1xuICAgICAgICAgICAgaHRtbC5hcHBlbmQoZm9vdGVyKTtcbiAgICAgICAgfVxuICAgICAgICBmb290ZXIuYXBwZW5kKGJ1dHRvbik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgaG9va0xpc3RJdGVtcyhhcHA6IEFwcGxpY2F0aW9uLCBodG1sOiBKUXVlcnkpIHtcbiAgICAgICAgY29uc3QgbGlzID0gaHRtbC5maW5kKCdsaS5qb3VybmFsJyk7XG5cbiAgICAgICAgZm9yIChjb25zdCBsaSBvZiBsaXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9ICQobGkpO1xuICAgICAgICAgICAgY29uc3QgaWQgPSB0YXJnZXQuZGF0YSgnZW50aXR5LWlkJyk7XG4gICAgICAgICAgICBjb25zdCBqb3VybmFsRW50cnkgPSBnYW1lLmpvdXJuYWwuZ2V0KGlkKTtcblxuICAgICAgICAgICAgaWYgKGlzRW50aXR5UERGKGpvdXJuYWxFbnRyeSkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnaDQnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGpvdXJuYWxFbnRyeS5pc093bmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBTZXR1cC5vbkNsaWNrUERGTmFtZShqb3VybmFsRW50cnkpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgU2V0dXAub25DbGlja1BERlRodW1ibmFpbChqb3VybmFsRW50cnkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBwZGZEYXRhID0gZ2V0UERGRGF0YShqb3VybmFsRW50cnkpO1xuICAgICAgICAgICAgICAgIGlmIChwZGZEYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRodW1ibmFpbCA9ICQoYDxpbWcgY2xhc3M9XCJwZGYtdGh1bWJuYWlsXCIgc3JjPVwiJHtTZXR0aW5ncy5QQVRIX0FTU0VUU30vcGRmX2ljb24uc3ZnXCIgYWx0PVwiUERGIEljb25cIj5gKTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFwcGVuZCh0aHVtYm5haWwpO1xuXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocGRmRGF0YS50eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFBERlR5cGUuU3RhdGljOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQREZUeXBlLkZpbGxhYmxlOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCdpbWcnKS5vbignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNldHVwLm9uQ2xpY2tQREZUaHVtYm5haWwoam91cm5hbEVudHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgUERGVHlwZS5BY3RvcjpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBY3RvcnMgY2FuJ3QgYmUgb3BlbmVkIGJ5IGxpbmtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWwuY3NzKCdmaWx0ZXInLCAnZ3JheXNjYWxlKDEwMCUpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBvbkNsaWNrUERGTmFtZShqb3VybmFsRW50cnk6IEpvdXJuYWxFbnRyeSkge1xuICAgICAgICBuZXcgUERGQ29uZmlnKGpvdXJuYWxFbnRyeSkucmVuZGVyKHRydWUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIG9uQ2xpY2tQREZUaHVtYm5haWwoam91cm5hbEVudHJ5OiBKb3VybmFsRW50cnkpIHtcbiAgICAgICAgY29uc3QgcGRmRGF0YSA9IGdldFBERkRhdGEoam91cm5hbEVudHJ5KTtcbiAgICAgICAgaWYgKHBkZkRhdGEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocGRmRGF0YS50eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBQREZUeXBlLlN0YXRpYzpcbiAgICAgICAgICAgICAgICAgICAgQXBpLm9wZW5QREYocGRmRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUERGVHlwZS5GaWxsYWJsZTpcbiAgICAgICAgICAgICAgICAgICAgQXBpLm9wZW5QREYocGRmRGF0YSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW50aXR5OiBqb3VybmFsRW50cnksXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFBERlR5cGUuQWN0b3I6XG4gICAgICAgICAgICAgICAgICAgIC8vIFBhc3MgLSBubyBmdW5jdGlvbmFsaXR5XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgb25Ob3RlQ29uZmlnKGFwcDogTm90ZUNvbmZpZywgaHRtbDogSlF1ZXJ5LCBkYXRhOiBhbnkpIHtcbiAgICAgICAgY29uc3Qgam91cm5hbElkID0gZGF0YS5kYXRhLmVudHJ5SWQ7XG4gICAgICAgIGNvbnN0IGpvdXJuYWwgPSBnYW1lLmpvdXJuYWwuZ2V0KGpvdXJuYWxJZCk7XG4gICAgICAgIGlmIChpc0VudGl0eVBERihqb3VybmFsKSkge1xuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gJChgPGRpdiBjbGFzcz1cImZvcm0tZ3JvdXBcIj48L2Rpdj5gKTtcbiAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gJChgPGxhYmVsPiR7Z2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuQ09NTU9OLlBhZ2VOdW1iZXInKX08L2xhYmVsPmApO1xuXG4gICAgICAgICAgICBsZXQgcGFnZU51bWJlciA9IGRhdGEuZGF0YVsnZmxhZ3MnXT8uW1NldHRpbmdzLk1PRFVMRV9OQU1FXT8uW1NldHRpbmdzLkZMQUdTX0tFWS5QQUdFX05VTUJFUl07XG4gICAgICAgICAgICBpZiAocGFnZU51bWJlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcGFnZU51bWJlciA9ICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBzdWJDb250YWluZXIgPSAkKGA8ZGl2IGNsYXNzPVwiZm9ybS1maWVsZHNcIj48L2Rpdj5gKTtcblxuICAgICAgICAgICAgY29uc3QgaW5wdXQgPSAkKFxuICAgICAgICAgICAgICAgIGA8aW5wdXQgdHlwZT1cIm51bWJlclwiIG5hbWU9XCJmbGFncy4ke1NldHRpbmdzLk1PRFVMRV9OQU1FfS4ke1NldHRpbmdzLkZMQUdTX0tFWS5QQUdFX05VTUJFUn1cIiB2YWx1ZT1cIiR7cGFnZU51bWJlcn1cIiBkYXRhLWR0eXBlPVwiU3RyaW5nXCI+YCxcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHN1YkNvbnRhaW5lci5hcHBlbmQoaW5wdXQpO1xuXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kKGxhYmVsKTtcbiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQoc3ViQ29udGFpbmVyKTtcblxuICAgICAgICAgICAgaHRtbC5maW5kKCdidXR0b25bdHlwZT1zdWJtaXRdJykuYmVmb3JlKGNvbnRhaW5lcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBvbk5vdGVIb3Zlcihub3RlOiBOb3RlLCBlbnRlcjogYm9vbGVhbikge1xuICAgICAgICBpZiAoIWVudGVyKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBqb3VybmFsID0gbm90ZS5lbnRyeSBhcyBKb3VybmFsRW50cnk7XG4gICAgICAgIGNvbnN0IHBkZiA9IGdldFBERkRhdGEoam91cm5hbCk7XG4gICAgICAgIGlmIChpc0VudGl0eVBERihqb3VybmFsKSAmJiBwZGYpIHtcbiAgICAgICAgICAgIG5vdGUubW91c2VJbnRlcmFjdGlvbk1hbmFnZXIuY2FsbGJhY2tzWydjbGlja0xlZnQyJ10gPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHBhZ2VUZXh0OiBzdHJpbmcgfCBudW1iZXIgfCB1bmRlZmluZWQgPSBub3RlLmRhdGEuZmxhZ3M/LltTZXR0aW5ncy5NT0RVTEVfTkFNRV0/LltTZXR0aW5ncy5GTEFHU19LRVkuUEFHRV9OVU1CRVJdO1xuICAgICAgICAgICAgICAgIGxldCBwYWdlTnVtYmVyID0gMDtcblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcGFnZVRleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlTnVtYmVyID0gcGFyc2VJbnQocGFnZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlTnVtYmVyID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHBhZ2VUZXh0ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICBwYWdlTnVtYmVyID0gcGFnZVRleHQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHBhZ2VOdW1iZXIgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgQXBpLm9wZW5QREYocGRmKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBBcGkub3BlblBERihwZGYsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2VOdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyByZWdpc3RlclRoZW1lcygpIHtcbiAgICAgICAgY29uc3QgdGhlbWVzOiBWaWV3ZXJUaGVtZVtdID0gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnZmFudGFzeScsXG4gICAgICAgICAgICAgICAgbmFtZTogJ0ZhbnRhc3kgKERlZmF1bHQpJyxcbiAgICAgICAgICAgICAgICBmaWxlUGF0aDogYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3RoZW1lcy9mYW50YXN5LmNzc2AsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnZGFyaycsXG4gICAgICAgICAgICAgICAgbmFtZTogJ0RhcmsnLFxuICAgICAgICAgICAgICAgIGZpbGVQYXRoOiBgJHtTZXR0aW5ncy5QQVRIX01PRFVMRX0vdGhlbWVzL2RlZmF1bHQtZGFyay5jc3NgLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ2xpZ2h0JyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTGlnaHQnLFxuICAgICAgICAgICAgICAgIGZpbGVQYXRoOiBgJHtTZXR0aW5ncy5QQVRIX01PRFVMRX0vdGhlbWVzL2RlZmF1bHQtbGlnaHQuY3NzYCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICduZXQtcnVubmVyLWRhcmsnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdOZXQgUnVubmVyJyxcbiAgICAgICAgICAgICAgICBmaWxlUGF0aDogYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3RoZW1lcy9uZXQtcnVubmVyLmNzc2AsXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdnYXktcHJpZGUtbGlnaHQnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdHYXkgUHJpZGUgKExpZ2h0KScsXG4gICAgICAgICAgICAgICAgZmlsZVBhdGg6IGAke1NldHRpbmdzLlBBVEhfTU9EVUxFfS90aGVtZXMvZ2F5LXByaWRlLWxpZ2h0LmNzc2AsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnZ2F5LXByaWRlLWRhcmsnLFxuICAgICAgICAgICAgICAgIG5hbWU6ICdHYXkgUHJpZGUgKERhcmspJyxcbiAgICAgICAgICAgICAgICBmaWxlUGF0aDogYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3RoZW1lcy9nYXktcHJpZGUtZGFyay5jc3NgLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZDogJ3RyYW5zLWxpZ2h0JyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnVHJhbnMgUHJpZGUgKExpZ2h0KScsXG4gICAgICAgICAgICAgICAgZmlsZVBhdGg6IGAke1NldHRpbmdzLlBBVEhfTU9EVUxFfS90aGVtZXMvdHJhbnMtcHJpZGUtbGlnaHQuY3NzYCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICd0cmFucy1kYXJrJyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnVHJhbnMgUHJpZGUgKERhcmspJyxcbiAgICAgICAgICAgICAgICBmaWxlUGF0aDogYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3RoZW1lcy90cmFucy1wcmlkZS1kYXJrLmNzc2AsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlkOiAnbm9uYmluYXJ5LWxpZ2h0JyxcbiAgICAgICAgICAgICAgICBuYW1lOiAnTm9uLWJpbmFyeSBQcmlkZSAoTGlnaHQpJyxcbiAgICAgICAgICAgICAgICBmaWxlUGF0aDogYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3RoZW1lcy9ub25iaW5hcnktcHJpZGUtbGlnaHQuY3NzYCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdub25iaW5hcnktZGFyaycsXG4gICAgICAgICAgICAgICAgbmFtZTogJ05vbi1iaW5hcnkgUHJpZGUgKERhcmspJyxcbiAgICAgICAgICAgICAgICBmaWxlUGF0aDogYCR7U2V0dGluZ3MuUEFUSF9NT0RVTEV9L3RoZW1lcy9ub25iaW5hcnktcHJpZGUtZGFyay5jc3NgLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXTtcblxuICAgICAgICBmb3IgKGNvbnN0IHRoZW1lIG9mIHRoZW1lcykge1xuICAgICAgICAgICAgQXBpLnJlZ2lzdGVyVGhlbWUodGhlbWUuaWQsIHRoZW1lLm5hbWUsIHRoZW1lLmZpbGVQYXRoKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQSBjb2xsZWN0aW9uIG9mIHV0aWxpdGllcyB0aGF0IGFyZSB1c2VkIGludGVybmFsbHkgb3IgbWFkZSB0byBiZSB1c2VkIGV4dGVybmFsbHkgYnkgeW91LlxuICpcbiAqIFlvdSBjYW4gYWNjZXNzIHRoZXNlIHV0aWxpdGllcyB3aXRoIGB1aS5QREZvdW5kcnkuVXRpbGl0aWVzYC5cbiAqIEBtb2R1bGVkZWZpbml0aW9uIFV0aWxpdGllc1xuICovXG5cbmltcG9ydCB7IFBERkRhdGEsIFBERkRhdGFEZWxldGUsIFBERkRhdGFVcGRhdGUgfSBmcm9tICcuL2NvbW1vbi90eXBlcy9QREZEYXRhJztcbmltcG9ydCBTZXR0aW5ncyBmcm9tICcuL1NldHRpbmdzJztcbmltcG9ydCB7IFBERlR5cGUgfSBmcm9tICcuL2NvbW1vbi90eXBlcy9QREZUeXBlJztcbmltcG9ydCB7IERPTUFJTl9XSElURUxJU1QgfSBmcm9tICcuL2NvbW1vbi9XaGl0ZWxpc3QnO1xuXG4vLyAqKioqKioqKioqKioqXG4vLyBVUkwgSEVMUEVSU1xuLy8gKioqKioqKioqKioqKlxuLy8gPGVkaXRvci1mb2xkIGRlc2M9J1VSTCBIZWxwZXJzXCI+XG5cbi8qKlxuICogR2V0cyB0aGUgY29ycmVjdCByb3V0ZSBwcmVmaXggdXNlZCB0byBzdXBwb3J0IHNlcnZlcnMgdXNpbmcgYSByb3V0ZSBwcmVmaXguXG4gKiBBcHBlbmRlZCB0byBhbGwgd2luZG93LmxvY2F0aW9uIHBhdGhzLlxuICogQG1vZHVsZSBVdGlsaXRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFJvdXRlUHJlZml4KCk6IHN0cmluZyB7XG4gICAgbGV0IHByZWZpeEFyciA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5zcGxpdCgnLycpO1xuICAgIHByZWZpeEFyci5wb3AoKTsgLy8gZG9uJ3Qgd2FudCB0aGUgJ2dhbWUnIGF0IHRoZSBlbmRcbiAgICByZXR1cm4gcHJlZml4QXJyLmpvaW4oJy8nKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0IGEgcmVsYXRpdmUgVVJMIHRvIGEgYWJzb2x1dGUgVVJMIGJ5IHByZXBlbmRpbmcgdGhlIHdpbmRvdyBvcmlnaW4gdG8gdGhlIHJlbGF0aXZlIFVSTC5cbiAqIElmIHRoZSBVUkwgaXMgb2YgYSB3aGl0ZSBsaXN0ZWQgZG9tYWluLCB3aWxsIHNpbXBseSByZXR1cm4gdGhlIHByb3ZpZGVkIFVSTC5cbiAqIEBwYXJhbSBkYXRhVXJsIEEgdXJsIHRvIGJlIHZhbGlkYXRlZC5cbiAqIEBzZWUge0BsaW5rIERPTUFJTl9XSElURUxJU1R9XG4gKiBAc2VlIHtAbGluayBBcGkuVXRpbGl0aWVzfVxuICogQG1vZHVsZSBVdGlsaXRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFic29sdXRlVVJMKGRhdGFVcmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gU29tZSBkb21haW5zIGFyZSB3aGl0ZSBsaXN0ZWQsIHRoZXNlIHNob3VsZCBiZSBjb25zaWRlcmVkIGFic29sdXRlIGFscmVhZHlcbiAgICBmb3IgKGNvbnN0IGRvbWFpbiBvZiBET01BSU5fV0hJVEVMSVNUKSB7XG4gICAgICAgIGlmIChkYXRhVXJsLmluY2x1ZGVzKGRvbWFpbikpIHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhVXJsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGAke3dpbmRvdy5vcmlnaW59JHtnZXRSb3V0ZVByZWZpeCgpfS8ke2RhdGFVcmx9YDtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIFVSTCBzdGFydHMgd2l0aCB0aGUgb3JpZ2luIG9yIHRoZSBkb21haW4gaXMgb25lIG9mIHRoZVxuICogIHdoaXRlIGxpc3RlZCBkb21haW5zLlxuICogQHBhcmFtIGRhdGFVcmwgQSB1cmwgdG8gYmUgdmFsaWRhdGVkLlxuICogQHNlZSB7QGxpbmsgRE9NQUlOX1dISVRFTElTVH1cbiAqIEBzZWUge0BsaW5rIEFwaS5VdGlsaXRpZXN9XG4gKiBAbW9kdWxlIFV0aWxpdGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVBYnNvbHV0ZVVSTChkYXRhVXJsOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAvLyBTb21lIGRvbWFpbnMgYXJlIHdoaXRlIGxpc3RlZFxuICAgIGZvciAoY29uc3QgZG9tYWluIG9mIERPTUFJTl9XSElURUxJU1QpIHtcbiAgICAgICAgaWYgKGRhdGFVcmwuaW5jbHVkZXMoZG9tYWluKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YVVybC5zdGFydHNXaXRoKHdpbmRvdy5vcmlnaW4pO1xufVxuXG4vLyA8L2VkaXRvci1mb2xkPlxuXG4vLyAqKioqKioqKioqKioqXG4vLyBEQVRBIEhFTFBFUlNcbi8vICoqKioqKioqKioqKipcbi8vIDxlZGl0b3ItZm9sZCBkZXNjPSdEYXRhIEhlbHBlcnNcIj5cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByb3ZpZGVkIGVudGl0eSBjb250YWlucyBQREYgZGF0YVxuICogQHBhcmFtIGVudGl0eSBUaGUgZW50aXR5IHRvIGNoZWNrLiBPbmx5IEpvdXJuYWxFbnRpdGllcyBhcmUgYWxsb3dlZCB0byBiZSBQREZzIG5hdGl2ZWx5LlxuICogQHNlZSB7QGxpbmsgQXBpLlV0aWxpdGllc31cbiAqIEBtb2R1bGUgVXRpbGl0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpc0VudGl0eVBERihlbnRpdHk6IEVudGl0eSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBlbnRpdHkgIT09IHVuZGVmaW5lZCAmJiBlbnRpdHkgIT09IG51bGwgJiYgZW50aXR5LmdldEZsYWcoU2V0dGluZ3MuTU9EVUxFX05BTUUsIFNldHRpbmdzLkZMQUdTX0tFWS5QREZfREFUQSkgIT09IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBQdWxsIHJlbGV2YW50IGRhdGEgZnJvbSBhbiBqb3VybmFsIGVudHJ5LCBjcmVhdGluZyBhIHtAbGluayBQREZEYXRhfSBvYmplY3QuXG4gKiBAcGFyYW0gam91cm5hbEVudHJ5IFRoZSBqb3VybmFsIGVudHJ5IHRvIHB1bGwgZGF0YSBmcm9tLlxuICogQHNlZSB7QGxpbmsgQXBpLlV0aWxpdGllc31cbiAqIEBtb2R1bGUgVXRpbGl0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRQREZEYXRhKGpvdXJuYWxFbnRyeTogSm91cm5hbEVudHJ5IHwgbnVsbCB8IHVuZGVmaW5lZCk6IFBERkRhdGEgfCB1bmRlZmluZWQge1xuICAgIGlmIChqb3VybmFsRW50cnkgPT09IHVuZGVmaW5lZCB8fCBqb3VybmFsRW50cnkgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBjb25zdCBwZGZEYXRhID0gam91cm5hbEVudHJ5LmdldEZsYWcoU2V0dGluZ3MuTU9EVUxFX05BTUUsIFNldHRpbmdzLkZMQUdTX0tFWS5QREZfREFUQSkgYXMgUERGRGF0YSB8IHVuZGVmaW5lZDtcbiAgICBpZiAocGRmRGF0YSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHBkZkRhdGEubmFtZSA9IGpvdXJuYWxFbnRyeS5uYW1lO1xuICAgIHJldHVybiBwZGZEYXRhO1xufVxuXG4vKipcbiAqIFNldCBvbmUgb3IgbW9yZSB7QGxpbmsgUERGRGF0YX0gYXR0cmlidXRlcyB0byB0aGUgcHJvdmlkZWQgdmFsdWVzLiBNYWtlcyBubyBjaGFuZ2VzIHRvIGZpZWxkcyB0aGF0XG4gKiAgYXJlIG5vdCBzcGVjaWZpZWQuIElmIHlvdSB3aXNoIHRvIHVwZGF0ZSB0aGUgUERGIG5hbWUsIHVzZSBFbnRpdHkudXBkYXRlIGFzIG5vcm1hbCBpbiBGb3VuZHJ5LlxuICogQHBhcmFtIGpvdXJuYWxFbnRyeSBUaGUgUERGIHRvIHVwZGF0ZSB0aGUgZGF0YSBvbi5cbiAqIEBwYXJhbSBwZGZEYXRhIEEgcGFydGlhbCBtYXBwaW5nIG9mIGEge0BsaW5rIFBERkRhdGF9IG9iamVjdC5cbiAqIEBzZWUge0BsaW5rIEFwaS5VdGlsaXRpZXN9XG4gKiBAbW9kdWxlIFV0aWxpdGllc1xuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0UERGRGF0YShqb3VybmFsRW50cnk6IEpvdXJuYWxFbnRyeSwgcGRmRGF0YTogUGFydGlhbDxQREZEYXRhVXBkYXRlPikge1xuICAgIHJldHVybiBqb3VybmFsRW50cnkuc2V0RmxhZyhTZXR0aW5ncy5NT0RVTEVfTkFNRSwgU2V0dGluZ3MuRkxBR1NfS0VZLlBERl9EQVRBLCBwZGZEYXRhKTtcbn1cblxuLyoqXG4gKiBEZWxldGVzIGEga2V5IGZyb20gdGhlIFBERiBkYXRhLiBSZXF1aXJlcyB0aGUgdmFsdWUgb2YgdGhlIGtleSB0byBiZSBzZXQgdG8gbnVsbC5cbiAqIEBwYXJhbSBqb3VybmFsRW50cnkgVGhlIGpvdXJuYWwgZW50cnkgdG8gZGVsZXRlIHRoZSBrZXkgZnJvbS5cbiAqIEBwYXJhbSBwZGZEYXRhIEEgbWFwcGluZyBvZiB7a2V5OiBudWxsfSBwYWlycyB0byBkZWxldGUuXG4gKiBAc2VlIHtAbGluayBBcGkuVXRpbGl0aWVzfVxuICogQG1vZHVsZSBVdGlsaXRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZVBERkRhdGEoam91cm5hbEVudHJ5OiBKb3VybmFsRW50cnksIHBkZkRhdGE6IFBhcnRpYWw8UERGRGF0YURlbGV0ZT4pIHtcbiAgICBjb25zdCB1cGRhdGUgPSB7fTtcblxuICAgIC8vIFRPRE86IEZlYXR1cmUgcmVxdWVzdCB0byB1c2UgU3ltYm9scyB0byBwZXJmb3JtIHRoaXMgdHlwZSBvZiBvcGVyYXRpb25cbiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhwZGZEYXRhKSkge1xuICAgICAgICB1cGRhdGVbYGZsYWdzLiR7U2V0dGluZ3MuTU9EVUxFX05BTUV9LiR7U2V0dGluZ3MuRkxBR1NfS0VZLlBERl9EQVRBfS4tPSR7a2V5fWBdID0gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gam91cm5hbEVudHJ5LnVwZGF0ZSh1cGRhdGUpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBvciBmYWxzZSBpZiBhbGwgcmVxdWlyZWQgZGF0YSBpcyBzZXQgc3VjaCB0aGF0IHRoZSBQREYgaXMgcG9zc2libGUgdG8gb3Blbi5cbiAqICBEb2VzIG5vdCBndWFyYW50ZWUgYW55IHNwZWNpZmljIGRhdGEgZm9yIGEgdHlwZSBvZiBvcGVuIChlLmcuIG9wZW5pbmcgYXMgYSBmaWxsYWJsZSBQREYpXG4gKiAgb25seSB0aGF0IHRoZSBzdGF0aWMgdmlld2VyIGlzIGFibGUgdG8gb3BlbiB0aGUgUERGLlxuICogQHBhcmFtIHBkZkRhdGEgVGhlIFBERiBkYXRhIHRvIGNoZWNrLlxuICogQHNlZSB7QGxpbmsgQXBpLlV0aWxpdGllc31cbiAqIEBtb2R1bGUgVXRpbGl0aWVzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW5PcGVuUERGKHBkZkRhdGE6IFBERkRhdGEpIHtcbiAgICBpZiAoUERGVHlwZVtwZGZEYXRhLnR5cGVdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiAhKHBkZkRhdGEudXJsID09PSB1bmRlZmluZWQgfHwgcGRmRGF0YS51cmwgPT09ICcnKTtcbn1cblxuLy8gPC9lZGl0b3ItZm9sZD5cblxuLy8gKioqKioqKioqKioqKlxuLy8gVVNFUiBIRUxQRVJTXG4vLyAqKioqKioqKioqKioqXG4vLyA8ZWRpdG9yLWZvbGQgZGVzYz0nVXNlciBIZWxwZXJzXCI+XG4vKipcbiAqIFJldHVybiBhbGwgdXNlcnMgaWRzIGV4Y2VwdCB0aGUgY3VycmVudCB1c2VyXG4gKiBAc2VlIHtAbGluayBBcGkuVXRpbGl0aWVzfVxuICogQG1vZHVsZSBVdGlsaXRpZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldFVzZXJJZHNFeGNlcHRNZSgpIHtcbiAgICByZXR1cm4gZ2FtZS51c2Vyc1xuICAgICAgICAuZmlsdGVyKCh1c2VyOiBVc2VyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gdXNlci5pZCAhPT0gZ2FtZS51c2VySWQ7XG4gICAgICAgIH0pXG4gICAgICAgIC5tYXAoKHVzZXI6IFVzZXIpID0+IHVzZXIuaWQpO1xufVxuXG4vLyA8L2VkaXRvci1mb2xkPlxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgUERGVHlwZSB9IGZyb20gJy4uL2NvbW1vbi90eXBlcy9QREZUeXBlJztcbmltcG9ydCBTZWxlY3RBcHAsIHsgU2VsZWN0T3B0aW9uIH0gZnJvbSAnLi9TZWxlY3RBcHAnO1xuaW1wb3J0IHsgZ2V0UERGRGF0YSwgaXNFbnRpdHlQREYgfSBmcm9tICcuLi9VdGlsJztcblxuLyoqXG4gKiBTZWxlY3RzIGFuIGFjdG9yIHNoZWV0IGluIGEgcG9wIHVwIHdpbmRvdy5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBY3RvclNoZWV0U2VsZWN0IGV4dGVuZHMgU2VsZWN0QXBwIHtcbiAgICBwcm90ZWN0ZWQgZ2V0IHNlbGVjdFRpdGxlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAnUERGT1VORFJZLlZJRVdFUi5TZWxlY3RTaGVldCc7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldCBzZWxlY3RJZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gJ2FjdG9yLXNoZWV0JztcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0IHNlbGVjdExhYmVsKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAnUERGT1VORFJZLlZJRVdFUi5TZWxlY3RTaGVldCc7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldCBzZWxlY3RPcHRpb25zKCk6IFNlbGVjdE9wdGlvbltdIHtcbiAgICAgICAgY29uc3Qgam91cm5hbHM6IEpvdXJuYWxFbnRyeVtdID0gZ2FtZS5qb3VybmFsLmZpbHRlcigoZW50cnk6IEpvdXJuYWxFbnRyeSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGlzRW50aXR5UERGKGVudHJ5KSAmJiBnZXRQREZEYXRhKGVudHJ5KT8udHlwZSA9PT0gUERGVHlwZS5BY3RvcjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGpvdXJuYWxzLm1hcCgoZW50cnkpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGV4dDogZW50cnkuZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBlbnRyeS5pZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBTZXR0aW5ncyBmcm9tICcuLi9TZXR0aW5ncyc7XG5pbXBvcnQgeyBCVVRUT05fR0lUSFVCLCBCVVRUT05fS09GSSB9IGZyb20gJy4uL2NvbW1vbi9oZWxwZXJzL2hlYWRlcic7XG5cbi8qKlxuICogQmFzaWMgYXBwIHRvIGFsbG93IHRoZSB1c2VyIHRvIHNlZSBkYXRhIGtleXMgZm9yIGFjdG9yIHNoZWV0c1xuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBERkFjdG9yRGF0YUJyb3dzZXIgZXh0ZW5kcyBBcHBsaWNhdGlvbiB7XG4gICAgc3RhdGljIGdldCBkZWZhdWx0T3B0aW9ucygpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHN1cGVyLmRlZmF1bHRPcHRpb25zO1xuXG4gICAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSBgJHtTZXR0aW5ncy5QQVRIX1RFTVBMQVRFU30vYXBwL3BkZi1hY3Rvci1kYXRhLWJyb3dzZXIuaHRtbGA7XG4gICAgICAgIG9wdGlvbnMud2lkdGggPSA2MDA7XG4gICAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gNDAwO1xuICAgICAgICBvcHRpb25zLnJlc2l6YWJsZSA9IHRydWU7XG5cbiAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhY3RvcjogQWN0b3I7XG4gICAgcHJpdmF0ZSB0aW1lb3V0OiBhbnk7XG5cbiAgICBjb25zdHJ1Y3RvcihhY3RvcjogQWN0b3IsIG9wdGlvbnM/OiBBcHBsaWNhdGlvbi5PcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmFjdG9yID0gYWN0b3I7XG4gICAgfVxuXG4gICAgZ2V0IHRpdGxlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBgJHt0aGlzLmFjdG9yLm5hbWV9YDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgX2dldEhlYWRlckJ1dHRvbnMoKTogYW55W10ge1xuICAgICAgICBjb25zdCBidXR0b25zID0gc3VwZXIuX2dldEhlYWRlckJ1dHRvbnMoKTtcbiAgICAgICAgYnV0dG9ucy51bnNoaWZ0KEJVVFRPTl9HSVRIVUIpO1xuICAgICAgICBidXR0b25zLnVuc2hpZnQoQlVUVE9OX0tPRkkpO1xuICAgICAgICBidXR0b25zLnVuc2hpZnQoe1xuICAgICAgICAgICAgY2xhc3M6ICdwZGYtc2hlZXQtcmVmcmVzaCcsXG4gICAgICAgICAgICBpY29uOiAnZmFzIGZhLXN5bmMnLFxuICAgICAgICAgICAgbGFiZWw6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLk1JU0MuUmVmcmVzaCcpLFxuICAgICAgICAgICAgb25jbGljazogKCkgPT4gdGhpcy5yZW5kZXIoKSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBidXR0b25zO1xuICAgIH1cblxuICAgIGdldERhdGEob3B0aW9ucz86IGFueSk6IGFueSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBzdXBlci5nZXREYXRhKG9wdGlvbnMpO1xuXG4gICAgICAgIGVudW0gRGFuZ2VyTGV2ZWwge1xuICAgICAgICAgICAgU2FmZSA9IDAsXG4gICAgICAgICAgICBMb3cgPSAxLFxuICAgICAgICAgICAgSGlnaCA9IDIsXG4gICAgICAgICAgICBDcml0aWNhbCA9IDMsXG4gICAgICAgIH1cbiAgICAgICAgdHlwZSBEYXRhUGF0aCA9IHsga2V5OiBzdHJpbmc7IHZhbHVlOiBzdHJpbmc7IGRhbmdlcjogRGFuZ2VyTGV2ZWwgfTtcbiAgICAgICAgY29uc3QgZmxhdHRlbiA9IChkYXRhOiBvYmplY3QsIGN1cnJlbnQ6IHN0cmluZyA9ICcnLCBkYW5nZXI6IERhbmdlckxldmVsID0gRGFuZ2VyTGV2ZWwuU2FmZSk6IERhdGFQYXRoW10gPT4ge1xuICAgICAgICAgICAgbGV0IHJlc3VsdHM6IERhdGFQYXRoW10gPSBbXTtcblxuICAgICAgICAgICAgd2luZG93WydhY3RvckRhdGEnXSA9IHRoaXMuYWN0b3IuZGF0YS5kYXRhO1xuXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gKGN1cnI6IHN0cmluZywgLi4ubmV4dDogKHN0cmluZyB8IG51bWJlcilbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXh0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyID0gYCR7Y3Vycn0uJHtuZXh0W2ldfWA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN1cnI7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGAke25leHR9YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb25zdCB3cmFwID0gKHZhbHVlOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYFxce1xceyR7dmFsdWV9XFx9XFx9YDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNvbnN0IGJvdW5kRGFuZ2VyID0gKGN1cnI6IERhbmdlckxldmVsLCBuZXh0OiBEYW5nZXJMZXZlbCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyIDwgbmV4dCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnI7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoZGF0YSA9PT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7XG4gICAgICAgICAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkKSByZXR1cm4gcmVzdWx0cztcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FzZSAxIDogVGhlIHZhbHVlIGlzIGFuIGFycmF5XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBwYXRoKGN1cnJlbnQsIGtleSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhbmdlcjogRGFuZ2VyTGV2ZWwuQ3JpdGljYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiB3cmFwKCdFbXB0eSBBcnJheSwgZG8gbm90IHVzZSEnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gdmFsdWVbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBbLi4ucmVzdWx0cywgLi4uZmxhdHRlbihuZXh0LCBwYXRoKGN1cnJlbnQsIGtleSwgaSksIGJvdW5kRGFuZ2VyKGRhbmdlciwgRGFuZ2VyTGV2ZWwuSGlnaCkpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FzZSAyIDogVGhlIHZhbHVlIGlzIGFuIG9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHBhdGgoY3VycmVudCwga2V5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFuZ2VyOiBEYW5nZXJMZXZlbC5IaWdoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogd3JhcCgnTnVsbC9VbmRlZmluZWQsIGJlIGNhdXRpb3VzIScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc09iamVjdEVtcHR5KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogcGF0aChjdXJyZW50LCBrZXkpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW5nZXI6IERhbmdlckxldmVsLkNyaXRpY2FsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogd3JhcCgnRW1wdHkgT2JqZWN0LCBkbyBub3QgdXNlIScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBba2V5MiwgdmFsdWUyXSBvZiBPYmplY3QuZW50cmllcyh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IFsuLi5yZXN1bHRzLCAuLi5mbGF0dGVuKHZhbHVlMiBhcyBhbnksIHBhdGgoY3VycmVudCwga2V5LCBrZXkyKSwgYm91bmREYW5nZXIoZGFuZ2VyLCBEYW5nZXJMZXZlbC5Mb3cpKV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2FzZSAzIDogQmFzZSBDYXNlIDogVGhlIHZhbHVlIGlzIGEgZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5OiBwYXRoKGN1cnJlbnQsIGtleSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFuZ2VyOiBib3VuZERhbmdlcihkYW5nZXIsIERhbmdlckxldmVsLkNyaXRpY2FsKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogd3JhcCgnRnVuY3Rpb24sIGRvIG5vdCB1c2UhJyksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhc2UgNCA6IEJhc2UgQ2FzZSA6IFRoZSB2YWx1ZSBpcyBhIHByaW1pdGl2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk6IHBhdGgoY3VycmVudCwga2V5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW5nZXI6IGJvdW5kRGFuZ2VyKGRhbmdlciwgRGFuZ2VyTGV2ZWwuU2FmZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICh2YWx1ZSBhcyBhbnkpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAvLyBDYXNlIDMgOiBCYXNlIENhc2UgOiBUaGUgdmFsdWUgaXMgYSBmdW5jdGlvblxuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGtleTogY3VycmVudCxcbiAgICAgICAgICAgICAgICAgICAgZGFuZ2VyOiBib3VuZERhbmdlcihkYW5nZXIsIERhbmdlckxldmVsLkNyaXRpY2FsKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHdyYXAoJ0Z1bmN0aW9uLCBkbyBub3QgdXNlIScpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBDYXNlIDQgOiBCYXNlIENhc2UgOiBUaGUgdmFsdWUgaXMgYSBwcmltaXRpdmVcbiAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBrZXk6IGN1cnJlbnQsXG4gICAgICAgICAgICAgICAgICAgIGRhbmdlcjogYm91bmREYW5nZXIoZGFuZ2VyLCBEYW5nZXJMZXZlbC5TYWZlKSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRhdGEsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IGljb25zID0ge1xuICAgICAgICAgICAgW0RhbmdlckxldmVsLlNhZmVdOiAnPGkgY2xhc3M9XCJmYXMgZmEtY2hlY2stY2lyY2xlXCI+PC9pPicsXG4gICAgICAgICAgICBbRGFuZ2VyTGV2ZWwuTG93XTogJzxpIGNsYXNzPVwiZmFzIGZhLXF1ZXN0aW9uLWNpcmNsZVwiPjwvaT4nLFxuICAgICAgICAgICAgW0RhbmdlckxldmVsLkhpZ2hdOiAnPGkgY2xhc3M9XCJmYXMgZmEtZXhjbGFtYXRpb24tdHJpYW5nbGVcIj48L2k+JyxcbiAgICAgICAgICAgIFtEYW5nZXJMZXZlbC5Dcml0aWNhbF06ICc8aSBjbGFzcz1cImZhcyBmYS1yYWRpYXRpb24tYWx0XCI+PC9pPicsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHRvb2x0aXBzID0ge1xuICAgICAgICAgICAgW0RhbmdlckxldmVsLlNhZmVdOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5NSVNDLkRBTkdFUi5TYWZlJyksXG4gICAgICAgICAgICBbRGFuZ2VyTGV2ZWwuTG93XTogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuTUlTQy5EQU5HRVIuTG93JyksXG4gICAgICAgICAgICBbRGFuZ2VyTGV2ZWwuSGlnaF06IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLk1JU0MuREFOR0VSLkhpZ2gnKSxcbiAgICAgICAgICAgIFtEYW5nZXJMZXZlbC5Dcml0aWNhbF06IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLk1JU0MuREFOR0VSLkNyaXRpY2FsJyksXG4gICAgICAgIH07XG5cbiAgICAgICAgZGF0YVsncGF0aHMnXSA9IGZsYXR0ZW4odGhpcy5hY3Rvci5kYXRhLmRhdGEsICdkYXRhJyk7XG4gICAgICAgIGRhdGFbJ3BhdGhzJ10ucHVzaCh7XG4gICAgICAgICAgICBrZXk6ICduYW1lJyxcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLmFjdG9yLm5hbWUsXG4gICAgICAgICAgICBkYW5nZXI6IERhbmdlckxldmVsLlNhZmUsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGRhdGFbJ3BhdGhzJ10uc29ydCgoYTogRGF0YVBhdGgsIGI6IERhdGFQYXRoKSA9PiBhLmtleS5sb2NhbGVDb21wYXJlKGIua2V5KSk7XG4gICAgICAgIGRhdGFbJ3BhdGhzJ10gPSBkYXRhWydwYXRocyddLm1hcCgoZWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgbGV0IHNwbGl0Um9sbCA9IGVsZW1lbnRbJ2tleSddLnNwbGl0KCcuJykgYXMgc3RyaW5nW107XG4gICAgICAgICAgICBzcGxpdFJvbGwuc2hpZnQoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAuLi5lbGVtZW50LFxuICAgICAgICAgICAgICAgIGljb246IGljb25zW2VsZW1lbnQuZGFuZ2VyXSxcbiAgICAgICAgICAgICAgICByb2xsOiBgQCR7c3BsaXRSb2xsLmpvaW4oJy4nKX1gLFxuICAgICAgICAgICAgICAgIHRvb2x0aXA6IHRvb2x0aXBzW2VsZW1lbnQuZGFuZ2VyXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhY3RpdmF0ZUxpc3RlbmVycyhodG1sOiBKUXVlcnkpIHtcbiAgICAgICAgc3VwZXIuYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbCk7XG5cbiAgICAgICAgaHRtbC5maW5kKCdpLmNvcHknKS5vbignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9ICQoZXZlbnQuY3VycmVudFRhcmdldCk7XG5cbiAgICAgICAgICAgIGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRhcmdldC5kYXRhKCd2YWx1ZScpIGFzIHN0cmluZyk7XG5cbiAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnMuaW5mbyhnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5NSVNDLkNvcGllZFRvQ2xpcGJvYXJkJykpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZW5kZXIoZm9yY2U/OiBib29sZWFuLCBvcHRpb25zPzogQXBwbGljYXRpb24uUmVuZGVyT3B0aW9ucyk6IEFwcGxpY2F0aW9uIHtcbiAgICAgICAgaWYgKHRoaXMudGltZW91dCkge1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMucmVuZGVyLmJpbmQodGhpcyksIDEwMDAwKTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLnJlbmRlcihmb3JjZSwgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgY2xvc2UoKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgIHJldHVybiBzdXBlci5jbG9zZSgpO1xuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBBY3RvclZpZXdlciBmcm9tICcuLi92aWV3ZXIvQWN0b3JWaWV3ZXInO1xuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uL1NldHRpbmdzJztcblxuLyoqXG4gKiBBZGFwdHMgYSBGaWxsYWJsZVZpZXdlciB0byBmdW5jdGlvbiBhcyBhIEFjdG9yU2hlZXRcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQREZBY3RvclNoZWV0QWRhcHRlciBleHRlbmRzIEFjdG9yU2hlZXQge1xuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiU3RhdGljIFByb3BlcnRpZXNcIj48L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiU3RhdGljIE1ldGhvZHNcIj48L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiUHJvcGVydGllc1wiPlxuXG4gICAgcHJpdmF0ZSBfdmlld2VyOiBBY3RvclZpZXdlcjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9vcHRpb25zPzogQXBwbGljYXRpb24uT3B0aW9ucztcblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkNvbnN0cnVjdG9yICYgSW5pdGlhbGl6YXRpb25cIj5cblxuICAgIGNvbnN0cnVjdG9yKGFjdG9yOiBBY3Rvciwgb3B0aW9ucz86IEFwcGxpY2F0aW9uLk9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIoYWN0b3IsIG9wdGlvbnMpO1xuXG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJHZXR0ZXJzICYgU2V0dGVyc1wiPlxuXG4gICAgcHVibGljIGdldCB2aWV3ZXIoKTogQWN0b3JWaWV3ZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmlld2VyO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJJbnN0YW5jZSBNZXRob2RzXCI+XG5cbiAgICBwcm90ZWN0ZWQgYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbDogSlF1ZXJ5IHwgSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgJCh0aGlzLmVsZW1lbnQpLmNzcygnZGlzcGxheScsICdub25lJyk7XG4gICAgICAgIHRoaXMuZm9ybSA9ICQoaHRtbCkuZmlyc3QoKS5nZXQoMCk7XG4gICAgICAgIHN1cGVyLmFjdGl2YXRlTGlzdGVuZXJzKGh0bWwpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhc3luYyBfb25TdWJtaXQoLi4uYXJncyk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIC8vIFBERm91bmRyeSBoYW5kbGVzIGRhdGEgaW4gdGhlIEZpbGxhYmxlVmlld2VyXG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBnZXREYXRhKCk6IEFjdG9yU2hlZXQuRGF0YSB7XG4gICAgICAgIHJldHVybiBtZXJnZU9iamVjdChzdXBlci5nZXREYXRhKCksIHRoaXMuX3ZpZXdlci5nZXREYXRhKCkpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBfdXBkYXRlT2JqZWN0KGV2ZW50OiBFdmVudCB8IEpRdWVyeS5FdmVudCwgZm9ybURhdGE6IGFueSk6IFByb21pc2U8YW55PiB7XG4gICAgICAgIHJldHVybiBzdXBlci5fdXBkYXRlT2JqZWN0KGV2ZW50LCBmb3JtRGF0YSk7XG4gICAgfVxuXG4gICAgcmVuZGVyKGZvcmNlPzogYm9vbGVhbiwgb3B0aW9ucz86IEFwcGxpY2F0aW9uLlJlbmRlck9wdGlvbnMpOiBBcHBsaWNhdGlvbiB7XG4gICAgICAgIGlmICghdGhpcy5fdmlld2VyKSB7XG4gICAgICAgICAgICBjb25zdCBzaGVldElkID0gdGhpcy5hY3Rvci5nZXRGbGFnKFNldHRpbmdzLk1PRFVMRV9OQU1FLCBTZXR0aW5ncy5GTEFHU19LRVkuU0hFRVRfSUQpO1xuICAgICAgICAgICAgdGhpcy5fdmlld2VyID0gbmV3IEFjdG9yVmlld2VyKHRoaXMuYWN0b3IsIHNoZWV0SWQsIHRoaXMsIHRoaXMuX29wdGlvbnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgdGhpcyB3aW5kb3cgaXMgYWxyZWFkeSBvcGVuLCBkb24ndCByZS1yZW5kZXJcbiAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBBcHBsaWNhdGlvbi5SRU5ERVJfU1RBVEVTLlJFTkRFUkVEKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3ZpZXdlci5yZW5kZXIoZm9yY2UsIG9wdGlvbnMpO1xuICAgICAgICByZXR1cm4gc3VwZXIucmVuZGVyKGZvcmNlLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBTYW5kYm94IGNvbXBhdGliaWxpdHkgLSBzaG91bGQgZm9yY2UgdGhpcyBjbGFzcyB0byBleHRlbmQgQ09ORklHIGNsYXNzIGluc3RlYWQuXG4gICAgYXN5bmMgc2Nyb2xsYmFyU2V0KCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgYXN5bmMgY2xvc2UoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICh0aGlzLl92aWV3ZXIpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3ZpZXdlci5jbG9zZSgpO1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3ZpZXdlcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIuY2xvc2UoKTtcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uL1NldHRpbmdzJztcbmltcG9ydCBBcGkgZnJvbSAnLi4vQXBpJztcbmltcG9ydCB7IGdldEFic29sdXRlVVJMLCBnZXRQREZEYXRhIH0gZnJvbSAnLi4vVXRpbCc7XG5pbXBvcnQgeyBQREZUeXBlIH0gZnJvbSAnLi4vY29tbW9uL3R5cGVzL1BERlR5cGUnO1xuaW1wb3J0IHsgQlVUVE9OX0dJVEhVQiwgQlVUVE9OX0hFTFAsIEJVVFRPTl9LT0ZJIH0gZnJvbSAnLi4vY29tbW9uL2hlbHBlcnMvaGVhZGVyJztcblxuLyoqXG4gKiBFeHRlbmRzIHRoZSBiYXNlIEl0ZW1TaGVldCBmb3IgbGlua2VkIFBERiB2aWV3aW5nLlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGNsYXNzIFBERkNvbmZpZyBleHRlbmRzIEZvcm1BcHBsaWNhdGlvbiB7XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTdGF0aWMgUHJvcGVydGllc1wiPlxuXG4gICAgc3RhdGljIGdldCBkZWZhdWx0T3B0aW9ucygpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHN1cGVyLmRlZmF1bHRPcHRpb25zO1xuICAgICAgICBvcHRpb25zLmNsYXNzZXMgPSBbLi4ub3B0aW9ucy5jbGFzc2VzISwgU2V0dGluZ3MuQ1NTX0NMQVNTXTtcbiAgICAgICAgb3B0aW9ucy50ZW1wbGF0ZSA9IGAke1NldHRpbmdzLlBBVEhfVEVNUExBVEVTfS9zaGVldC9wZGYtY29uZmlnLmh0bWxgO1xuICAgICAgICBvcHRpb25zLndpZHRoID0gNjUwO1xuICAgICAgICBvcHRpb25zLmhlaWdodCA9ICdhdXRvJztcbiAgICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIlN0YXRpYyBNZXRob2RzXCI+PC9lZGl0b3ItZm9sZD5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIlByb3BlcnRpZXNcIj5cblxuICAgIHB1YmxpYyByZWFkb25seSBvYmplY3Q6IEpvdXJuYWxFbnRyeTtcbiAgICBwcml2YXRlIHBpY2tlcjogRmlsZVBpY2tlcjtcblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJDb25zdHJ1Y3RvciAmIEluaXRpYWxpemF0aW9uXCI+XG5cbiAgICBjb25zdHJ1Y3Rvcihqb3VybmFsRW50cnk6IEpvdXJuYWxFbnRyeSwgb3B0aW9ucz86IEFwcGxpY2F0aW9uLk9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIoam91cm5hbEVudHJ5LCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiR2V0dGVycyAmIFNldHRlcnNcIj5cblxuICAgIHB1YmxpYyBnZXQgdGl0bGUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2JqZWN0Lm5hbWU7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBpZCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYHBkZi0ke3RoaXMub2JqZWN0LmlkfWA7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIF9nZXRIZWFkZXJCdXR0b25zKCk6IGFueVtdIHtcbiAgICAgICAgY29uc3QgYnV0dG9ucyA9IHN1cGVyLl9nZXRIZWFkZXJCdXR0b25zKCk7XG4gICAgICAgIGJ1dHRvbnMudW5zaGlmdChCVVRUT05fR0lUSFVCKTtcbiAgICAgICAgYnV0dG9ucy51bnNoaWZ0KEJVVFRPTl9LT0ZJKTtcbiAgICAgICAgYnV0dG9ucy51bnNoaWZ0KEJVVFRPTl9IRUxQKTtcbiAgICAgICAgcmV0dXJuIGJ1dHRvbnM7XG4gICAgfVxuXG4gICAgZ2V0IGlzRWRpdGFibGUoKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgVE9ETzogMC44LnggY29tcGF0XG4gICAgICAgIHJldHVybiB0aGlzLm9iamVjdC50ZXN0VXNlclBlcm1pc3Npb24oZ2FtZS51c2VyLCBDT05TVC5FTlRJVFlfUEVSTUlTU0lPTlMuT1dORVIpO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJJbnN0YW5jZSBNZXRob2RzXCI+XG5cbiAgICBwcm90ZWN0ZWQgYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbDogSlF1ZXJ5KTogdm9pZCB7XG4gICAgICAgIHN1cGVyLmFjdGl2YXRlTGlzdGVuZXJzKGh0bWwpO1xuXG4gICAgICAgIGNvbnN0IHVybElucHV0ID0gaHRtbC5maW5kKCcjZGF0YS11cmwnKTtcbiAgICAgICAgY29uc3Qgb2Zmc2V0SW5wdXQgPSBodG1sLmZpbmQoJyNkYXRhLW9mZnNldCcpO1xuXG4gICAgICAgIC8vIERlZmF1bHQgYmVoYXZpb3Igb3BlbnMgdGhlIGZpbGUgcGlja2VyIGluIHRoaXMgZm9ybSBzZXR1cCwgb3ZlcnJpZGVcbiAgICAgICAgaHRtbC5maW5kKCdpbnB1dCcpLm9uKCdrZXlwcmVzcycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uU3VibWl0KGV2ZW50LCB7IHByZXZlbnRDbG9zZTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGh0bWwuZmluZCgnaW5wdXQsIHNlbGVjdCcpLm9uKCdpbnB1dCcsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fb25TdWJtaXQoZXZlbnQsIHsgcHJldmVudENsb3NlOiB0cnVlIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBCcm93c2UgYnV0dG9uXG4gICAgICAgIGh0bWwuZmluZCgnI3BkZi1icm93c2UnKS5vbignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgdGhpcy5waWNrZXIgPVxuICAgICAgICAgICAgICAgIHRoaXMucGlja2VyID8/XG4gICAgICAgICAgICAgICAgbmV3IEZpbGVQaWNrZXIoe1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE9cbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uU3VibWl0KG5ldyBFdmVudCgnaW5wdXQnKSwgeyBwcmV2ZW50Q2xvc2U6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmUgVE9ETzogRm91bmRyeSBUeXBlc1xuICAgICAgICAgICAgdGhpcy5waWNrZXIuZXh0ZW5zaW9ucyA9IFsnLnBkZiddO1xuICAgICAgICAgICAgdGhpcy5waWNrZXIuZmllbGQgPSB1cmxJbnB1dFswXTtcblxuICAgICAgICAgICAgaWYgKCF0aGlzLmZpbGVwaWNrZXJzLmluY2x1ZGVzKHRoaXMucGlja2VyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXBpY2tlcnMucHVzaCh0aGlzLnBpY2tlcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxldCB1cmxWYWx1ZSA9IHVybElucHV0LnZhbCgpO1xuICAgICAgICAgICAgaWYgKHVybFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBpY2tlci5icm93c2UodXJsVmFsdWUudG9TdHJpbmcoKS50cmltKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnBpY2tlci5yZW5kZXIodHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFRlc3QgcGRmIHNldHRpbmdzIGJ1dHRvblxuICAgICAgICBodG1sLmZpbmQoJyNwZGYtdGVzdCcpLm9uKCdjbGljaycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICBsZXQgdXJsVmFsdWUgPSB1cmxJbnB1dC52YWwoKTtcbiAgICAgICAgICAgIGxldCBvZmZzZXRWYWx1ZSA9IG9mZnNldElucHV0LnZhbCgpO1xuXG4gICAgICAgICAgICBpZiAodXJsVmFsdWUgPT09IG51bGwgfHwgdXJsVmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuICAgICAgICAgICAgaWYgKG9mZnNldFZhbHVlID09PSBudWxsIHx8IG9mZnNldFZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjtcblxuICAgICAgICAgICAgdXJsVmFsdWUgPSB1cmxWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgdXJsVmFsdWUgPSBnZXRBYnNvbHV0ZVVSTCh1cmxWYWx1ZSk7XG5cbiAgICAgICAgICAgIGlmIChvZmZzZXRWYWx1ZS50b1N0cmluZygpLnRyaW0oKSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvZmZzZXRWYWx1ZSA9IHBhcnNlSW50KG9mZnNldFZhbHVlIGFzIHN0cmluZyk7XG5cbiAgICAgICAgICAgIEFwaS5vcGVuVVJMKHVybFZhbHVlLCA1ICsgb2Zmc2V0VmFsdWUsIGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldERhdGEoKTogb2JqZWN0IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHN1cGVyLmdldERhdGEoKTtcblxuICAgICAgICBkYXRhWyd0eXBlcyddID0gT2JqZWN0LmVudHJpZXMoUERGVHlwZSkubWFwKChba2V5XSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogUERGVHlwZVtrZXldLFxuICAgICAgICAgICAgICAgIHRleHQ6IGBQREZPVU5EUlkuTUlTQy5QREZUWVBFLiR7a2V5fWAsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICBkYXRhWydkYXRhUGF0aCddID0gYGZsYWdzLiR7U2V0dGluZ3MuTU9EVUxFX05BTUV9LiR7U2V0dGluZ3MuRkxBR1NfS0VZLlBERl9EQVRBfWA7XG4gICAgICAgIGRhdGFbJ2ZsYWdzJ10gPSBnZXRQREZEYXRhKHRoaXMub2JqZWN0KTtcbiAgICAgICAgZGF0YVsnbmFtZSddID0gdGhpcy5vYmplY3QuZGF0YS5uYW1lO1xuXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhc3luYyBfdXBkYXRlT2JqZWN0KGV2ZW50OiBFdmVudCB8IEpRdWVyeS5FdmVudCwgZm9ybURhdGE6IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCB0aGlzLm9iamVjdC51cGRhdGUoZm9ybURhdGEpO1xuICAgIH1cblxuICAgIC8vIEB0cy1pZ25vcmUgVE9ET1xuICAgIHN1Ym1pdCh7IHVwZGF0ZURhdGEgfTogeyB1cGRhdGVEYXRhPzogYW55IH0pOiBGb3JtQXBwbGljYXRpb24ge1xuICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE9cbiAgICAgICAgcmV0dXJuIHN1cGVyLnN1Ym1pdCh7IHVwZGF0ZURhdGEgfSk7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBTZXR0aW5ncyBmcm9tICcuLi9TZXR0aW5ncyc7XG5cbi8qKlxuICogQ2FsbGJhY2sgdHlwZSBmb3IgcGxheWVyIHNlbGVjdGlvblxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IHR5cGUgUERGUGxheWVyU2VsZWN0Q2FsbGJhY2sgPSAoaWRzOiBzdHJpbmdbXSkgPT4gdm9pZDtcblxuLyoqXG4gKiBBbiBhcHBsaWNhdGlvbiB0aGF0IGFsbG93cyBzZWxlY3Rpb24gb2YgcGxheWVycy5cbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYXllclNlbGVjdCBleHRlbmRzIEFwcGxpY2F0aW9uIHtcbiAgICBzdGF0aWMgZ2V0IGRlZmF1bHRPcHRpb25zKCkge1xuICAgICAgICBjb25zdCBvcHRpb25zID0gc3VwZXIuZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgIG9wdGlvbnMuY2xhc3NlcyA9IFsnc2hlZXQnLCAnaXRlbSddO1xuICAgICAgICBvcHRpb25zLnRlbXBsYXRlID0gYCR7U2V0dGluZ3MuUEFUSF9URU1QTEFURVN9L2FwcC9wZGYtcGxheWVyLXNlbGVjdC5odG1sYDtcbiAgICAgICAgb3B0aW9ucy53aWR0aCA9ICdhdXRvJztcbiAgICAgICAgb3B0aW9ucy5oZWlnaHQgPSAnYXV0byc7XG4gICAgICAgIG9wdGlvbnMudGl0bGUgPSBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuU2VsZWN0UGxheWVycycpO1xuICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IF9pZHM7XG4gICAgcHJpdmF0ZSByZWFkb25seSBfY2FsbGJhY2s6IFBERlBsYXllclNlbGVjdENhbGxiYWNrO1xuXG4gICAgY29uc3RydWN0b3IoaWRzOiBzdHJpbmdbXSwgY2I6IFBERlBsYXllclNlbGVjdENhbGxiYWNrLCBvcHRpb25zPzogQXBwbGljYXRpb24uT3B0aW9ucykge1xuICAgICAgICBzdXBlcihvcHRpb25zKTtcblxuICAgICAgICB0aGlzLl9pZHMgPSBpZHM7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2I7XG4gICAgfVxuXG4gICAgZ2V0RGF0YShvcHRpb25zPzogYW55KTogYW55IHwgUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHN1cGVyLmdldERhdGEob3B0aW9ucyk7XG5cbiAgICAgICAgY29uc3QgdXNlcnM6IGFueVtdID0gW107XG4gICAgICAgIGZvciAoY29uc3QgaWQgb2YgdGhpcy5faWRzKSB7XG4gICAgICAgICAgICB1c2Vycy5wdXNoKHtcbiAgICAgICAgICAgICAgICBuYW1lOiBnYW1lLnVzZXJzLmdldChpZCkubmFtZSxcbiAgICAgICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdXNlcnMuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XG5cbiAgICAgICAgZGF0YVsndXNlcnMnXSA9IHVzZXJzO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbDogSlF1ZXJ5PEhUTUxFbGVtZW50PiB8IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIHN1cGVyLmFjdGl2YXRlTGlzdGVuZXJzKGh0bWwpO1xuXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9ICQoaHRtbCkuZmluZCgnI2NvbmZpcm0nKTtcbiAgICAgICAgYnV0dG9uLm9uKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrKHRoaXMuY29sbGVjdElkcygpKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29sbGVjdCBzZWxlY3RlZCBpZHMgZnJvbSB0aGUgaHRtbFxuICAgICAqL1xuICAgIHByaXZhdGUgY29sbGVjdElkcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGlkczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgY29uc3QgY2hlY2tib3hlcyA9ICQodGhpcy5lbGVtZW50KS5maW5kKCdpbnB1dFt0eXBlPWNoZWNrYm94XScpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoZWNrYm94ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrYm94ID0gJChjaGVja2JveGVzW2ldKTtcbiAgICAgICAgICAgIGlmIChjaGVja2JveC5wcm9wKCdjaGVja2VkJykpIHtcbiAgICAgICAgICAgICAgICBpZHMucHVzaChjaGVja2JveC5wcm9wKCdpZCcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaWRzO1xuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBTZXR0aW5ncyBmcm9tICcuLi9TZXR0aW5ncyc7XG5cbi8qKlxuICogQ2FsbGJhY2sgdHlwZSBmb3Igc2VsZWN0IGFwcHNcbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgdHlwZSBTZWxlY3RBcHBDYWxsYmFjayA9ICh2YWx1ZTogc3RyaW5nLCB0ZXh0OiBzdHJpbmcpID0+IHZvaWQ7XG5cbi8qKlxuICogRGF0YSBsYXlvdXQgZm9yIHNlbGVjdCBvcHRpb25zXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTZWxlY3RPcHRpb24ge1xuICAgIHRleHQ6IHN0cmluZztcbiAgICB2YWx1ZTogc3RyaW5nO1xufVxuXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIGFwcCB0aGF0IHVzZXMgYSBzZWxlY3QgZHJvcCBkb3duXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGRlZmF1bHQgYWJzdHJhY3QgY2xhc3MgU2VsZWN0QXBwIGV4dGVuZHMgQXBwbGljYXRpb24ge1xuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiU3RhdGljIFByb3BlcnRpZXNcIj5cblxuICAgIHN0YXRpYyBnZXQgZGVmYXVsdE9wdGlvbnMoKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBzdXBlci5kZWZhdWx0T3B0aW9ucztcbiAgICAgICAgb3B0aW9ucy5jbGFzc2VzID0gWy4uLm9wdGlvbnMuY2xhc3NlcyEsIFNldHRpbmdzLkNTU19DTEFTU107XG4gICAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSBgJHtTZXR0aW5ncy5QQVRIX1RFTVBMQVRFU30vYXBwL3NlbGVjdC1hcHAuaHRtbGA7XG4gICAgICAgIG9wdGlvbnMud2lkdGggPSAyMDA7XG4gICAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gJ2F1dG8nO1xuICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiU3RhdGljIE1ldGhvZHNcIj48L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiUHJvcGVydGllc1wiPlxuXG4gICAgcHJpdmF0ZSByZWFkb25seSBfY3VycmVudD86IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9jYWxsYmFjaz86IFNlbGVjdEFwcENhbGxiYWNrO1xuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkNvbnN0cnVjdG9yICYgSW5pdGlhbGl6YXRpb25cIj5cblxuICAgIGNvbnN0cnVjdG9yKGNhbGxiYWNrPzogU2VsZWN0QXBwQ2FsbGJhY2ssIGN1cnJlbnRWYWx1ZT86IHN0cmluZywgb3B0aW9ucz86IEFwcGxpY2F0aW9uLk9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIob3B0aW9ucyk7XG5cbiAgICAgICAgdGhpcy5fY3VycmVudCA9IGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiR2V0dGVycyAmIFNldHRlcnNcIj5cblxuICAgIHB1YmxpYyBnZXQgdGl0bGUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGdhbWUuaTE4bi5sb2NhbGl6ZSh0aGlzLnNlbGVjdFRpdGxlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGlkKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnVuaXF1ZSA/IHRoaXMuc2VsZWN0SWQgOiBzdXBlci5pZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG91bGQgZHVwbGljYXRlIG9mIHRoaXMgYXBwIGJlIGFsbG93ZWRcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGdldCB1bmlxdWUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBsb2NhbGl6YXRpb24gc3RyaW5nIHRvIGJlIHVzZWQgaW4gdGhlIGhlYWRlciBmb3IgdGhlIHRpdGxlXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBnZXQgc2VsZWN0VGl0bGUoKTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGxvY2FsaXphdGlvbiBzdHJpbmcgdG8gYmUgdXNlZCBpbiB0aGUgYm9keSB0byBsYWJlbCB0aGUgc2VsZWN0XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBnZXQgc2VsZWN0TGFiZWwoKTogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGlkIG9mIHRoZSBzZWxlY3QsIHRvIHByZXNlcnZlIHVuaXF1ZW5lc3MuIFVzZWQgZm9yIGFwcCBpZCBpZiBub3RcbiAgICAgKiAgdW5pcXVlLCBhbmQgc2VsZWN0IGlkIGF0dHJpYnV0ZSBmb3IgZ2xvYmFsIGZpbmRzLlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgZ2V0IHNlbGVjdElkKCk6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIEFycmF5IG9mIG9wdGlvbnMgdGhhdCB3aWxsIGJlIHVzZWQgZm9yIHRoZSBzZWxlY3Qgb3B0aW9uc1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgZ2V0IHNlbGVjdE9wdGlvbnMoKTogU2VsZWN0T3B0aW9uW107XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiSW5zdGFuY2UgTWV0aG9kc1wiPlxuXG4gICAgZ2V0RGF0YShvcHRpb25zPzogYW55KTogYW55IHwgUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHN1cGVyLmdldERhdGEob3B0aW9ucyk7XG5cbiAgICAgICAgZGF0YS5kYXRhID0ge1xuICAgICAgICAgICAgaWQ6IHRoaXMuc2VsZWN0SWQsXG4gICAgICAgICAgICBsYWJlbDogdGhpcy5zZWxlY3RMYWJlbCxcbiAgICAgICAgICAgIHNlbGVjdGVkOiB0aGlzLl9jdXJyZW50LFxuICAgICAgICAgICAgb3B0aW9uczogdGhpcy5zZWxlY3RPcHRpb25zLFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhY3RpdmF0ZUxpc3RlbmVycyhodG1sOiBKUXVlcnkpOiB2b2lkIHtcbiAgICAgICAgc3VwZXIuYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbCk7XG5cbiAgICAgICAgY29uc3QgYnV0dG9uID0gaHRtbC5maW5kKGBidXR0b24jJHt0aGlzLnNlbGVjdElkfS1jb25maXJtYCk7XG4gICAgICAgIGJ1dHRvbi5vbignY2xpY2snLCBhc3luYyAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3QgPSBodG1sLmZpbmQoYCMke3RoaXMuc2VsZWN0SWR9YCkgYXMgSlF1ZXJ5PEhUTUxTZWxlY3RFbGVtZW50PjtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gc2VsZWN0LnZhbCgpIGFzIHN0cmluZztcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5fY3VycmVudCAmJiB0aGlzLl9jYWxsYmFjayAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sodmFsdWUsIHNlbGVjdC5maW5kKCdvcHRpb246c2VsZWN0ZWQnKS50ZXh0KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBBbiBlcnJvciB0aGF0IG9jY3VycyBkdXJpbmcgY2FjaGUgb3BlcmF0aW9uc1xuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGNsYXNzIENhY2hlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3IoaW5kZXg6IHN0cmluZywgc3RvcmU6IHN0cmluZywgbWVzc2FnZT86IHN0cmluZykge1xuICAgICAgICBzdXBlcihgRXJyb3IgaW4gJHtpbmRleH0+JHtzdG9yZX06ICR7bWVzc2FnZX1gKTtcbiAgICB9XG59XG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBDYWNoZUVycm9yIH0gZnJvbSAnLi9DYWNoZUVycm9yJztcblxuLyoqXG4gKiBDbGFzcyB0aGF0IGRlYWxzIHdpdGggZ2V0dGluZy9zZXR0aW5nIGZyb20gYW4gaW5kZXhlZCBkYlxuICogTW9zdGx5IGV4aXN0cyB0byBzZXBhcmF0ZSBsb2dpYyBmb3IgdGhlIFBERkNhY2hlIGZyb20gbG9naWNcbiAqIGRlYWxpbmcgd2l0aCB0aGUgZGF0YWJhc2VcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhY2hlSGVscGVyIHtcbiAgICBwcml2YXRlIF92ZXJzaW9uOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IF9pbmRleE5hbWU6IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IF9zdG9yZU5hbWVzOiBzdHJpbmdbXTtcblxuICAgIHByaXZhdGUgX2RiOiBJREJEYXRhYmFzZTtcblxuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgY3JlYXRlQW5kT3BlbihpbmRleE5hbWU6IHN0cmluZywgc3RvcmVOYW1lczogc3RyaW5nW10sIHZlcnNpb246IG51bWJlcikge1xuICAgICAgICBjb25zdCBoZWxwZXIgPSBuZXcgQ2FjaGVIZWxwZXIoaW5kZXhOYW1lLCBzdG9yZU5hbWVzLCB2ZXJzaW9uKTtcbiAgICAgICAgYXdhaXQgaGVscGVyLm9wZW4oKTtcbiAgICAgICAgcmV0dXJuIGhlbHBlcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IHJlYWR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGIgIT09IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoaW5kZXhOYW1lOiBzdHJpbmcsIHN0b3JlTmFtZXM6IHN0cmluZ1tdLCB2ZXJzaW9uOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5faW5kZXhOYW1lID0gYCR7aW5kZXhOYW1lfWA7XG4gICAgICAgIHRoaXMuX3N0b3JlTmFtZXMgPSBzdG9yZU5hbWVzO1xuICAgICAgICB0aGlzLl92ZXJzaW9uID0gdmVyc2lvbjtcbiAgICB9XG5cbiAgICBwcml2YXRlIG5ld1RyYW5zYWN0aW9uKHN0b3JlTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gdGhpcy5fZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCAncmVhZHdyaXRlJyk7XG4gICAgICAgIGNvbnN0IHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcbiAgICAgICAgcmV0dXJuIHsgdHJhbnNhY3Rpb24sIHN0b3JlIH07XG4gICAgfVxuXG4gICAgcHVibGljIG9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKHRoYXQuX2luZGV4TmFtZSwgdGhhdC5fdmVyc2lvbik7XG4gICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHRoYXQuX2RiID0gdGhpcy5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgdGhhdC5fZGIgPSB0aGlzLnJlc3VsdDtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoYXQuX3N0b3JlTmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBvYmplY3Qgc3RvcmUgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5fZGIuY3JlYXRlT2JqZWN0U3RvcmUodGhhdC5fc3RvcmVOYW1lc1tpXSwge30pO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHBhc3NcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIHNldChrZXk6IElEQlZhbGlkS2V5LCB2YWx1ZTogYW55LCBzdG9yZU5hbWU6IHN0cmluZywgZm9yY2U6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9kYikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDYWNoZUVycm9yKHRoaXMuX2luZGV4TmFtZSwgc3RvcmVOYW1lLCAnRGF0YWJhc2UgaXMgbm90IGluaXRpYWxpemVkLicpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgICAgICBsZXQgeyB0cmFuc2FjdGlvbiwgc3RvcmUgfSA9IHRoaXMubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKTtcblxuICAgICAgICAgICAgICAgIC8vIFByb3BhZ2F0ZSBlcnJvcnMgdXB3YXJkcywgb3RoZXJ3aXNlIHRoZXkgZmFpbCBzaWxlbnRseVxuICAgICAgICAgICAgICAgIHRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXZlbnQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgY29uc3Qga2V5UmVxdWVzdCA9IHN0b3JlLmdldEtleShrZXkpO1xuICAgICAgICAgICAgICAgIGtleVJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGtleSBhbHJlYWR5IGV4aXN0cyBpbiB0aGUgc3RvcmVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleVJlcXVlc3QucmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG91bGQgd2UgZm9yY2UgdGhlIG5ldyB2YWx1ZSBieSBkZWxldGluZyB0aGUgb2xkP1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvcmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5kZWwoa2V5LCBzdG9yZU5hbWUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoeyB0cmFuc2FjdGlvbiwgc3RvcmUgfSA9IHRoYXQubmV3VHJhbnNhY3Rpb24oc3RvcmVOYW1lKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3JlLmFkZCh2YWx1ZSwga2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2FjaGVFcnJvcih0aGF0Ll9pbmRleE5hbWUsIHN0b3JlTmFtZSwgYEtleSAke2tleX0gYWxyZWFkeSBleGlzdHMuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yZS5hZGQodmFsdWUsIGtleSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0KGtleTogSURCVmFsaWRLZXksIHN0b3JlTmFtZTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fZGIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgQ2FjaGVFcnJvcih0aGlzLl9pbmRleE5hbWUsIHN0b3JlTmFtZSwgJ0RhdGFiYXNlIGlzIG5vdCBpbml0aWFsaXplZC4nKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IHsgdHJhbnNhY3Rpb24sIHN0b3JlIH0gPSB0aGlzLm5ld1RyYW5zYWN0aW9uKHN0b3JlTmFtZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBQcm9wYWdhdGUgZXJyb3JzIHVwd2FyZHMsIG90aGVyd2lzZSB0aGV5IGZhaWwgc2lsZW50bHlcbiAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGNvbnN0IGdldFJlcXVlc3QgPSBzdG9yZS5nZXQoa2V5KTtcbiAgICAgICAgICAgICAgICBnZXRSZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgZ2V0UmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGRlbChrZXk6IElEQlZhbGlkS2V5LCBzdG9yZU5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHRyYW5zYWN0aW9uLCBzdG9yZSB9ID0gdGhpcy5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpO1xuXG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChldmVudC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHN0b3JlLmRlbGV0ZShrZXkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMga2V5cyhzdG9yZU5hbWU6IHN0cmluZyk6IFByb21pc2U8SURCVmFsaWRLZXlbXT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8SURCVmFsaWRLZXlbXT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHRyYW5zYWN0aW9uLCBzdG9yZSB9ID0gdGhpcy5uZXdUcmFuc2FjdGlvbihzdG9yZU5hbWUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGtleXNSZXF1ZXN0ID0gc3RvcmUuZ2V0QWxsS2V5cygpO1xuXG4gICAgICAgICAgICAgICAga2V5c1JlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGtleXNSZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBrZXlzUmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGV2ZW50LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGNscihzdG9yZU5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0b3JlIH0gPSB0aGlzLm5ld1RyYW5zYWN0aW9uKHN0b3JlTmFtZSk7XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IHN0b3JlLmdldEFsbEtleXMoKTtcbiAgICAgICAgICAgICAgICBrZXlzLm9uc3VjY2VzcyA9IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJvbWlzZXM6IFByb21pc2U8dm9pZD5bXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzLnJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh0aGlzLmRlbChrZXksIHN0b3JlTmFtZSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uL1NldHRpbmdzJztcbmltcG9ydCBDYWNoZUhlbHBlciBmcm9tICcuL0NhY2hlSGVscGVyJztcblxuLyoqXG4gKiBNZXRhIGluZm9ybWF0aW9uIGFib3V0IGEgY2FjaGUgZW50cnlcbiAqIEBwcml2YXRlXG4gKi9cbnR5cGUgQ2FjaGVEYXRhID0ge1xuICAgIC8qKlxuICAgICAqIFRoZSBzaXplIGluIGJ5dGVzIHRoaXMgY2FjaGUgZW50cnkgdGFrZXMgdXAuXG4gICAgICovXG4gICAgc2l6ZTogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIFRoZSBkYXRlIHRoZSBjYWNoZSB3YXMgbGFzdCBhY2Nlc3NlZCwgcmVwcmVzZW50ZWQgYnkgYSBJU08gc3RyaW5nLlxuICAgICAqL1xuICAgIGRhdGVBY2Nlc3NlZDogc3RyaW5nO1xufTtcblxuLyoqXG4gKiBIYW5kbGVzIGNhY2hpbmcgZm9yIFBERnNcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBERkNhY2hlIHtcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIlN0YXRpYyBQcm9wZXJ0aWVzXCI+XG4gICAgLyoqXG4gICAgICogTWF4IHNpemUgb2YgdGhlIGNhY2hlIGZvciB0aGUgYWN0aXZlIHVzZXIsIGRlZmF1bHRzIHRvIDI1NiBNQi5cbiAgICAgKi9cbiAgICBwcml2YXRlIHN0YXRpYyBnZXQgTUFYX0JZVEVTKCkge1xuICAgICAgICByZXR1cm4gU2V0dGluZ3MuZ2V0KFNldHRpbmdzLlNFVFRJTkdTX0tFWS5DQUNIRV9TSVpFKSAqIDIgKiogMjA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgSURCX05BTUU6IHN0cmluZyA9ICdQREZvdW5kcnknO1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IElEQl9WRVJTSU9OOiBudW1iZXIgPSAxO1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgQ0FDSEU6IHN0cmluZyA9IGBDYWNoZWA7XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUVUQTogc3RyaW5nID0gYE1ldGFgO1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2NhY2hlSGVscGVyOiBDYWNoZUhlbHBlcjtcbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBpbml0aWFsaXplKCkge1xuICAgICAgICBQREZDYWNoZS5fY2FjaGVIZWxwZXIgPSBhd2FpdCBDYWNoZUhlbHBlci5jcmVhdGVBbmRPcGVuKFBERkNhY2hlLklEQl9OQU1FLCBbUERGQ2FjaGUuQ0FDSEUsIFBERkNhY2hlLk1FVEFdLCBQREZDYWNoZS5JREJfVkVSU0lPTik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IG1ldGEgaW5mb3JtYXRpb24gYWJvdXQgYSBwcm92aWRlZCBrZXkgKHVybCkuXG4gICAgICogQHBhcmFtIGtleVxuICAgICAqL1xuICAgIHB1YmxpYyBzdGF0aWMgYXN5bmMgZ2V0TWV0YShrZXk6IHN0cmluZyk6IFByb21pc2U8Q2FjaGVEYXRhIHwgbnVsbD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IFBERkNhY2hlLl9jYWNoZUhlbHBlci5nZXQoa2V5LCBQREZDYWNoZS5NRVRBKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IG1ldGEgaW5mb3JtYXRpb24gYWJvdXQgYSBwcm92aWRlZCBrZXkgKHVybCkuIFNlZSB7QGxpbmsgQ2FjaGVEYXRhfS5cbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICogQHBhcmFtIG1ldGFcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHNldE1ldGEoa2V5OiBzdHJpbmcsIG1ldGE6IENhY2hlRGF0YSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCBQREZDYWNoZS5fY2FjaGVIZWxwZXIuc2V0KGtleSwgbWV0YSwgUERGQ2FjaGUuTUVUQSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBieXRlIGFycmF5IHJlcHJlc2VudGluZyB0aGUga2V5ICh1cmwpIGZyb20gdGhlIHVzZXIncyBjYWNoZS5cbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRDYWNoZShrZXk6IHN0cmluZyk6IFByb21pc2U8VWludDhBcnJheSB8IG51bGw+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGJ5dGVzID0gYXdhaXQgUERGQ2FjaGUuX2NhY2hlSGVscGVyLmdldChrZXksIFBERkNhY2hlLkNBQ0hFKTtcbiAgICAgICAgICAgIGNvbnN0IG1ldGE6IENhY2hlRGF0YSA9IHtcbiAgICAgICAgICAgICAgICBkYXRlQWNjZXNzZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBzaXplOiBieXRlcy5sZW5ndGgsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgUERGQ2FjaGUuc2V0TWV0YShrZXksIG1ldGEpO1xuXG4gICAgICAgICAgICByZXR1cm4gYnl0ZXM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIGNhY2hlIGZvciB0aGUgc3BlY2lmaWMga2V5ICh1cmwpIHRvIHRoZSBwcm92aWRlZCBieXRlIGFycmF5LlxuICAgICAqIEBwYXJhbSBrZXlcbiAgICAgKiBAcGFyYW0gYnl0ZXNcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIHNldENhY2hlKGtleTogc3RyaW5nLCBieXRlczogVWludDhBcnJheSkge1xuICAgICAgICBjb25zdCBtZXRhOiBDYWNoZURhdGEgPSB7XG4gICAgICAgICAgICBkYXRlQWNjZXNzZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIHNpemU6IGJ5dGVzLmxlbmd0aCxcbiAgICAgICAgfTtcblxuICAgICAgICBhd2FpdCBQREZDYWNoZS5fY2FjaGVIZWxwZXIuc2V0KGtleSwgYnl0ZXMsIFBERkNhY2hlLkNBQ0hFLCB0cnVlKTtcbiAgICAgICAgYXdhaXQgUERGQ2FjaGUuc2V0TWV0YShrZXksIG1ldGEpO1xuICAgICAgICBhd2FpdCB0aGlzLnBydW5lKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJlbG9hZCB0aGUgUERGIGF0IHRoZSBzcGVjaWZpZWQga2V5ICh1cmwpLCBjYWNoaW5nIGl0IGltbWVkaWF0ZWx5LlxuICAgICAqIEBwYXJhbSBrZXlcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHByZWxvYWQoa2V5OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KGFzeW5jIChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZEJ5dGVzID0gYXdhaXQgUERGQ2FjaGUuZ2V0Q2FjaGUoa2V5KTtcbiAgICAgICAgICAgIGlmIChjYWNoZWRCeXRlcyAhPT0gbnVsbCAmJiBjYWNoZWRCeXRlcy5ieXRlTGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goa2V5KTtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZldGNoZWRCeXRlcyA9IG5ldyBVaW50OEFycmF5KGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCkpO1xuICAgICAgICAgICAgICAgIGlmIChmZXRjaGVkQnl0ZXMuYnl0ZUxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgUERGQ2FjaGUuc2V0Q2FjaGUoa2V5LCBmZXRjaGVkQnl0ZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0ZldGNoIGZhaWxlZC4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdCgnRmV0Y2ggZmFpbGVkLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcnVuZSB0aGUgYWN0aXZlIHVzZXIncyBjYWNoZSB1bnRpbCBpdCBpcyBiZWxvdyB0aGUgdXNlcidzIGNhY2hlIHNpemUgbGltaXQuXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBwcnVuZSgpIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IGF3YWl0IHRoaXMuX2NhY2hlSGVscGVyLmtleXMoUERGQ2FjaGUuTUVUQSk7XG5cbiAgICAgICAgbGV0IHRvdGFsQnl0ZXMgPSAwO1xuICAgICAgICBsZXQgbWV0YXM6IGFueVtdID0gW107XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICAgICAgICAgIGNvbnN0IG1ldGEgPSBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5nZXQoa2V5LCBQREZDYWNoZS5NRVRBKTtcbiAgICAgICAgICAgIG1ldGEuZGF0ZUFjY2Vzc2VkID0gRGF0ZS5wYXJzZShtZXRhLmRhdGVBY2Nlc3NlZCk7XG4gICAgICAgICAgICBtZXRhLnNpemUgPSBwYXJzZUludChtZXRhLnNpemUpO1xuXG4gICAgICAgICAgICB0b3RhbEJ5dGVzICs9IG1ldGEuc2l6ZTtcblxuICAgICAgICAgICAgbWV0YXMucHVzaCh7XG4gICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgIG1ldGEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIG1ldGFzID0gbWV0YXMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGEubWV0YS5kYXRlQWNjZXNzZWQgLSBiLm1ldGEuZGF0ZUFjY2Vzc2VkO1xuICAgICAgICB9KTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1ldGFzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodG90YWxCeXRlcyA8IFBERkNhY2hlLk1BWF9CWVRFUykge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBuZXh0ID0gbWV0YXNbaV07XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX2NhY2hlSGVscGVyLmRlbChuZXh0LmtleSwgUERGQ2FjaGUuTUVUQSk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5kZWwobmV4dC5rZXksIFBERkNhY2hlLkNBQ0hFKTtcblxuICAgICAgICAgICAgdG90YWxCeXRlcyAtPSBuZXh0Lm1ldGEuc2l6ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIHRoZSBQREYgY2FjaGVcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGNsZWFyKCkge1xuICAgICAgICBjb25zdCBrZXlzID0gYXdhaXQgdGhpcy5fY2FjaGVIZWxwZXIua2V5cyhQREZDYWNoZS5NRVRBKTtcblxuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9jYWNoZUhlbHBlci5kZWwoa2V5LCBQREZDYWNoZS5NRVRBKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX2NhY2hlSGVscGVyLmRlbChrZXksIFBERkNhY2hlLkNBQ0hFKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogQ2hhdCBjb21tYW5kIHByb2Nlc3NvclxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzIENoYXRDb21tYW5kIHtcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldHRlcnMgJiBTZXR0ZXJzXCI+XG5cbiAgICBwdWJsaWMgZ2V0IENvbW1hbmRQcmVmaXgoKSB7XG4gICAgICAgIHJldHVybiBgL3BkZm91bmRyeWA7XG4gICAgfVxuXG4gICAgcHVibGljIGFic3RyYWN0IGdldCBDb21tYW5kTmFtZSgpOiBzdHJpbmc7XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiSW5zdGFuY2UgTWV0aG9kc1wiPlxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSB0aGUgY29tbWFuZCwgcmV0dXJuaW5nIHRydWUgaWYgdGhlIGNvbW1hbmQgY29tcGxldGVzIHN1Y2Nlc3NmdWxseVxuICAgICAqIEBwYXJhbSBjb250ZW50XG4gICAgICovXG4gICAgcHVibGljIGV4ZWN1dGUoY29udGVudDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHJlYWxBcmdzID0gY29udGVudC5zcGxpdCgnICcpO1xuICAgICAgICBpZiAocmVhbEFyZ3NbMF0gIT09IHRoaXMuQ29tbWFuZFByZWZpeCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlYWxBcmdzWzFdICE9PSB0aGlzLkNvbW1hbmROYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwb3AgZmlyc3QgdHdvIGFyZ3NcbiAgICAgICAgcmVhbEFyZ3Muc2hpZnQoKTtcbiAgICAgICAgcmVhbEFyZ3Muc2hpZnQoKTtcblxuICAgICAgICB0aGlzLnJ1bihyZWFsQXJncylcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgbWVzc2FnZSA9IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLkNPTU1BTkRTLlN1Y2Nlc3MnKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5yZXBsYWNlKCckQ09NTUFORF9OQU1FJCcsIHRoaXMuQ29tbWFuZE5hbWUpO1xuICAgICAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnMuaW5mbyhtZXNzYWdlKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5DT01NQU5EUy5GYWlsdXJlJyk7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZSgnJENPTU1BTkRfTkFNRSQnLCB0aGlzLkNvbW1hbmROYW1lKTtcbiAgICAgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJ1biB0aGUgY29tbWFuZFxuICAgICAqIEBwYXJhbSBhcmdzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBydW4oYXJnczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+O1xuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IGdldFBERkRhdGEsIHNldFBERkRhdGEgfSBmcm9tICcuLi9VdGlsJztcbmltcG9ydCB7IFBERlR5cGUgfSBmcm9tICcuLi9jb21tb24vdHlwZXMvUERGVHlwZSc7XG5pbXBvcnQgQ2hhdENvbW1hbmQgZnJvbSAnLi9DaGF0Q29tbWFuZCc7XG5cbi8qKlxuICogRml4ZXMgbWlzc2luZyB0eXBlc1xuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpeE1pc3NpbmdUeXBlcyBleHRlbmRzIENoYXRDb21tYW5kIHtcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldHRlcnMgJiBTZXR0ZXJzXCI+XG5cbiAgICBnZXQgQ29tbWFuZE5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuICdmaXgtbWlzc2luZy10eXBlcyc7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiSW5zdGFuY2UgTWV0aG9kc1wiPlxuXG4gICAgcHJvdGVjdGVkIGFzeW5jIHJ1bihhcmdzOiBzdHJpbmdbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBsZXQgZml4ZWRQREZzID0gMDtcbiAgICAgICAgY29uc3Qgam91cm5hbHMgPSBnYW1lLmpvdXJuYWwuZmlsdGVyKChqZTogSm91cm5hbEVudHJ5KSA9PiBnZXRQREZEYXRhKGplKSAhPT0gdW5kZWZpbmVkICYmIGdldFBERkRhdGEoamUpPy50eXBlID09PSB1bmRlZmluZWQpIGFzIEpvdXJuYWxFbnRyeVtdO1xuICAgICAgICBmb3IgKGNvbnN0IGpvdXJuYWxFbnRyeSBvZiBqb3VybmFscykge1xuICAgICAgICAgICAgYXdhaXQgc2V0UERGRGF0YShqb3VybmFsRW50cnksIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBQREZUeXBlLlN0YXRpYyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZml4ZWRQREZzICs9IDE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHVpLmpvdXJuYWwucmVuZGVyKCk7XG5cbiAgICAgICAgaWYgKGZpeGVkUERGcyA+IDApIHtcbiAgICAgICAgICAgIHVpLm5vdGlmaWNhdGlvbnMuaW5mbyhnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5DT01NQU5EUy5GaXhNaXNzaW5nVHlwZXNTdWNjZXNzJykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucy5pbmZvKGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLkNPTU1BTkRTLkZpeE1pc3NpbmdUeXBlc0ZhaWx1cmUnKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IENoYXRDb21tYW5kIGZyb20gJy4vQ2hhdENvbW1hbmQnO1xuaW1wb3J0IFBERkNhY2hlIGZyb20gJy4uL2NhY2hlL1BERkNhY2hlJztcblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHVyZ2VDYWNoZSBleHRlbmRzIENoYXRDb21tYW5kIHtcbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldHRlcnMgJiBTZXR0ZXJzXCI+XG5cbiAgICBwdWJsaWMgZ2V0IENvbW1hbmROYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAncHVyZ2UtY2FjaGUnO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkluc3RhbmNlIE1ldGhvZHNcIj5cblxuICAgIHByb3RlY3RlZCBhc3luYyBydW4oYXJnczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgUERGQ2FjaGUuY2xlYXIoKTtcblxuICAgICAgICB1aS5ub3RpZmljYXRpb25zLmluZm8oZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuQ09NTUFORFMuUHVyZ2VDYWNoZVN1Y2Nlc3MnKSk7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbi8qKlxuICogVGhlIGRvbWFpbiB3aGl0ZSBsaXN0IGluY2x1ZGVzIGRvbWFpbnMgdGhhdCBhcmUgYWxsb3dlZCBvdGhlciB0aGFuICdsb2NhbGhvc3QnIG9yXG4gKiAgdGhlIGVxdWl2YWxlbnQgZG9tYWluIHRoZSB1c2VyIGlzIHJ1bm5pbmcgdGhlIHNlcnZlciBvbi5cbiAqL1xuZXhwb3J0IGNvbnN0IERPTUFJTl9XSElURUxJU1QgPSBbJ2FtYXpvbmF3cy5jb20nLCAnZGlnaXRhbG9jZWFuc3BhY2VzLmNvbScsICdhc3NldHMuZm9yZ2UtdnR0LmNvbScsICd3YXNhYmlzeXMuY29tJywgJ2JhY2tibGF6ZWIyLmNvbSddO1xuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IEFwaSBmcm9tICcuLi8uLi9BcGknO1xuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uLy4uL1NldHRpbmdzJztcblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXZlbnRTdG9yZTxUS2V5cyBleHRlbmRzIHN0cmluZyA9IHN0cmluZz4ge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX21hcDogTWFwPHN0cmluZywgRnVuY3Rpb25bXT47XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuX21hcCA9IG5ldyBNYXA8c3RyaW5nLCBGdW5jdGlvbltdPigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFR1cm4gb24gYW4gZXZlbnQgY2FsbGJhY2sgZm9yIHRoZSBzcGVjaWZpZWQgZXZlbnQuXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZVxuICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAqL1xuICAgIHB1YmxpYyBvbihldmVudE5hbWU6IFRLZXlzLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKCF0aGlzLl9tYXAuaGFzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgIHRoaXMuX21hcC5zZXQoZXZlbnROYW1lLCBbXSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSB0aGlzLl9tYXAuZ2V0KGV2ZW50TmFtZSkgYXMgRnVuY3Rpb25bXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFja3NbaV0gPT09IGNhbGxiYWNrKSByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgY2FsbGJhY2tzLnB1c2goY2FsbGJhY2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExpa2Uge0BzZWUgb259IGJ1dCBvbmx5IGZpcmVzIG9uY2UuXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZVxuICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAqL1xuICAgIHB1YmxpYyBvbmNlKGV2ZW50TmFtZTogVEtleXMsIGNhbGxiYWNrOiBGdW5jdGlvbikge1xuICAgICAgICBjb25zdCB0aGF0ID0gdGhpcztcbiAgICAgICAgY29uc3Qgd3JhcHBlciA9IGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzKTtcbiAgICAgICAgICAgIHRoYXQub2ZmKGV2ZW50TmFtZSwgd3JhcHBlcik7XG4gICAgICAgIH07XG4gICAgICAgIHRoYXQub24oZXZlbnROYW1lLCB3cmFwcGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUdXJuIG9mZiBhbiBldmVudCBjYWxsYmFjayBmb3IgdGhlIHNwZWNpZmllZCBldmVudC5cbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICovXG4gICAgcHVibGljIG9mZihldmVudE5hbWU6IFRLZXlzLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcbiAgICAgICAgaWYgKCF0aGlzLl9tYXAuaGFzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgIHRoaXMuX21hcC5zZXQoZXZlbnROYW1lLCBbXSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYWxsYmFja3MgPSB0aGlzLl9tYXAuZ2V0KGV2ZW50TmFtZSkgYXMgRnVuY3Rpb25bXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFja3NbaV0gPT09IGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2tzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcmUgYW4gZXZlbnQgYW5kIGZvcndhcmQgdGhlIGFyZ3MgdG8gYWxsIGhhbmRsZXJzXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZVxuICAgICAqIEBwYXJhbSBhcmdzXG4gICAgICovXG4gICAgcHVibGljIGZpcmUoZXZlbnROYW1lOiBUS2V5cywgLi4uYXJncykge1xuICAgICAgICBpZiAoQXBpLkRFQlVHLkVWRU5UUykge1xuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhgJHtTZXR0aW5ncy5NT0RVTEVfTkFNRS50b1VwcGVyQ2FzZSgpfTo6JHtldmVudE5hbWV9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKGFyZ3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCF0aGlzLl9tYXAuaGFzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNhbGxiYWNrcyA9IHRoaXMuX21hcC5nZXQoZXZlbnROYW1lKSBhcyBGdW5jdGlvbltdO1xuICAgICAgICBmb3IgKGNvbnN0IGNhbGxiYWNrIG9mIGNhbGxiYWNrcykge1xuICAgICAgICAgICAgY2FsbGJhY2soLi4uYXJncyk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgQXBpIGZyb20gJy4uLy4uL0FwaSc7XG5cbi8qKlxuICogR2l0aHViIGxpbmsgaGVhZGVyIGJ1dHRvbi5cbiAqIEBpbnRlcm5hbFxuICovXG5leHBvcnQgY29uc3QgQlVUVE9OX0dJVEhVQiA9IHtcbiAgICBjbGFzczogJ3BkZi1zaGVldC1naXRodWInLFxuICAgIGljb246ICdmYXMgZmEtZXh0ZXJuYWwtbGluay1hbHQnLFxuICAgIGxhYmVsOiAnUERGb3VuZHJ5JyxcbiAgICBvbmNsaWNrOiAoKSA9PiB3aW5kb3cub3BlbignaHR0cHM6Ly9naXRodWIuY29tL0RqcGhvZW5peDcxOS9QREZvdW5kcnknLCAnX2JsYW5rJyksXG59O1xuXG4vKipcbiAqIE1hbnVhbCBsaW5rIGhlYWRlciBidXR0b24uXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGNvbnN0IEJVVFRPTl9IRUxQID0ge1xuICAgIGNsYXNzOiAncGRmLXNoZWV0LW1hbnVhbCcsXG4gICAgaWNvbjogJ2ZhcyBmYS1xdWVzdGlvbi1jaXJjbGUnLFxuICAgIGxhYmVsOiAnSGVscCcsXG4gICAgb25jbGljazogKCkgPT4gQXBpLnNob3dIZWxwKCksXG59O1xuXG4vKipcbiAqIFNoYW1lbGVzcyBzaGlsbCBsaW5rXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGNvbnN0IEJVVFRPTl9LT0ZJID0ge1xuICAgIGNsYXNzOiAncGRmLXNoZWV0LWtvZmknLFxuICAgIGljb246ICdmYXMgZmEtY29mZmVlJyxcbiAgICBsYWJlbDogJycsXG4gICAgb25jbGljazogKCkgPT4gd2luZG93Lm9wZW4oJ2h0dHBzOi8va28tZmkuY29tL2Rqc21vZHMnLCAnX2JsYW5rJyksXG59O1xuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuLyoqXG4gKiBUaGUgdHlwZSBvZiBQREYgZmlsZSwgYXMgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyLlxuICogQG1vZHVsZSBBUElcbiAqL1xuZXhwb3J0IGVudW0gUERGVHlwZSB7XG4gICAgLyoqXG4gICAgICogU3RhdGljIFBERnMgY29udGFpbiBubyBmb3JtIGZpbGxhYmxlIGVsZW1lbnRzLlxuICAgICAqL1xuICAgIFN0YXRpYyA9ICdzdGF0aWMnLFxuICAgIC8qKlxuICAgICAqIEZpbGxhYmxlIFBERnMgYXJlIG5vdCBsaW5rZWQgdG8gYWN0b3Igc2hlZXRzLCBidXQgZG8gY29udGFpbiBmb3JtIGZpbGxhYmxlIGVsZW1lbnRzLlxuICAgICAqL1xuICAgIEZpbGxhYmxlID0gJ2ZpbGxhYmxlJyxcbiAgICAvKipcbiAgICAgKiBBY3Rvci1saW5rZWQgUERGcyBzdG9yZSB0aGVpciBkYXRhIG9uIHRoZSBhY3Rvciwgc28gdGhleSBjYW4gcmVwcmVzZW50IGFjdG9ycy5cbiAgICAgKi9cbiAgICBBY3RvciA9ICdhY3RvcicsXG59XG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgQXBpIGZyb20gJy4uL0FwaSc7XG5cbi8qKlxuICogQHByaXZhdGVcbiAqIEVucmljaGVzIFRpbnlNQ0UgZWRpdG9yIGNvbnRlbnRcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSFRNTEVucmljaGVyIHtcbiAgICBwdWJsaWMgc3RhdGljIHBhdGNoRW5yaWNoKCkge1xuICAgICAgICBjb25zdCBvbGRFbnJpY2ggPSBUZXh0RWRpdG9yLmVucmljaEhUTUw7XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBUZXh0RWRpdG9yLmVucmljaEhUTUwgPSBmdW5jdGlvbiAoaHRtbDogc3RyaW5nLCBvcHRpb25zOiBhbnkpIHtcbiAgICAgICAgICAgIGh0bWwgPSBvbGRFbnJpY2guYXBwbHkodGhpcywgW2h0bWwsIG9wdGlvbnNdKTtcbiAgICAgICAgICAgIGh0bWwgPSBIVE1MRW5yaWNoZXIuZW5yaWNoQWxsKGh0bWwpO1xuICAgICAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBiaW5kUmljaFRleHRMaW5rcyhodG1sOiBKUXVlcnkpIHtcbiAgICAgICAgaHRtbC5maW5kKCdhLnBkZm91bmRyeS1saW5rJykub24oJ2NsaWNrJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICAvLyBUaGlzIHdpbGwgYWx3YXlzIGJlIGFuIGFuY2hvclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gJChldmVudC5jdXJyZW50VGFyZ2V0IGFzIEhUTUxBbmNob3JFbGVtZW50KTtcbiAgICAgICAgICAgIGNvbnN0IHJlZiA9IHRhcmdldC5kYXRhKCdyZWYnKSBhcyBzdHJpbmc7XG4gICAgICAgICAgICBjb25zdCBwYWdlID0gdGFyZ2V0LmRhdGEoJ3BhZ2UnKSBhcyBudW1iZXI7XG5cbiAgICAgICAgICAgIC8vIHJlZiBjYW4gbWF0Y2ggbmFtZSBvciBjb2RlXG4gICAgICAgICAgICBsZXQgcGRmRGF0YSA9IEFwaS5maW5kUERGRGF0YSgoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLm5hbWUgPT09IHJlZiB8fCBkYXRhLmNvZGUgPT09IHJlZjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIXBkZkRhdGEpIHtcbiAgICAgICAgICAgICAgICB1aS5ub3RpZmljYXRpb25zLmVycm9yKGBVbmFibGUgdG8gZmluZCBhIFBERiB3aXRoIGEgbmFtZSBvciBjb2RlIG1hdGNoaW5nICR7cmVmfS5gKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwYWdlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgQXBpLm9wZW5QREYocGRmRGF0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIEFwaS5vcGVuUERGKHBkZkRhdGEsIHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZmlyc3QgQFBERiBsaW5rIGluIHRoZSB0ZXh0IHdpdGggYSByaWNoIGxpbmsuXG4gICAgICogQHBhcmFtIHRleHRcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGVucmljaCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBzUG9zID0gdGV4dC5pbmRleE9mKCdAJyk7XG4gICAgICAgIGNvbnN0IGVQb3MgPSB0ZXh0LmluZGV4T2YoJ30nLCBzUG9zKTtcblxuICAgICAgICBjb25zdCBlbnJpY2hNZSA9IHRleHQuc2xpY2Uoc1BvcywgZVBvcyArIDEpO1xuXG4gICAgICAgIGNvbnN0IGxCcmFja2V0ID0gZW5yaWNoTWUuaW5kZXhPZignWycpO1xuICAgICAgICBjb25zdCByQnJhY2tldCA9IGVucmljaE1lLmluZGV4T2YoJ10nKTtcbiAgICAgICAgY29uc3QgbEN1cmx5ID0gZW5yaWNoTWUuaW5kZXhPZigneycpO1xuICAgICAgICBjb25zdCByQ3VybHkgPSBlbnJpY2hNZS5pbmRleE9mKCd9Jyk7XG5cbiAgICAgICAgLy8gUmVxdWlyZWQgY2hhcmFjdGVyIGlzIG1pc3NpbmdcbiAgICAgICAgaWYgKGxCcmFja2V0ID09PSAtMSB8fCByQnJhY2tldCA9PT0gLTEgfHwgbEN1cmx5ID09PSAtMSB8fCByQ3VybHkgPT09IC0xKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRU5SSUNILkludmFsaWRGb3JtYXQnKSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gT3JkZXIgaXMgbm90IGNvcnJlY3RcbiAgICAgICAgaWYgKHJDdXJseSA8IGxDdXJseSB8fCBsQ3VybHkgPCByQnJhY2tldCB8fCByQnJhY2tldCA8IGxCcmFja2V0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRU5SSUNILkludmFsaWRGb3JtYXQnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBvcHRpb25zID0gZW5yaWNoTWUuc2xpY2UobEJyYWNrZXQgKyAxLCByQnJhY2tldCk7XG4gICAgICAgIC8vIE11bHRpcGxlIGRpdmlkZXJzIGFyZSBub3Qgc3VwcG9ydGVkXG4gICAgICAgIGlmIChvcHRpb25zLmluZGV4T2YoJ3wnKSAhPT0gb3B0aW9ucy5sYXN0SW5kZXhPZignfCcpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRU5SSUNILkludmFsaWRGb3JtYXQnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbGlua1RleHQgPSBlbnJpY2hNZS5zbGljZShsQ3VybHkgKyAxLCByQ3VybHkpO1xuICAgICAgICAvLyBFbXB0eSBuYW1lcyBhcmUgbm90IHN1cHBvcnRlZFxuICAgICAgICBpZiAobGlua1RleHQgPT09IHVuZGVmaW5lZCB8fCBsaW5rVGV4dCA9PT0gJycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5FTlJJQ0guRW1wdHlMaW5rVGV4dCcpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBwYWdlTnVtYmVyID0gMDtcbiAgICAgICAgY29uc3QgW25hbWVPckNvZGUsIHF1ZXJ5U3RyaW5nXSA9IG9wdGlvbnMuc3BsaXQoJ3wnKTtcblxuICAgICAgICAvLyBHZXR0aW5nIHRoZSBQREYgd2l0aG91dCBpbnZpc2libGUgUERGcyB0byBjaGVjayBwZXJtaXNzaW9uc1xuICAgICAgICBsZXQgcGRmRGF0YSA9IEFwaS5maW5kUERGRGF0YSgoZGF0YSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGEubmFtZSA9PT0gbmFtZU9yQ29kZSB8fCBkYXRhLmNvZGUgPT09IG5hbWVPckNvZGU7XG4gICAgICAgIH0sIGZhbHNlKTtcblxuICAgICAgICBpZiAocGRmRGF0YSkge1xuICAgICAgICAgICAgLy8gQ2FzZSAxIC0gVXNlciBoYXMgcGVybWlzc2lvbnMgdG8gc2VlIHRoZSBQREZcbiAgICAgICAgICAgIGlmIChxdWVyeVN0cmluZyAhPT0gdW5kZWZpbmVkICYmIHF1ZXJ5U3RyaW5nICE9PSAnJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtfLCBwYWdlU3RyaW5nXSA9IHF1ZXJ5U3RyaW5nLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZU51bWJlciA9IHBhcnNlSW50KHBhZ2VTdHJpbmcpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBwYWdlIG51bWJlclxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHBhZ2VOdW1iZXIgPCAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdQREZPVU5EUlkuRVJST1IuUGFnZU11c3RCZVBvc2l0aXZlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGkxOG5PcGVuID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRU5SSUNILkxpbmtUaXRsZU9wZW4nKTtcbiAgICAgICAgICAgIGNvbnN0IGkxOG5QYWdlID0gZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuRU5SSUNILkxpbmtUaXRsZVBhZ2UnKTtcbiAgICAgICAgICAgIGNvbnN0IGxpbmtUaXRsZSA9IGAke2kxOG5PcGVufSAke25hbWVPckNvZGV9ICR7aTE4blBhZ2V9ICR7cGFnZU51bWJlcn1gO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYDxhIGNsYXNzPVwicGRmb3VuZHJ5LWxpbmtcIiB0aXRsZT1cIiR7bGlua1RpdGxlfVwiIGRhdGEtcmVmPVwiJHtuYW1lT3JDb2RlfVwiIGRhdGEtcGFnZT1cIiR7cGFnZU51bWJlcn1cIj4ke2xpbmtUZXh0fTwvYT5gO1xuXG4gICAgICAgICAgICByZXR1cm4gdGV4dC5zbGljZSgwLCBzUG9zKSArIHJlc3VsdCArIHRleHQuc2xpY2UoZVBvcyArIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gQ2FzZSAyIC0gVXNlciBkb2VzIG5vdCBoYXZlIHBlcm1pc3Npb25zIHRvIHNlZSB0aGUgUERGXG4gICAgICAgICAgICByZXR1cm4gdGV4dC5zbGljZSgwLCBzUG9zKSArIGxpbmtUZXh0ICsgdGV4dC5zbGljZShlUG9zICsgMSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIGFsbCByaWNoIHRleHQgbWFya3VwIHdpdGggYXBwcm9wcmlhdGUgcmljaCB0ZXh0IEhUTUwgaW4gdGhlIHNwZWNpZmllZCB0ZXh0LlxuICAgICAqIEBwYXJhbSB0ZXh0XG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBlbnJpY2hBbGwodGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgd2hpbGUgKHRleHQuaW5jbHVkZXMoJ0BQREYnKSkge1xuICAgICAgICAgICAgdGV4dCA9IEhUTUxFbnJpY2hlci5lbnJpY2godGV4dCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG59XG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBnZXRQREZEYXRhLCBpc0VudGl0eVBERiB9IGZyb20gJy4uL1V0aWwnO1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKiBBIHBsdWdpbiBmb3IgVGlueU1DRSB0aGF0IGhhbmRsZXMgRHJhZyArIERyb3BcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGlueU1DRVBsdWdpbiB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgcGx1Z2luTmFtZSA9ICdQREZvdW5kcnlfSFRNTEVucmljaF9Ecm9wJztcblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIHBsdWdpbiB3aXRoIEZvdW5kcnkgKyBUaW55TUNFXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBSZWdpc3RlcigpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aW55TUNFLlBsdWdpbk1hbmFnZXIuYWRkKFRpbnlNQ0VQbHVnaW4ucGx1Z2luTmFtZSwgZnVuY3Rpb24gKGVkaXRvcikge1xuICAgICAgICAgICAgZWRpdG9yLm9uKCdCZWZvcmVTZXRDb250ZW50JywgKGV2ZW50KSA9PiBUaW55TUNFUGx1Z2luLkhhbmRsZShldmVudCkpO1xuICAgICAgICB9KTtcbiAgICAgICAgQ09ORklHLlRpbnlNQ0UucGx1Z2lucyA9IGAke1RpbnlNQ0VQbHVnaW4ucGx1Z2luTmFtZX0gJHtDT05GSUcuVGlueU1DRS5wbHVnaW5zfWA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgSGFuZGxlKGV2ZW50OiBhbnkpIHtcbiAgICAgICAgaWYgKGV2ZW50LmluaXRpYWwpIHJldHVybjtcbiAgICAgICAgaWYgKCFldmVudC5zZWxlY3Rpb24gfHwgZXZlbnQuc2V0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGluaXRpYWxDb250ZW50ID0gZXZlbnQuY29udGVudDtcblxuICAgICAgICBjb25zdCBsQnJhY2tldCA9IGluaXRpYWxDb250ZW50LmluZGV4T2YoJ1snKTtcbiAgICAgICAgY29uc3QgckJyYWNrZXQgPSBpbml0aWFsQ29udGVudC5pbmRleE9mKCddJyk7XG4gICAgICAgIGNvbnN0IGVudGl0eUlkID0gaW5pdGlhbENvbnRlbnQuc2xpY2UobEJyYWNrZXQgKyAxLCByQnJhY2tldCk7XG5cbiAgICAgICAgY29uc3QgZW50aXR5ID0gZ2FtZS5qb3VybmFsLmdldChlbnRpdHlJZCk7XG4gICAgICAgIGlmIChlbnRpdHkgPT09IHVuZGVmaW5lZCB8fCAhaXNFbnRpdHlQREYoZW50aXR5KSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcGRmRGF0YSA9IGdldFBERkRhdGEoZW50aXR5KTtcbiAgICAgICAgaWYgKHBkZkRhdGEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29kZU9yTmFtZSA9IHBkZkRhdGEuY29kZSA/IHBkZkRhdGEuY29kZSA6IHBkZkRhdGEubmFtZTtcblxuICAgICAgICBldmVudC5jb250ZW50ID0gYEBQREZbJHtjb2RlT3JOYW1lfXxwYWdlPTFdeyR7cGRmRGF0YS5uYW1lfX1gO1xuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IFBERkRhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMvUERGRGF0YSc7XG5pbXBvcnQgeyBQREZUeXBlIH0gZnJvbSAnLi4vY29tbW9uL3R5cGVzL1BERlR5cGUnO1xuaW1wb3J0IHsgc2V0UERGRGF0YSB9IGZyb20gJy4uL1V0aWwnO1xuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uL1NldHRpbmdzJztcblxuLyoqXG4gKiBTaG91bGQgdGhpcyBtaWdyYXRpb24gcnVuXG4gKiBAaW50ZXJuYWxcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxlZ2FjeU1pZ3JhdGlvblJlcXVpcmVkKCk6IGJvb2xlYW4ge1xuICAgIGlmIChTZXR0aW5ncy5nZXQoU2V0dGluZ3MuU0VUVElOR1NfS0VZLkRBVEFfVkVSU0lPTikgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGlmIChnYW1lLml0ZW1zLmZpbmQoKGk6IEl0ZW0pID0+IGkuZGF0YS50eXBlID09PSAnUERGb3VuZHJ5X1BERicpICE9PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFNldHRpbmdzLnNldChTZXR0aW5ncy5TRVRUSU5HU19LRVkuREFUQV9WRVJTSU9OLCAndjAuNi4wJyk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG4vKipcbiAqIE9wZW4gdGhlIG1pZ3JhdGlvbiB3aW5kb3cgZm9yIG1pZ3JhdGlvblxuICogQGludGVybmFsXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtaWdyYXRlTGVnYWN5KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTx2b2lkPihhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGxldCBkID0gbmV3IERpYWxvZyh7XG4gICAgICAgICAgICB0aXRsZTogJ1BERm91bmRyeTogTWlncmF0aW9uIFJlcXVpcmVkJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IFtcbiAgICAgICAgICAgICAgICAnPGgxPk1pZ3JhdGlvbiBSZXF1aXJlZDwvaDE+JyxcbiAgICAgICAgICAgICAgICAnPHA+UERGb3VuZHJ5IG11c3QgY29udmVydCBsZWdhY3kgaXRlbXMgdG8gdGhlIG5ldyBKb3VybmFsIGZvcm1hdDsgWW91IHdpbGwgbm90IGJlIGFibGUgdG8gdXNlIFBERm91bmRyeSB1bnRpbCB5b3UgZG8uPC9wPicsXG4gICAgICAgICAgICAgICAgJzxwPklmIHlvdSB3aXNoIHRvIGJhY2t1cCB5b3VyIHdvcmxkIC0ganVzdCBpbiBjYXNlIC0geW91IG1heSBkbyBzbyBub3cuPC9wPicsXG4gICAgICAgICAgICAgICAgJzxwPlBsZWFzZSBub3RlIGZvbGRlciBzdHJ1Y3R1cmUgd2lsbCBub3QgYmUgcHJlc2VydmVkLjwvcD4nLFxuICAgICAgICAgICAgXS5qb2luKCcnKSxcbiAgICAgICAgICAgIGJ1dHRvbnM6IHtcbiAgICAgICAgICAgICAgICBwcm9jZWVkOiB7XG4gICAgICAgICAgICAgICAgICAgIGljb246ICc8aSBjbGFzcz1cImZhcyBmYS1jaGVja1wiPjwvaT4nLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ01pZ3JhdGUgTm93JyxcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnZlcnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHJlc29sdmUoKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4gcmVqZWN0KCkpO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2FuY2VsOiB7XG4gICAgICAgICAgICAgICAgICAgIGljb246ICc8aSBjbGFzcz1cImZhcyBmYS10aW1lc1wiPjwvaT4nLFxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ1JlbWluZCBNZSBMYXRlcicsXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiByZXNvbHZlKCksXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWZhdWx0OiAnY2FuY2VsJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGQucmVuZGVyKHRydWUpO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIFJ1biB0aGUgY29udmVyc2lvblxuICogQGludGVybmFsXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNvbnZlcnQoKSB7XG4gICAgY29uc3QgaXRlbXMgPSBnYW1lLml0ZW1zLmZpbHRlcigoaTogSXRlbSkgPT4gaS5kYXRhLnR5cGUgPT09ICdQREZvdW5kcnlfUERGJykgYXMgSXRlbVtdO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xuICAgICAgICBsZXQgcGRmRGF0YSA9IGdldExlZ2FjeURhdGEoaXRlbSk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgcGVybWlzc2lvbiA9IGl0ZW0uZGF0YS5wZXJtaXNzaW9uO1xuICAgICAgICBjb25zdCBqb3VybmFsRW50cnkgPSAoYXdhaXQgSm91cm5hbEVudHJ5LmNyZWF0ZSh7XG4gICAgICAgICAgICBuYW1lOiBwZGZEYXRhLm5hbWUsXG4gICAgICAgICAgICBwZXJtaXNzaW9uLFxuICAgICAgICB9KSkgYXMgSm91cm5hbEVudHJ5O1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGRlbGV0ZSBwZGZEYXRhLm5hbWU7XG5cbiAgICAgICAgYXdhaXQgc2V0UERGRGF0YShqb3VybmFsRW50cnksIHBkZkRhdGEpO1xuICAgICAgICBhd2FpdCBpdGVtLmRlbGV0ZSh7fSk7XG4gICAgfVxuXG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIHVpLmpvdXJuYWwucmVuZGVyKCk7XG59XG5cbi8qKlxuICogR2V0IGxlZ2FjeSBQREYgZGF0YSAmIHR5cGVcbiAqIEBwYXJhbSBpdGVtXG4gKiBAaW50ZXJuYWxcbiAqL1xuZnVuY3Rpb24gZ2V0TGVnYWN5RGF0YShpdGVtOiBJdGVtKTogUERGRGF0YSB7XG4gICAgY29uc3QgdHlwZU1hcCA9IHtcbiAgICAgICAgUERGb3VuZHJ5X1BERjogUERGVHlwZS5TdGF0aWMsXG4gICAgICAgIFBERm91bmRyeV9GaWxsYWJsZVBERjogUERGVHlwZS5GaWxsYWJsZSxcbiAgICAgICAgUERGb3VuZHJ5X0ZpbGxhYmxlQWN0b3I6IFBERlR5cGUuQWN0b3IsXG4gICAgfTtcbiAgICAvLyBAdHMtaWdub3JlXG4gICAgbGV0IHR5cGUgPSB0eXBlTWFwW2l0ZW0uZGF0YS5kYXRhLnBkZl90eXBlXSA/PyBQREZUeXBlLlN0YXRpYztcbiAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBpdGVtLmRhdGEubmFtZSxcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB1cmw6IGl0ZW0uZGF0YS5kYXRhLnVybCxcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjb2RlOiBpdGVtLmRhdGEuZGF0YS5jb2RlLFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIG9mZnNldDogaXRlbS5kYXRhLmRhdGEub2Zmc2V0LFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNhY2hlOiBpdGVtLmRhdGEuZGF0YS5jYWNoZSxcbiAgICAgICAgdHlwZSxcbiAgICB9O1xufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFByZWxvYWRFdmVudCBmcm9tICcuL2V2ZW50cy9QcmVsb2FkRXZlbnQnO1xuaW1wb3J0IFN0YXRpY1ZpZXdlciBmcm9tICcuLi92aWV3ZXIvU3RhdGljVmlld2VyJztcbmltcG9ydCBBcGkgZnJvbSAnLi4vQXBpJztcbmltcG9ydCBTZXR0aW5ncyBmcm9tICcuLi9TZXR0aW5ncyc7XG5pbXBvcnQgU2V0Vmlld0V2ZW50IGZyb20gJy4vZXZlbnRzL1NldFZpZXdFdmVudCc7XG5pbXBvcnQgUERGQ2FjaGUgZnJvbSAnLi4vY2FjaGUvUERGQ2FjaGUnO1xuXG4vKipcbiAqIEBwcml2YXRlXG4gKi9cbmV4cG9ydCBjbGFzcyBTb2NrZXQge1xuICAgIHB1YmxpYyBzdGF0aWMgaW5pdGlhbGl6ZSgpIHtcbiAgICAgICAgLy8gQHRzLWlnbm9yZSBUT0RPXG4gICAgICAgIGdhbWUuc29ja2V0Lm9uKFNldHRpbmdzLlNPQ0tFVF9OQU1FLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyB1c2VySWRzLCB0eXBlLCBwYXlsb2FkIH0gPSBldmVudDtcbiAgICAgICAgICAgICAgICAvLyBudWxsID0gYWxsIHVzZXJzLCBvdGhlcndpc2UgY2hlY2sgaWYgdGhpcyBldmVudCBlZmZlY3RzIHVzXG4gICAgICAgICAgICAgICAgaWYgKHVzZXJJZHMgIT09IG51bGwgJiYgIXVzZXJJZHMuaW5jbHVkZXMoZ2FtZS51c2VySWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gU2V0Vmlld0V2ZW50LkVWRU5UX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgU29ja2V0LmhhbmRsZVNldFZpZXcocGF5bG9hZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFByZWxvYWRFdmVudC5FVkVOVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIFNvY2tldC5oYW5kbGVQcmVsb2FkUERGKHBheWxvYWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUuaW5jbHVkZXMoJ1BERk9VTkRSWScpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFdmVudCBvZiB0eXBlICR7dHlwZX0gaGFzIG5vIGhhbmRsZXIuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgLy8gUGFzc1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGhhbmRsZVNldFZpZXcoZGF0YTogYW55KSB7XG4gICAgICAgIGlmIChTZXR0aW5ncy5nZXQoU2V0dGluZ3MuU0VUVElOR1NfS0VZLkVYSVNUSU5HX1ZJRVdFUikpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGFwcElzVmlld2VyKGFwcDogQXBwbGljYXRpb24pOiBhcHAgaXMgU3RhdGljVmlld2VyIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXBwWydwZGZEYXRhJ10gIT09IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChjb25zdCBhcHAgb2YgT2JqZWN0LnZhbHVlcyh1aS53aW5kb3dzKSkge1xuICAgICAgICAgICAgICAgIGlmICghYXBwSXNWaWV3ZXIoYXBwKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBwZGZEYXRhID0gYXBwLnBkZkRhdGE7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEucGRmRGF0YS51cmwgPT09IHBkZkRhdGEudXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIGFwcC5wYWdlID0gZGF0YS5wYWdlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQXBwIG5vdCBmb3VuZCwgZmFsbCB0aHJvdWdoLlxuICAgICAgICB9XG4gICAgICAgIEFwaS5vcGVuUERGKGRhdGEucGRmRGF0YSwge1xuICAgICAgICAgICAgcGFnZTogZGF0YS5wYWdlLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGhhbmRsZVByZWxvYWRQREYoZGF0YTogYW55KSB7XG4gICAgICAgIFBERkNhY2hlLnByZWxvYWQoZGF0YS51cmwpO1xuICAgIH1cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBTb2NrZXRFdmVudCBmcm9tICcuL1NvY2tldEV2ZW50JztcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcmVsb2FkRXZlbnQgZXh0ZW5kcyBTb2NrZXRFdmVudCB7XG4gICAgcHVibGljIHN0YXRpYyBnZXQgRVZFTlRfVFlQRSgpIHtcbiAgICAgICAgcmV0dXJuIGAke3N1cGVyLkVWRU5UX1RZUEV9L1BSRUxPQURfUERGYDtcbiAgICB9XG5cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFByZWxvYWRFdmVudC5FVkVOVF9UWVBFO1xuICAgIH1cblxuICAgIHB1YmxpYyB1cmw6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHVzZXJJZHM6IHN0cmluZ1tdIHwgbnVsbCwgdXJsOiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIodXNlcklkcyk7XG5cbiAgICAgICAgdGhpcy51cmwgPSB1cmw7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldFBheWxvYWQoKTogYW55IHtcbiAgICAgICAgY29uc3QgcGF5bG9hZCA9IHN1cGVyLmdldFBheWxvYWQoKTtcbiAgICAgICAgcGF5bG9hZC51cmwgPSB0aGlzLnVybDtcbiAgICAgICAgcmV0dXJuIHBheWxvYWQ7XG4gICAgfVxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFNvY2tldEV2ZW50IGZyb20gJy4vU29ja2V0RXZlbnQnO1xuaW1wb3J0IHsgUERGRGF0YSB9IGZyb20gJy4uLy4uL2NvbW1vbi90eXBlcy9QREZEYXRhJztcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXRWaWV3RXZlbnQgZXh0ZW5kcyBTb2NrZXRFdmVudCB7XG4gICAgcHVibGljIHN0YXRpYyBnZXQgRVZFTlRfVFlQRSgpIHtcbiAgICAgICAgcmV0dXJuIGAke3N1cGVyLkVWRU5UX1RZUEV9L1NFVF9WSUVXYDtcbiAgICB9XG5cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIFNldFZpZXdFdmVudC5FVkVOVF9UWVBFO1xuICAgIH1cblxuICAgIHB1YmxpYyBwYWdlOiBudW1iZXI7XG4gICAgcHVibGljIHBkZkRhdGE6IFBERkRhdGE7XG5cbiAgICBjb25zdHJ1Y3Rvcih1c2VySWRzOiBzdHJpbmdbXSB8IG51bGwsIHBkZkRhdGE6IFBERkRhdGEsIHBhZ2U6IG51bWJlcikge1xuICAgICAgICBzdXBlcih1c2VySWRzKTtcblxuICAgICAgICB0aGlzLnBkZkRhdGEgPSBwZGZEYXRhO1xuICAgICAgICB0aGlzLnBhZ2UgPSBwYWdlO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRQYXlsb2FkKCkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gc3VwZXIuZ2V0UGF5bG9hZCgpO1xuICAgICAgICBwYXlsb2FkLnBkZkRhdGEgPSB0aGlzLnBkZkRhdGE7XG4gICAgICAgIHBheWxvYWQucGFnZSA9IHRoaXMucGFnZTtcbiAgICAgICAgcmV0dXJuIHBheWxvYWQ7XG4gICAgfVxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uLy4uL1NldHRpbmdzJztcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBTb2NrZXRFdmVudCB7XG4gICAgLyoqXG4gICAgICogVGhlIHR5cGUgb2YgdGhpcyBldmVudC5cbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIGdldCBFVkVOVF9UWVBFKCkge1xuICAgICAgICByZXR1cm4gJ1BERk9VTkRSWSc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHR5cGUgb2YgdGhpcyBldmVudC5cbiAgICAgKi9cbiAgICBwdWJsaWMgYWJzdHJhY3QgZ2V0IHR5cGUoKTtcblxuICAgIC8qKlxuICAgICAqIFRoZSB1c2VyIGlkcyB0aGF0IHNob3VsZCBoYW5kbGUgdGhpcyBldmVudC5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgdXNlcklkczogc3RyaW5nW10gfCBudWxsO1xuXG4gICAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKHVzZXJJZHM6IHN0cmluZ1tdIHwgbnVsbCkge1xuICAgICAgICB0aGlzLnVzZXJJZHMgPSB1c2VySWRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBhbnkgZGF0YSB0aGF0IHdpbGwgYmUgc2VudCB3aXRoIHRoZSBldmVudC5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZ2V0UGF5bG9hZCgpOiBhbnkge1xuICAgICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgcHVibGljIGVtaXQoKSB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmUgVE9ET1xuICAgICAgICBnYW1lLnNvY2tldC5lbWl0KFNldHRpbmdzLlNPQ0tFVF9OQU1FLCB7XG4gICAgICAgICAgICB0eXBlOiB0aGlzLnR5cGUsXG4gICAgICAgICAgICB1c2VySWRzOiB0aGlzLnVzZXJJZHMsXG4gICAgICAgICAgICBwYXlsb2FkOiB0aGlzLmdldFBheWxvYWQoKSxcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiLyogQ29weXJpZ2h0IDIwMjAgQW5kcmV3IEN1Y2NpbmVsbG9cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uL1NldHRpbmdzJztcbmltcG9ydCBBY3RvclNoZWV0U2VsZWN0IGZyb20gJy4uL2FwcC9BY3RvclNoZWV0U2VsZWN0JztcbmltcG9ydCB7IGdldEFic29sdXRlVVJMLCBnZXRQREZEYXRhIH0gZnJvbSAnLi4vVXRpbCc7XG5pbXBvcnQgUERGQWN0b3JTaGVldEFkYXB0ZXIgZnJvbSAnLi4vYXBwL1BERkFjdG9yU2hlZXRBZGFwdGVyJztcbmltcG9ydCBGaWxsYWJsZVZpZXdlciBmcm9tICcuL0ZpbGxhYmxlVmlld2VyJztcbmltcG9ydCB7IFBERkRhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMvUERGRGF0YSc7XG5pbXBvcnQgUERGQWN0b3JEYXRhQnJvd3NlciBmcm9tICcuLi9hcHAvUERGQWN0b3JEYXRhQnJvd3Nlcic7XG5cbi8qKlxuICogVGhlIEZpbGxhYmxlVmlld2VyIGNsYXNzIHByb3ZpZGVzIGFuIGludGVyZmFjZSBmb3IgZGlzcGxheWluZywgc2VyaWFsaXppbmcsIGFuZCBvYnNlcnZpbmcgZm9ybS1maWxsYWJsZSBQREZzLFxuICogIGFsbCB3aGlsZSBjb25uZWN0aW5nIHRoZWlyIGRhdGEgdG8gYSBzcGVjaWZpYyBhY3Rvci4gRXh0ZW5kcyB0aGUgRmlsbGFibGUgVmlld2VyLlxuICogQG1vZHVsZSBBUElcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQWN0b3JWaWV3ZXIgZXh0ZW5kcyBGaWxsYWJsZVZpZXdlciB7XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTdGF0aWMgUHJvcGVydGllc1wiPjwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTdGF0aWMgTWV0aG9kc1wiPjwvZWRpdG9yLWZvbGQ+XG5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIlByb3BlcnRpZXNcIj5cbiAgICBwcm90ZWN0ZWQgZG9jdW1lbnQ6IEFjdG9yO1xuICAgIHByb3RlY3RlZCBhY3RvclNoZWV0OiBQREZBY3RvclNoZWV0QWRhcHRlcjtcbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJDb25zdHJ1Y3RvciAmIEluaXRpYWxpemF0aW9uXCI+XG4gICAgY29uc3RydWN0b3IoYWN0b3I6IEFjdG9yLCBwZGZEYXRhOiBQREZEYXRhLCBzaGVldDogUERGQWN0b3JTaGVldEFkYXB0ZXIsIG9wdGlvbnM/OiBBcHBsaWNhdGlvbi5PcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKGFjdG9yLCBwZGZEYXRhLCBvcHRpb25zKTtcblxuICAgICAgICB0aGlzLmRvY3VtZW50ID0gYWN0b3I7XG4gICAgICAgIHRoaXMuYWN0b3JTaGVldCA9IHNoZWV0O1xuICAgIH1cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJHZXR0ZXJzICYgU2V0dGVyc1wiPlxuXG4gICAgZ2V0IHRpdGxlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50Lm5hbWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBVUkwgZm9yIHRoZSBjdXJyZW50IHNoZWV0IGZyb20gdGhlIGFjdG9yIGZsYWdzLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTaGVldElkKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50LmdldEZsYWcoU2V0dGluZ3MuTU9EVUxFX05BTUUsIFNldHRpbmdzLkZMQUdTX0tFWS5TSEVFVF9JRCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2F2ZSB0aGUgVVJMIGZvciB0aGUgY3VycmVudCBzaGVldCB0byB0aGUgYWN0b3IgZmxhZ3MuXG4gICAgICogQHBhcmFtIHZhbHVlXG4gICAgICovXG4gICAgcHVibGljIGFzeW5jIHNldFNoZWV0SWQodmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnQuc2V0RmxhZyhTZXR0aW5ncy5NT0RVTEVfTkFNRSwgU2V0dGluZ3MuRkxBR1NfS0VZLlNIRUVUX0lELCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudC51bnNldEZsYWcoU2V0dGluZ3MuTU9EVUxFX05BTUUsIFNldHRpbmdzLkZMQUdTX0tFWS5TSEVFVF9JRCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgcGRmIGRhdGEgZm9yIHRoZSBjdXJyZW50bHkgc2V0IFBERiBzaGVldCBpZFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRTaGVldFBkZigpOiBQREZEYXRhIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgY29uc3QgaWQgPSB0aGlzLmdldFNoZWV0SWQoKTtcbiAgICAgICAgaWYgKGlkID09PSB1bmRlZmluZWQpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmV0dXJuIGdldFBERkRhdGEoZ2FtZS5qb3VybmFsLmdldChpZCkpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBfZ2V0SGVhZGVyQnV0dG9ucygpOiBhbnlbXSB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbnM6IGFueVtdID0gW107XG5cbiAgICAgICAgYnV0dG9ucy51bnNoaWZ0KHtcbiAgICAgICAgICAgIGxhYmVsOiAnQ2xvc2UnLFxuICAgICAgICAgICAgY2xhc3M6ICdjbG9zZScsXG4gICAgICAgICAgICBpY29uOiAnZmFzIGZhLXRpbWVzJyxcbiAgICAgICAgICAgIC8vIGFjdG9yIHNoZWV0IGlzIHJlc3BvbnNpYmxlIGZvciBvdXIgY2xlYW4gdXBcbiAgICAgICAgICAgIG9uY2xpY2s6IChldikgPT4gdGhpcy5hY3RvclNoZWV0LmNsb3NlKCksXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgY2FuQ29uZmlndXJlID0gZ2FtZS51c2VyLmlzR00gfHwgKHRoaXMuZG9jdW1lbnQub3duZXIgJiYgZ2FtZS51c2VyLmNhbignVE9LRU5fQ09ORklHVVJFJykpO1xuICAgICAgICBpZiAodGhpcy5vcHRpb25zWydlZGl0YWJsZSddICYmIGNhbkNvbmZpZ3VyZSkge1xuICAgICAgICAgICAgYnV0dG9ucy51bnNoaWZ0KHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE8gMC44LnhcbiAgICAgICAgICAgICAgICBsYWJlbDogdGhpcy50b2tlbiA/ICdUb2tlbicgOiAnUHJvdG90eXBlIFRva2VuJyxcbiAgICAgICAgICAgICAgICBjbGFzczogJ2NvbmZpZ3VyZS10b2tlbicsXG4gICAgICAgICAgICAgICAgaWNvbjogJ2ZhcyBmYS11c2VyLWNpcmNsZScsXG4gICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZSBUT0RPIDAuOC54XG4gICAgICAgICAgICAgICAgb25jbGljazogKGV2KSA9PiB0aGlzLmFjdG9yU2hlZXQuX29uQ29uZmlndXJlVG9rZW4oZXYpLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGJ1dHRvbnMudW5zaGlmdCh7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdTaGVldCcsXG4gICAgICAgICAgICAgICAgY2xhc3M6ICdjb25maWd1cmUtc2hlZXQnLFxuICAgICAgICAgICAgICAgIGljb246ICdmYXMgZmEtY29nJyxcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE8gMC44LnhcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiAoZXYpID0+IHRoaXMuYWN0b3JTaGVldC5fb25Db25maWd1cmVTaGVldChldiksXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYnV0dG9ucy51bnNoaWZ0KHtcbiAgICAgICAgICAgICAgICBjbGFzczogJ3BkZi1zaGVldC1zZWxlY3QnLFxuICAgICAgICAgICAgICAgIGljb246ICdmYXMgZmEtdXNlci1jb2cnLFxuICAgICAgICAgICAgICAgIGxhYmVsOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuU2VsZWN0U2hlZXQnKSxcbiAgICAgICAgICAgICAgICBvbmNsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSB0aGlzLmdldFNoZWV0SWQoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3IEFjdG9yU2hlZXRTZWxlY3QoYXN5bmMgKGlkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNldFNoZWV0SWQoaWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hY3RvclNoZWV0LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzaGVldCA9IHRoaXMuZ2V0U2hlZXRQZGYoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzaGVldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuc2V0U2hlZXRJZCh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFjdG9yU2hlZXQucmVuZGVyKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9LCBjdXJyZW50KS5yZW5kZXIodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoZ2FtZS51c2VyLmlzR00pIHtcbiAgICAgICAgICAgICAgICBidXR0b25zLnVuc2hpZnQoe1xuICAgICAgICAgICAgICAgICAgICBjbGFzczogJ3BkZi1icm93c2UtZGF0YScsXG4gICAgICAgICAgICAgICAgICAgIGljb246ICdmYXMgZmEtc2VhcmNoJyxcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGdhbWUuaTE4bi5sb2NhbGl6ZSgnUERGT1VORFJZLlZJRVdFUi5JbnNwZWN0RGF0YScpLFxuICAgICAgICAgICAgICAgICAgICBvbmNsaWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgUERGQWN0b3JEYXRhQnJvd3Nlcih0aGlzLmRvY3VtZW50KS5yZW5kZXIodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYnV0dG9ucztcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJJbnN0YW5jZSBNZXRob2RzXCI+XG5cbiAgICBwcm90ZWN0ZWQgYXN5bmMgb25WaWV3ZXJSZWFkeSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgc3VwZXIub25WaWV3ZXJSZWFkeSgpO1xuICAgICAgICBjb25zdCBzaGVldCA9IHRoaXMuZ2V0U2hlZXRQZGYoKTtcbiAgICAgICAgaWYgKHNoZWV0KSB7XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBnZXRBYnNvbHV0ZVVSTChzaGVldC51cmwpO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5vcGVuKHVybCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBvcGVuKHBkZlNvdXJjZTogc3RyaW5nIHwgVWludDhBcnJheSwgcGFnZT86IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAocGRmU291cmNlIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBY3RvciBTaGVldHMgbXVzdCBiZSBvcGVuZWQgYnkgSUQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBzdXBlci5vcGVuKHBkZlNvdXJjZSwgcGFnZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE86IFRISVMgSVMgU1VQRVIgRlVDS0lORyBIQUNLIEFORCBUSEUgV0hPTEUgRkxPVyBORUVEUyBUTyBCRSBBTkFMWVpFRFxuICAgICAgICAgICAgaWYgKCEoYXdhaXQgc3JjRXhpc3RzKHBkZlNvdXJjZSkpKSB7XG4gICAgICAgICAgICAgICAgdWkubm90aWZpY2F0aW9ucy5lcnJvcihnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5FUlJPUi5GaWxlTm90Rm91bmQnKSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5zZXRTaGVldElkKHVuZGVmaW5lZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYWN0b3JTaGVldC5jbG9zZSgpO1xuICAgICAgICAgICAgbmV3IFBERkFjdG9yU2hlZXRBZGFwdGVyKHRoaXMuZG9jdW1lbnQsIHRoaXMub3B0aW9ucykucmVuZGVyKHRydWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbn1cbiIsIi8qIENvcHlyaWdodCAyMDIwIEFuZHJldyBDdWNjaW5lbGxvXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCBTZXR0aW5ncyBmcm9tICcuLi9TZXR0aW5ncyc7XG5pbXBvcnQgRXZlbnRTdG9yZSBmcm9tICcuLi9jb21tb24vaGVscGVycy9ldmVudHMnO1xuaW1wb3J0IHsgUERGVmlld2VyRXZlbnQgfSBmcm9tICcuLi9jb21tb24vdHlwZXMvUERGSG9va3MnO1xuaW1wb3J0IHsgUERGanNWaWV3ZXIgfSBmcm9tICcuLi9jb21tb24vdHlwZXMvUERGanNWaWV3ZXInO1xuaW1wb3J0IHsgUERGanNFdmVudEJ1cyB9IGZyb20gJy4uL2NvbW1vbi90eXBlcy9QREZqc0V2ZW50QnVzJztcbmltcG9ydCB7IEJVVFRPTl9HSVRIVUIsIEJVVFRPTl9LT0ZJIH0gZnJvbSAnLi4vY29tbW9uL2hlbHBlcnMvaGVhZGVyJztcbmltcG9ydCBBcGkgZnJvbSAnLi4vQXBpJztcbmltcG9ydCB7IGdldEFic29sdXRlVVJMIH0gZnJvbSAnLi4vVXRpbCc7XG5cbi8qKlxuICogVGhlIGJhc2Ugdmlld2VyIGNsYXNzIGZyb20gd2hpY2ggYWxsIG90aGVyIHR5cGVzIG9mIHZpZXdlcnMgaW5oZXJpdC5cbiAqIEBzZWUge0BsaW5rIFN0YXRpY1ZpZXdlcn1cbiAqIEBzZWUge0BsaW5rIEZpbGxhYmxlVmlld2VyfVxuICogQHNlZSB7QGxpbmsgQWN0b3JWaWV3ZXJ9XG4gKiBAbW9kdWxlIEFQSVxuICovXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBCYXNlVmlld2VyIGV4dGVuZHMgQXBwbGljYXRpb24ge1xuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiU3RhdGljIFByb3BlcnRpZXNcIj5cblxuICAgIHN0YXRpYyBnZXQgZGVmYXVsdE9wdGlvbnMoKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSBzdXBlci5kZWZhdWx0T3B0aW9ucztcbiAgICAgICAgb3B0aW9ucy5jbGFzc2VzID0gWydhcHAnLCAnd2luZG93LWFwcCcsICdwZGZvdW5kcnktdmlld2VyJ107XG4gICAgICAgIG9wdGlvbnMudGVtcGxhdGUgPSBgJHtTZXR0aW5ncy5QQVRIX1RFTVBMQVRFU30vYXBwL3ZpZXdlci9zdGF0aWMuaHRtbGA7XG4gICAgICAgIG9wdGlvbnMudGl0bGUgPSBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuVmlld1BERicpO1xuICAgICAgICBvcHRpb25zLndpZHRoID0gOC41ICogMTAwICsgNjQ7XG4gICAgICAgIG9wdGlvbnMuaGVpZ2h0ID0gMTEgKiAxMDAgKyA2NDtcbiAgICAgICAgb3B0aW9ucy5yZXNpemFibGUgPSB0cnVlO1xuICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJQcm9wZXJ0aWVzXCI+XG5cbiAgICBwcm90ZWN0ZWQgX2ZyYW1lOiBIVE1MSUZyYW1lRWxlbWVudDtcbiAgICBwcm90ZWN0ZWQgX3ZpZXdlcjogUERGanNWaWV3ZXI7XG4gICAgcHJvdGVjdGVkIF9ldmVudEJ1czogUERGanNFdmVudEJ1cztcbiAgICBwcm90ZWN0ZWQgX2V2ZW50U3RvcmU6IEV2ZW50U3RvcmU8UERGVmlld2VyRXZlbnQ+O1xuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiQ29uc3RydWN0b3IgJiBJbml0aWFsaXphdGlvblwiPlxuXG4gICAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKG9wdGlvbnM/OiBBcHBsaWNhdGlvbi5PcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgICAgICB0aGlzLl9ldmVudFN0b3JlID0gbmV3IEV2ZW50U3RvcmU8UERGVmlld2VyRXZlbnQ+KCk7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiSW5zdGFuY2UgTWV0aG9kc1wiPlxuXG4gICAgLyoqXG4gICAgICogRmluaXNoIHRoZSBkb3dubG9hZCBhbmQgcmV0dXJuIHRoZSBieXRlIGFycmF5IGZvciB0aGUgZmlsZS5cbiAgICAgKiBAcmV0dXJucyBBIHByb21pc2UgdGhhdCByZXNvbHZlcyB0byB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvVWludDhBcnJheXxVaW50OEFycmF5fVxuICAgICAqICBvZiBmaWxlIGJ5dGVzIG9uY2UgdGhhdCBkb3dubG9hZCBpcyBmaW5pc2hlZC4gWW91IGNhbiBwYXNzIHRoaXMgdG8gYSB2aWV3ZXIgdG8gb3BlbiBpdCwgb3IgZG8gc29tZXRoaW5nIGVsc2Ugd2l0aCBpdC5cbiAgICAgKi9cbiAgICBwdWJsaWMgZG93bmxvYWQoKTogUHJvbWlzZTxVaW50OEFycmF5PiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxVaW50OEFycmF5Pihhc3luYyAocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgdmlld2VyID0gYXdhaXQgdGhpcy5nZXRWaWV3ZXIoKTtcbiAgICAgICAgICAgIGxldCB0aW1lb3V0O1xuICAgICAgICAgICAgY29uc3QgcmV0dXJuT3JXYWl0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2aWV3ZXIuZG93bmxvYWRDb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHZpZXdlci5wZGZEb2N1bWVudC5nZXREYXRhKCkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQocmV0dXJuT3JXYWl0LCA1MCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuT3JXYWl0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW4gYSBQREZcbiAgICAgKiBAcGFyYW0gcGRmU291cmNlIEEgVVJMIG9yIGJ5dGUgYXJyYXkgdG8gb3Blbi5cbiAgICAgKiBAcGFyYW0gcGFnZSBUaGUgaW5pdGlhbCBwYWdlIHRvIG9wZW4gdG9cbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgb3BlbihwZGZTb3VyY2U6IHN0cmluZyB8IFVpbnQ4QXJyYXksIHBhZ2U/OiBudW1iZXIgfCBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgcGRmanNWaWV3ZXIgPSBhd2FpdCB0aGlzLmdldFZpZXdlcigpO1xuXG4gICAgICAgIGlmICh0eXBlb2YgcGFnZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHBhZ2UgPSBwYXJzZUludChwYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwYWdlKSB7XG4gICAgICAgICAgICBwZGZqc1ZpZXdlci5pbml0aWFsQm9va21hcmsgPSBgcGFnZT0ke3BhZ2V9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHBkZmpzVmlld2VyLmluaXRpYWxpemVkUHJvbWlzZTtcbiAgICAgICAgYXdhaXQgcGRmanNWaWV3ZXIub3BlbihwZGZTb3VyY2UpO1xuICAgICAgICBhd2FpdCBwZGZqc1ZpZXdlci5wZGZWaWV3ZXIucGFnZXNQcm9taXNlO1xuXG4gICAgICAgIC8vIFNlZSAjMTkgLSBmaXhlcyBvdGhlciBzY3JvbGwgbW9kZXMgbm90IGxvYWRpbmcgd2l0aCBpbml0aWFsIGJvb2ttYXJrXG4gICAgICAgIGlmIChwYWdlICYmIHBkZmpzVmlld2VyLnBhZ2UgIT09IHBhZ2UpIHtcbiAgICAgICAgICAgIHBkZmpzVmlld2VyLnBhZ2UgPSBwYWdlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiR2V0dGVycyAmIFNldHRlcnNcIj5cblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudGx5IHZpZXdlZCBwYWdlLlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgcGFnZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZXdlci5wYWdlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgY3VycmVudGx5IHZpZXdlZCBwYWdlLlxuICAgICAqIEBwYXJhbSB2YWx1ZVxuICAgICAqL1xuICAgIHB1YmxpYyBzZXQgcGFnZSh2YWx1ZTogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuX3ZpZXdlci5wYWdlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbG9jYWxpemVkIG5hbWUgb2YgdGhlIHdpbmRvdyB0aXRsZS5cbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHRpdGxlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuVmlld1BERicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdhaXQgZm9yIHRoZSBpbnRlcm5hbCBQREZqcyB2aWV3ZXIgdG8gYmUgcmVhZHkgYW5kIHVzYWJsZS5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZ2V0Vmlld2VyKCk6IFByb21pc2U8UERGanNWaWV3ZXI+IHtcbiAgICAgICAgaWYgKHRoaXMuX3ZpZXdlcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl92aWV3ZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPGFueT4oKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIGxldCB0aW1lb3V0O1xuICAgICAgICAgICAgY29uc3QgcmV0dXJuT3JXYWl0ID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIElmIG91ciB3aW5kb3cgaGFzIGZpbmlzaGVkIGluaXRpYWxpemluZy4uLlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBQREZqcyBoYXMgZmluaXNoZWQgaW5pdGlhbGl6aW5nLi4uXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9mcmFtZS5jb250ZW50V2luZG93ICYmIHRoaXMuX2ZyYW1lLmNvbnRlbnRXaW5kb3dbJ1BERlZpZXdlckFwcGxpY2F0aW9uJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXdlciA9IHRoaXMuX2ZyYW1lLmNvbnRlbnRXaW5kb3dbJ1BERlZpZXdlckFwcGxpY2F0aW9uJ107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmlld2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElmIGFueSBpZnMgZmFsbCB0aHJvdWdoLCB0cnkgYWdhaW4gaW4gYSBmZXcgbXNcbiAgICAgICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChyZXR1cm5PcldhaXQsIDUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybk9yV2FpdCgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBXYWl0IGZvciB0aGUgaW50ZXJuYWwgUERGanMgZXZlbnRCdXMgdG8gYmUgcmVhZHkgYW5kIHVzYWJsZS5cbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgZ2V0RXZlbnRCdXMoKTogUHJvbWlzZTxQREZqc0V2ZW50QnVzPiB7XG4gICAgICAgIGlmICh0aGlzLl9ldmVudEJ1cykge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ldmVudEJ1cyk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8YW55PigocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5nZXRWaWV3ZXIoKS50aGVuKCh2aWV3ZXIpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgdGltZW91dDtcbiAgICAgICAgICAgICAgICBjb25zdCByZXR1cm5PcldhaXQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3ZXIuZXZlbnRCdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodmlld2VyLmV2ZW50QnVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0ID0gc2V0VGltZW91dChyZXR1cm5PcldhaXQsIDUpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuT3JXYWl0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiRm91bmRyeSBPdmVycmlkZXNcIj5cblxuICAgIHByb3RlY3RlZCBfZ2V0SGVhZGVyQnV0dG9ucygpOiBhbnlbXSB7XG4gICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBzdXBlci5fZ2V0SGVhZGVyQnV0dG9ucygpO1xuICAgICAgICBidXR0b25zLnVuc2hpZnQoQlVUVE9OX0dJVEhVQik7XG4gICAgICAgIGJ1dHRvbnMudW5zaGlmdChCVVRUT05fS09GSSk7XG4gICAgICAgIHJldHVybiBidXR0b25zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXREYXRhKG9wdGlvbnM/OiBhbnkpOiBhbnkgfCBQcm9taXNlPGFueT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gc3VwZXIuZ2V0RGF0YShvcHRpb25zKTtcbiAgICAgICAgZGF0YS52aWV3ZXJGcmFtZVBhdGggPSBgJHtTZXR0aW5ncy5QQVRIX1BERkpTfS93ZWIvdmlld2VyLmh0bWxgO1xuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYXN5bmMgYWN0aXZhdGVMaXN0ZW5lcnMoaHRtbDogSlF1ZXJ5KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMub25WaWV3ZXJPcGVuaW5nKCk7XG4gICAgICAgIHN1cGVyLmFjdGl2YXRlTGlzdGVuZXJzKGh0bWwpO1xuXG4gICAgICAgIHRoaXMuX2ZyYW1lID0gaHRtbC5wYXJlbnQoKS5maW5kKCdpZnJhbWUucGRmVmlld2VyJykuZ2V0KDApIGFzIEhUTUxJRnJhbWVFbGVtZW50O1xuICAgICAgICB0aGlzLmdldFZpZXdlcigpLnRoZW4oYXN5bmMgKHZpZXdlcikgPT4ge1xuICAgICAgICAgICAgdGhpcy5fdmlld2VyID0gdmlld2VyO1xuXG4gICAgICAgICAgICBjb25zdCB0aGVtZSA9IEFwaS5hY3RpdmVUaGVtZTtcbiAgICAgICAgICAgIGNvbnN0IGZyYW1lRG9jdW1lbnQgPSAkKHRoaXMuX2ZyYW1lLmNvbnRlbnREb2N1bWVudCBhcyBEb2N1bWVudCk7XG4gICAgICAgICAgICBjb25zdCBoZWFkID0gZnJhbWVEb2N1bWVudC5maW5kKCdoZWFkJyk7XG4gICAgICAgICAgICBoZWFkLmFwcGVuZCgkKGA8bGluayBocmVmPVwiJHtnZXRBYnNvbHV0ZVVSTCh0aGVtZS5maWxlUGF0aCl9XCIgcmVsPVwic3R5bGVzaGVldFwiIHR5cGU9XCJ0ZXh0L2Nzc1wiIG1lZGlhPVwiYWxsXCI+YCkpO1xuXG4gICAgICAgICAgICB0aGlzLm9uVmlld2VyT3BlbmVkKCk7XG5cbiAgICAgICAgICAgIHRoaXMuZ2V0RXZlbnRCdXMoKS50aGVuKChldmVudEJ1cykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50QnVzID0gZXZlbnRCdXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRCdXMub24oJ3BhZ2VyZW5kZXJlZCcsIHRoaXMub25QYWdlUmVuZGVyZWQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRCdXMub24oJ3BhZ2VjaGFuZ2luZycsIHRoaXMub25QYWdlQ2hhbmdpbmcuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRCdXMub24oJ3VwZGF0ZXZpZXdhcmVhJywgdGhpcy5vblZpZXdBcmVhVXBkYXRlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9ldmVudEJ1cy5vbignc2NhbGVjaGFuZ2luZycsIHRoaXMub25TY2FsZUNoYW5naW5nLmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5vblZpZXdlclJlYWR5KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gX2dldEhlYWRlckJ1dHRvbnMgZG9lcyBub3QgcGVybWl0IHRpdGxlIGF0dHJpYnV0ZXMgdXNlZCBmb3IgdG9vbHRpcHMuLi5cbiAgICAgICAgJChodG1sKS5wYXJlbnRzKCkucGFyZW50cygpLmZpbmQoJy5wZGYtc2hlZXQtc2hvdy1wbGF5ZXJzJykucHJvcCgndGl0bGUnLCBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuU2hvd1RvUGxheWVyc1RpdGxlJykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsb3NlIHRoZSBhcHBsaWNhdGlvbiBhbmQgdW4tcmVnaXN0ZXIgcmVmZXJlbmNlcyB0byBpdCB3aXRoaW4gVUkgbWFwcGluZ3NcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgYSBQcm9taXNlIHdoaWNoIHJlc29sdmVzIG9uY2UgdGhlIHdpbmRvdyBjbG9zaW5nIGFuaW1hdGlvbiBjb25jbHVkZXNcbiAgICAgKi9cbiAgICBwdWJsaWMgYXN5bmMgY2xvc2UoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMub25WaWV3ZXJDbG9zaW5nKCk7XG5cbiAgICAgICAgYXdhaXQgc3VwZXIuY2xvc2UoKTtcblxuICAgICAgICB0aGlzLm9uVmlld2VyQ2xvc2VkKCk7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiRXZlbnRzXCI+XG5cbiAgICAvKipcbiAgICAgKiBGaXJlcyB3aGVuIHRoZSB2aWV3ZXIgd2luZG93IGZpcnN0IHN0YXJ0cyBvcGVuaW5nXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBvblZpZXdlck9wZW5pbmcoKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3RvcmUuZmlyZSgndmlld2VyT3BlbmluZycsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcmVzIHdoZW4gdGhlIHZpZXdlciB3aW5kb3cgaXMgZnVsbHkgb3BlbmVkLCBidXQgbm90IHlldCByZWFkeVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgb25WaWV3ZXJPcGVuZWQoKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3RvcmUuZmlyZSgndmlld2VyT3BlbmVkJywgdGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlyZXMgd2hlbiB0aGUgdmlld2VyIHdpbmRvdyBpcyBmdWxseSBvcGVuZWQgYW5kIGlzIHJlYWR5IGZvciB1c2VcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIG9uVmlld2VyUmVhZHkoKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3RvcmUuZmlyZSgndmlld2VyUmVhZHknLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaXJlcyB3aGVuIHRoZSB2aWV3ZXIgd2luZG93IGZpcnN0IHN0YXJ0cyBjbG9zaW5nXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBvblZpZXdlckNsb3NpbmcoKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3RvcmUuZmlyZSgndmlld2VyQ2xvc2luZycsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcmVzIHdoZW4gdGhlIHZpZXdlciB3aW5kb3cgaXMgZnVsbHkgY2xvc2VkXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBvblZpZXdlckNsb3NlZCgpIHtcbiAgICAgICAgdGhpcy5fZXZlbnRTdG9yZS5maXJlKCd2aWV3ZXJDbG9zZWQnLCB0aGlzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPY2N1cnMgZHVyaW5nIHNjcm9sbGluZyB3aGVuIGEgcGFnZSBwYXNzZXMgdGhlIGJyZWFrcG9pbnRcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIG9uUGFnZUNoYW5naW5nKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3RvcmUuZmlyZSgncGFnZUNoYW5naW5nJywgdGhpcywge1xuICAgICAgICAgICAgcGFnZUxhYmVsOiBldmVudC5wYWdlTGFiZWwsXG4gICAgICAgICAgICBwYWdlTnVtYmVyOiBldmVudC5wYWdlTnVtYmVyLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPY2N1cnMgd2hlbiBhIG5ldyBwYWdlIGlzIGxvYWRlZCBhbmQgcmVuZGVyZWRcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIG9uUGFnZVJlbmRlcmVkKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3RvcmUuZmlyZSgncGFnZVJlbmRlcmVkJywgdGhpcywge1xuICAgICAgICAgICAgcGFnZU51bWJlcjogZXZlbnQucGFnZU51bWJlcixcbiAgICAgICAgICAgIHBhZ2VMYWJlbDogZXZlbnQuc291cmNlLnBhZ2VMYWJlbCxcbiAgICAgICAgICAgIHdpZHRoOiBldmVudC5zb3VyY2Uud2lkdGgsXG4gICAgICAgICAgICBoZWlnaHQ6IGV2ZW50LnNvdXJjZS5oZWlnaHQsXG4gICAgICAgICAgICByb3RhdGlvbjogZXZlbnQuc291cmNlLnJvdGF0aW9uLFxuICAgICAgICAgICAgc2NhbGU6IGV2ZW50LnNvdXJjZS5zY2FsZSxcbiAgICAgICAgICAgIGNhbnZhczogZXZlbnQuc291cmNlLmNhbnZhcyxcbiAgICAgICAgICAgIGRpdjogZXZlbnQuc291cmNlLmRpdixcbiAgICAgICAgICAgIGVycm9yOiBldmVudC5zb3VyY2UuZXJyb3IsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9jY3VycyB3aGVuIHRoZSB6b29tIGlzIGNoYW5nZWQgb3Igd2luZG93IHNjcm9sbGVkXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBvblZpZXdBcmVhVXBkYXRlZChldmVudCkge1xuICAgICAgICB0aGlzLl9ldmVudFN0b3JlLmZpcmUoJ3ZpZXdBcmVhVXBkYXRlZCcsIHRoaXMsIHtcbiAgICAgICAgICAgIHRvcDogZXZlbnQubG9jYXRpb24udG9wLFxuICAgICAgICAgICAgbGVmdDogZXZlbnQubG9jYXRpb24ubGVmdCxcbiAgICAgICAgICAgIHBhZ2VOdW1iZXI6IGV2ZW50LmxvY2F0aW9uLnBhZ2VOdW1iZXIsXG4gICAgICAgICAgICByb3RhdGlvbjogZXZlbnQubG9jYXRpb24ucm90YXRpb24sXG4gICAgICAgICAgICBzY2FsZTogZXZlbnQubG9jYXRpb24uc2NhbGUsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9jY3VycyB3aGVuIHRoZSB6b29tIGlzIGNoYW5nZWRcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIG9uU2NhbGVDaGFuZ2luZyhldmVudCkge1xuICAgICAgICB0aGlzLl9ldmVudFN0b3JlLmZpcmUoJ3NjYWxlQ2hhbmdpbmcnLCB0aGlzLCB7XG4gICAgICAgICAgICBwcmVzZXRWYWx1ZTogZXZlbnQucHJlc2V0VmFsdWUsXG4gICAgICAgICAgICBzY2FsZTogZXZlbnQuc2NhbGUsXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIGEgY2FsbGJhY2sgdG8gb2NjdXIgd2hlbiBhbiBldmVudCBmaXJlcy4gU2VlIGluZGl2aWR1YWwgZXZlbnRzIGZvciBkZXNjcmlwdGlvbnMgYW5kIHVzZSB7QGxpbmsgQXBpLkRFQlVHLkVWRU5UU30gdG8gbG9nIGFuZCBhbmFseXplIGV2ZW50cy5cbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lXG4gICAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAgICogQGNhdGVnb3J5IEV2ZW50c1xuICAgICAqL1xuICAgIHB1YmxpYyBvbihldmVudE5hbWU6IFBERlZpZXdlckV2ZW50LCBjYWxsYmFjazogRnVuY3Rpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZXZlbnRTdG9yZS5vbihldmVudE5hbWUsIGNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXJlZ2lzdGVyIGFuIGV2ZW50IHRoYXQgaGFzIGJlZW4gcmVnaXN0ZXJlZCB3aXRoIHtAbGluayBvbn0gb3Ige0BsaW5rIG9uY2V9LlxuICAgICAqIEBwYXJhbSBldmVudE5hbWVcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tcbiAgICAgKiBAY2F0ZWdvcnkgRXZlbnRzXG4gICAgICovXG4gICAgcHVibGljIG9mZihldmVudE5hbWU6IFBERlZpZXdlckV2ZW50LCBjYWxsYmFjazogRnVuY3Rpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZXZlbnRTdG9yZS5vZmYoZXZlbnROYW1lLCBjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTGlrZSB7QGxpbmsgb259IGJ1dCBvbmx5IGZpcmVzIG9uIHRoZSBuZXh0IG9jY3VycmVuY2UuXG4gICAgICogQHBhcmFtIGV2ZW50TmFtZVxuICAgICAqIEBwYXJhbSBjYWxsYmFja1xuICAgICAqIEBjYXRlZ29yeSBFdmVudHNcbiAgICAgKi9cbiAgICBwdWJsaWMgb25jZShldmVudE5hbWU6IFBERlZpZXdlckV2ZW50LCBjYWxsYmFjazogRnVuY3Rpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZXZlbnRTdG9yZS5vbmNlKGV2ZW50TmFtZSwgY2FsbGJhY2spO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG59XG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgQmFzZVZpZXdlciBmcm9tICcuL0Jhc2VWaWV3ZXInO1xuaW1wb3J0IFNldHRpbmdzIGZyb20gJy4uL1NldHRpbmdzJztcbmltcG9ydCB7IFBERkRhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMvUERGRGF0YSc7XG5cbi8vIFRPRE86IE1vdmUgdG8gd3JhcHBlZCBpbnB1dCBtb2RlbCB0byBzdGFuZGFyZGl6ZSBpbnB1dHMuXG4vLyAgQ3VycmVudCBjb2RlIGlzIGluc2FuZSBhbmQgaGFzIHRvbyBtdWNoIGJyYW5jaGluZy5cbi8vICBGYWN0b3J5IHNob3VsZCBiZSB1c2VkIHRvIGNyZWF0ZSB0aGUgd3JhcHBlZCBpbnB1dHMuXG4vLyAvKipcbi8vICAqIFdyYXBzIGFuIGlucHV0IHRvIHN0YW5kYXJkaXplIG9wZXJhdGlvbnMgb3ZlciB2YXJpb3VzIEhUTUwgZWxlbWVudHMuXG4vLyAgKiBAaW50ZXJuYWxcbi8vICAqL1xuLy8gYWJzdHJhY3QgY2xhc3MgRm9ybUlucHV0PFRFbGVtZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQsIFRWYWx1ZT4ge1xuLy8gICAgIHByb3RlY3RlZCBfZWxlbWVudDogVEVsZW1lbnQ7XG4vLyAgICAgcHJvdGVjdGVkIF9uYW1lOiBzdHJpbmc7XG4vLyAgICAgcHJvdGVjdGVkIF92YWx1ZTogVFZhbHVlO1xuLy9cbi8vICAgICBwdWJsaWMgc3RhdGljIElzT2ZUeXBlKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4vLyAgICAgICAgIHJldHVybiBmYWxzZTtcbi8vICAgICB9XG4vL1xuLy8gICAgIC8qKlxuLy8gICAgICAqIFJldHVybiB0aGUgSFRNTCBlbGVtZW50IGZvciB0aGlzIGlucHV0LlxuLy8gICAgICAqL1xuLy8gICAgIHB1YmxpYyBnZXQgZWxlbWVudCgpIHtcbi8vICAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4vLyAgICAgfVxuLy9cbi8vICAgICAvKipcbi8vICAgICAgKiBSZXR1cm4gdGhlIG5hbWUgb2YgdGhpcyBpbnB1dC5cbi8vICAgICAgKi9cbi8vICAgICBwdWJsaWMgZ2V0IG5hbWUoKSB7XG4vLyAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuLy8gICAgIH1cbi8vXG4vLyAgICAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgZWxlbWVudDogVEVsZW1lbnQsIHZhbHVlOiBUVmFsdWUpIHtcbi8vICAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4vLyAgICAgICAgIHRoaXMuX2VsZW1lbnQgPSBlbGVtZW50O1xuLy8gICAgICAgICB0aGlzLl92YWx1ZSA9IHZhbHVlO1xuLy9cbi8vICAgICAgICAgJCh0aGlzLl9lbGVtZW50KS5hdHRyKCduYW1lJywgdGhpcy5fbmFtZSk7XG4vLyAgICAgfVxuLy9cbi8vICAgICAvKipcbi8vICAgICAgKiBHZXQgdGhlIHZhbHVlIG9mIHRoaXMgaW5wdXQuXG4vLyAgICAgICovXG4vLyAgICAgcHVibGljIGFic3RyYWN0IGdldCB2YWx1ZSgpO1xuLy9cbi8vICAgICAvKipcbi8vICAgICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoaXMgaW5wdXQuXG4vLyAgICAgICogQHBhcmFtIG5ld1ZhbHVlIFRoZSB2YWx1ZSB0byBzZXQgdG8uXG4vLyAgICAgICovXG4vLyAgICAgcHVibGljIGFic3RyYWN0IHNldCB2YWx1ZShuZXdWYWx1ZTogVFZhbHVlKTtcbi8vXG4vLyAgICAgcHVibGljIGFic3RyYWN0IG9uSW5wdXRDaGFuZ2VkKGV2ZW50OiBKUXVlcnkuQ2hhbmdlRXZlbnQpO1xuLy8gfVxuLy9cbi8vIGNsYXNzIElucHV0SW5wdXQgZXh0ZW5kcyBGb3JtSW5wdXQ8SFRNTElucHV0RWxlbWVudCwgc3RyaW5nPiB7XG4vLyAgICAgcHVibGljIHN0YXRpYyBJc09mVHlwZShlbGVtZW50OiBIVE1MRWxlbWVudCk6IGVsZW1lbnQgaXMgSFRNTElucHV0RWxlbWVudCB7XG4vLyAgICAgICAgIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT09ICdJTlBVVCc7XG4vLyAgICAgfVxuLy9cbi8vICAgICBvbklucHV0Q2hhbmdlZChldmVudDogSlF1ZXJ5LkNoYW5nZUV2ZW50KSB7fVxuLy9cbi8vICAgICBwdWJsaWMgZ2V0IHZhbHVlKCkge1xuLy8gICAgICAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4vLyAgICAgfVxuLy9cbi8vICAgICBwdWJsaWMgc2V0IHZhbHVlKG5ld1ZhbHVlOiBzdHJpbmcpIHtcbi8vICAgICAgICAgdGhpcy5fdmFsdWUgPSBuZXdWYWx1ZTtcbi8vICAgICB9XG4vLyB9XG5cbi8qKlxuICogSGFuZGxlcyBiYXNlIGZvcm0gZmlsbGFibGUgc3VwcG9ydCwgY2FuIGJlIHVzZWQgYXMgYSBzdGFuZCBhbG9uZSBmb3JtIGZpbGxhYmxlIHZpZXdlci5cbiAqIEBtb2R1bGUgQVBJXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGxhYmxlVmlld2VyIGV4dGVuZHMgQmFzZVZpZXdlciB7XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTdGF0aWMgUHJvcGVydGllc1wiPlxuXG4gICAgc3RhdGljIGdldCBkZWZhdWx0T3B0aW9ucygpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHN1cGVyLmRlZmF1bHRPcHRpb25zO1xuICAgICAgICBvcHRpb25zLnRlbXBsYXRlID0gYCR7U2V0dGluZ3MuUEFUSF9URU1QTEFURVN9L2FwcC92aWV3ZXIvZmlsbGFibGUuaHRtbGA7XG4gICAgICAgIHJldHVybiBvcHRpb25zO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJTdGF0aWMgTWV0aG9kc1wiPlxuXG4gICAgLyoqXG4gICAgICogVmFsaWRhdGUgdGhlIGRhdGEgcGF0aCBvZiB0aGUga2V5LlxuICAgICAqIEBwYXJhbSBwYXRoXG4gICAgICovXG4gICAgcHJvdGVjdGVkIHN0YXRpYyBkYXRhUGF0aFZhbGlkKHBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gIXBhdGguaW5jbHVkZXMoJ19pZCcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpeCBrZXlzIGJ5IHJlbW92aW5nIGludmFsaWQgY2hhcmFjdGVyc1xuICAgICAqIEBwYXJhbSBrZXlcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc3RhdGljIGZpeEtleShrZXk6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmIChrZXkuc3RhcnRzV2l0aChgZGF0YS5gKSkge1xuICAgICAgICAgICAgcmV0dXJuIGtleTtcbiAgICAgICAgfVxuXG4gICAgICAgIGtleSA9IGtleS50cmltKCk7XG4gICAgICAgIHJldHVybiBrZXkucmVwbGFjZSgvXFxzL2csICdfJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzb2x2ZSBhIGtleSBwYXRoIHRvIHRoZSBwcm9wZXIgZmxhdHRlbmVkIGtleVxuICAgICAqIEBwYXJhbSBrZXlcbiAgICAgKi9cbiAgICBwcm90ZWN0ZWQgc3RhdGljIHJlc29sdmVLZXlQYXRoKGtleTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKGtleSA9PT0gJ25hbWUnKSByZXR1cm4ga2V5O1xuICAgICAgICBpZiAoa2V5LnN0YXJ0c1dpdGgoYGRhdGEuYCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZpeEtleShrZXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGBmbGFncy4ke1NldHRpbmdzLk1PRFVMRV9OQU1FfS4ke1NldHRpbmdzLkZMQUdTX0tFWS5GT1JNX0RBVEF9LiR7dGhpcy5maXhLZXkoa2V5KX1gO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJQcm9wZXJ0aWVzXCI+XG5cbiAgICBwcm90ZWN0ZWQgZG9jdW1lbnQ6IEVudGl0eTtcbiAgICBwcm90ZWN0ZWQgcGRmRGF0YTogUERGRGF0YTtcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSlF1ZXJ5O1xuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkNvbnN0cnVjdG9yICYgSW5pdGlhbGl6YXRpb25cIj5cblxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihlbnRpdHk6IEpvdXJuYWxFbnRyeSB8IEFjdG9yLCBwZGZEYXRhOiBQREZEYXRhLCBvcHRpb25zPzogQXBwbGljYXRpb24uT3B0aW9ucykge1xuICAgICAgICBzdXBlcihvcHRpb25zKTtcblxuICAgICAgICB0aGlzLmRvY3VtZW50ID0gZW50aXR5O1xuICAgICAgICB0aGlzLnBkZkRhdGEgPSBwZGZEYXRhO1xuXG4gICAgICAgIHRoaXMuYmluZEhvb2tzKCk7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkdldHRlcnMgJiBTZXR0ZXJzXCI+XG5cbiAgICBwcm90ZWN0ZWQgZmxhdHRlbkVudGl0eSgpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGZsYXR0ZW5PYmplY3Qoe1xuICAgICAgICAgICAgbmFtZTogdGhpcy5kb2N1bWVudC5uYW1lLFxuICAgICAgICAgICAgZGF0YTogdGhpcy5kb2N1bWVudC5kYXRhLmRhdGEsXG4gICAgICAgICAgICBmbGFnczogdGhpcy5kb2N1bWVudC5kYXRhLmZsYWdzLFxuICAgICAgICB9KSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuXG4gICAgICAgIC8vIERvIG5vdCBhbGxvdyBub24tZGF0YSBrZXlzIHRvIG1ha2UgaXQgaW50byB0aGUgZmxhdCBvYmplY3RcbiAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoZGF0YSkpIHtcbiAgICAgICAgICAgIGlmICghRmlsbGFibGVWaWV3ZXIuZGF0YVBhdGhWYWxpZChrZXkpKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRhdGFba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJJbnN0YW5jZSBNZXRob2RzXCI+XG5cbiAgICBwcm90ZWN0ZWQgYmluZEhvb2tzKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5kb2N1bWVudC51dWlkLnN0YXJ0c1dpdGgoJ0FjdG9yJykpIHtcbiAgICAgICAgICAgIEhvb2tzLm9uKCd1cGRhdGVBY3RvcicsIHRoaXMub25VcGRhdGVFbnRpdHkuYmluZCh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kb2N1bWVudC51dWlkLnN0YXJ0c1dpdGgoJ0l0ZW0nKSkge1xuICAgICAgICAgICAgSG9va3Mub24oJ3VwZGF0ZUl0ZW0nLCB0aGlzLm9uVXBkYXRlRW50aXR5LmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHVuYmluZEhvb2tzKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5kb2N1bWVudC51dWlkLnN0YXJ0c1dpdGgoJ0FjdG9yJykpIHtcbiAgICAgICAgICAgIEhvb2tzLm9mZigndXBkYXRlQWN0b3InLCB0aGlzLm9uVXBkYXRlRW50aXR5LmJpbmQodGhpcykpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZG9jdW1lbnQudXVpZC5zdGFydHNXaXRoKCdJdGVtJykpIHtcbiAgICAgICAgICAgIEhvb2tzLm9mZigndXBkYXRlSXRlbScsIHRoaXMub25VcGRhdGVFbnRpdHkuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZWxlbWVudElzQ2hlY2tib3goZWxlbWVudDogSFRNTEVsZW1lbnQpOiBlbGVtZW50IGlzIEhUTUxJbnB1dEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gZWxlbWVudC50YWdOYW1lID09PSAnSU5QVVQnICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCd0eXBlJykgPT09ICdjaGVja2JveCc7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGVsZW1lbnRJc0lucHV0KGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogZWxlbWVudCBpcyBIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudCB7XG4gICAgICAgIHJldHVybiAoZWxlbWVudC50YWdOYW1lID09PSAnSU5QVVQnIHx8IGVsZW1lbnQudGFnTmFtZSA9PT0gJ1RFWFRBUkVBJykgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSAhPT0gJ3JhZGlvJztcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZWxlbWVudElzU2VsZWN0KGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogZWxlbWVudCBpcyBIVE1MU2VsZWN0RWxlbWVudCB7XG4gICAgICAgIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT09ICdTRUxFQ1QnO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBlbGVtZW50SXNSYWRpbyhlbGVtZW50OiBIVE1MRWxlbWVudCk6IGVsZW1lbnQgaXMgSFRNTElucHV0RWxlbWVudCB7XG4gICAgICAgIHJldHVybiBlbGVtZW50LnRhZ05hbWUgPT09ICdJTlBVVCcgJiYgZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PT0gJ3JhZGlvJztcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgb25QYWdlUmVuZGVyZWQoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgUE9MTF9JTlRFUlZBTCA9IDU7XG4gICAgICAgIGNvbnN0IE1BWF9QT0xMX1RJTUUgPSAyNTA7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9ICQoZXZlbnQuc291cmNlLmRpdik7XG5cbiAgICAgICAgbmV3IFByb21pc2U8YW55PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBsZXQgdGltZW91dDtcbiAgICAgICAgICAgIGxldCB0b3RhbFdhaXQgPSAwO1xuICAgICAgICAgICAgbGV0IGVsZW1lbnRzOiBKUXVlcnk8SFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQgfCBIVE1MU2VsZWN0RWxlbWVudD47XG5cbiAgICAgICAgICAgIGNvbnN0IHJldHVybk9yV2FpdCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBlbGVtZW50cyA9IGNvbnRhaW5lci5maW5kKCdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCcpIGFzIEpRdWVyeTxIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudCB8IEhUTUxTZWxlY3RFbGVtZW50PjtcblxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRvdGFsV2FpdCA8IE1BWF9QT0xMX1RJTUUpIHtcbiAgICAgICAgICAgICAgICAgICAgdG90YWxXYWl0ICs9IFBPTExfSU5URVJWQUw7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KHJldHVybk9yV2FpdCwgUE9MTF9JTlRFUlZBTCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdQYWdlIGRpZCBub3QgcmVuZGVyIGluIHRoZSBhbGxvd2VkIHRpbWUuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuT3JXYWl0KCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigoZWxlbWVudHM6IEpRdWVyeTxIVE1MSW5wdXRFbGVtZW50IHwgSFRNTFRleHRBcmVhRWxlbWVudCB8IEhUTUxTZWxlY3RFbGVtZW50PikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lciA9PT0gdW5kZWZpbmVkIHx8IHRoaXMuY29udGFpbmVyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lciA9ICQoY29udGFpbmVyLnBhcmVudHMoKS5maW5kKCcjdmlld2VyQ29udGFpbmVyJykpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUlucHV0cyhlbGVtZW50cyk7XG5cbiAgICAgICAgICAgICAgICBlbGVtZW50cy5vbignY2hhbmdlJywgdGhpcy5vbklucHV0Q2hhbmdlZC5iaW5kKHRoaXMpKTtcblxuICAgICAgICAgICAgICAgIHN1cGVyLm9uUGFnZVJlbmRlcmVkKGV2ZW50KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKHJlYXNvbikgPT4gY29uc29sZS5lcnJvcihyZWFzb24pKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgb25JbnB1dENoYW5nZWQoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQ7XG4gICAgICAgIGxldCB2YWx1ZSA9ICcnO1xuXG4gICAgICAgIGxldCBrZXkgPSAkKGVsZW1lbnQpLmF0dHIoJ25hbWUnKTtcbiAgICAgICAgaWYgKGtleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBrZXkgPSBGaWxsYWJsZVZpZXdlci5yZXNvbHZlS2V5UGF0aChrZXkpO1xuXG4gICAgICAgIGlmICghRmlsbGFibGVWaWV3ZXIuZGF0YVBhdGhWYWxpZChrZXkpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5lbGVtZW50SXNDaGVja2JveChlbGVtZW50KSkge1xuICAgICAgICAgICAgdmFsdWUgPSB0aGlzLmdldENoZWNrSW5wdXRWYWx1ZSgkKGVsZW1lbnQpKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmVsZW1lbnRJc0lucHV0KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZ2V0VGV4dElucHV0VmFsdWUoJChlbGVtZW50IGFzIEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50KSk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50SXNTZWxlY3QoZWxlbWVudCkpIHtcbiAgICAgICAgICAgIHZhbHVlID0gdGhpcy5nZXRUZXh0SW5wdXRWYWx1ZSgkKGVsZW1lbnQgYXMgSFRNTFNlbGVjdEVsZW1lbnQpKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmVsZW1lbnRJc1JhZGlvKGVsZW1lbnQpKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHRoaXMuZ2V0UmFkaW9JbnB1dFZhbHVlKCQoZWxlbWVudCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51cGRhdGUoXG4gICAgICAgICAgICB0aGlzLnJlc29sdmVEZWx0YSh0aGlzLmZsYXR0ZW5FbnRpdHkoKSwge1xuICAgICAgICAgICAgICAgIFtrZXldOiB2YWx1ZSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICApLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudHNUb1VwZGF0ZSA9IHRoaXMuY29udGFpbmVyLmZpbmQoJ2lucHV0LCB0ZXh0YXJlYSwgc2VsZWN0Jyk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVJbnB1dHMoZWxlbWVudHNUb1VwZGF0ZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBpbml0aWFsaXplSW5wdXRzKGVsZW1lbnRzOiBKUXVlcnkpIHtcbiAgICAgICAgY29uc3Qgb2xkRGF0YSA9IHRoaXMuZmxhdHRlbkVudGl0eSgpO1xuICAgICAgICBjb25zdCBuZXdEYXRhID0gZHVwbGljYXRlKG9sZERhdGEpO1xuXG4gICAgICAgIC8vIExvYWQgZGF0YSBmcm9tIHNoZWV0IGFzIGluaXRpYWxpemF0aW9uIGRhdGFcbiAgICAgICAgLy8gRmlsbCBpbiBleGlzdGluZyBkYXRhIHdoZXJlIGl0IGV4aXN0cyBvbiB0aGUgYWN0b3JcbiAgICAgICAgbGV0IHdyaXRlID0gZmFsc2U7XG4gICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50cykge1xuICAgICAgICAgICAgbGV0IGtleSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCduYW1lJyk7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSBudWxsIHx8ICFGaWxsYWJsZVZpZXdlci5kYXRhUGF0aFZhbGlkKGtleSkpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAga2V5ID0gRmlsbGFibGVWaWV3ZXIucmVzb2x2ZUtleVBhdGgoa2V5KTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuZWxlbWVudElzQ2hlY2tib3goZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICB3cml0ZSA9IHRoaXMuaW5pdGlhbGl6ZUNoZWNrSW5wdXQoJChlbGVtZW50KSwga2V5LCBuZXdEYXRhKSB8fCB3cml0ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50SXNJbnB1dChlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHdyaXRlID0gdGhpcy5pbml0aWFsaXplVGV4dElucHV0KCQoZWxlbWVudCksIGtleSwgbmV3RGF0YSkgfHwgd3JpdGU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZWxlbWVudElzU2VsZWN0KGVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgd3JpdGUgPSB0aGlzLmluaXRpYWxpemVUZXh0SW5wdXQoJChlbGVtZW50KSwga2V5LCBuZXdEYXRhKSB8fCB3cml0ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5lbGVtZW50SXNSYWRpbyhlbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHdyaXRlID0gdGhpcy5pbml0aWFsaXplUmFkaW9JbnB1dCgkKGVsZW1lbnQpLCBrZXksIG5ld0RhdGEpIHx8IHdyaXRlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbnN1cHBvcnRlZCBpbnB1dCB0eXBlIGluIFBERi4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh3cml0ZSkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5yZXNvbHZlRGVsdGEob2xkRGF0YSwgbmV3RGF0YSkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHJlc29sdmVEZWx0YShvbGREYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBuZXdEYXRhOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSB7XG4gICAgICAgIC8vIEZsYWdzIG11c3QgYmUgZnVsbHkgcmVzb2x2ZWRcbiAgICAgICAgY29uc3QgZGVsdGEgPSB7IC4uLmZsYXR0ZW5PYmplY3QoeyBmbGFnczogdGhpcy5kb2N1bWVudC5kYXRhLmZsYWdzIH0pIH07XG4gICAgICAgIGZvciAoY29uc3QgW2tleSwgbmV3VmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKG5ld0RhdGEpKSB7XG4gICAgICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IG9sZERhdGFba2V5XTtcblxuICAgICAgICAgICAgLy8gQXJyYXlzIGRvbnQgbWFrZSBzZW5zZSBvbiBQREZzIHdoaWNoIGFyZSBub3QgZHluYW1pY1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobmV3VmFsdWUpIHx8IEFycmF5LmlzQXJyYXkob2xkVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGRlbHRhW2tleV07XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNraXAgbWF0Y2hpbmcgdmFsdWVzXG4gICAgICAgICAgICBpZiAob2xkVmFsdWUgIT09IHVuZGVmaW5lZCAmJiBuZXdWYWx1ZSA9PT0gb2xkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVsdGFba2V5XSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlbHRhO1xuICAgIH1cblxuICAgIHB1YmxpYyByZWZyZXNoVGl0bGUoKTogdm9pZCB7XG4gICAgICAgICQodGhpcy5lbGVtZW50KS5maW5kKCcud2luZG93LXRpdGxlJykudGV4dCh0aGlzLnRpdGxlKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgb25VcGRhdGVFbnRpdHkoYWN0b3I6IEFjdG9yLCBkYXRhOiBQYXJ0aWFsPEFjdG9yLkRhdGE+ICYgeyBfaWQ6IHN0cmluZyB9LCBvcHRpb25zOiB7IGRpZmY6IGJvb2xlYW4gfSwgaWQ6IHN0cmluZykge1xuICAgICAgICBpZiAoZGF0YS5faWQgIT09IHRoaXMuZG9jdW1lbnQuaWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBkdXBsaWNhdGUoZGF0YSk7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgZGVsZXRlIGFyZ3NbJ19pZCddO1xuXG4gICAgICAgIGNvbnN0IGVsZW1lbnRzVG9VcGRhdGUgPSB0aGlzLmNvbnRhaW5lci5maW5kKCdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCcpO1xuICAgICAgICB0aGlzLmluaXRpYWxpemVJbnB1dHMoZWxlbWVudHNUb1VwZGF0ZSk7XG4gICAgICAgIHRoaXMucmVmcmVzaFRpdGxlKCk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGFzeW5jIHVwZGF0ZShkZWx0YTogb2JqZWN0KSB7XG4gICAgICAgIC8vIGRhdGEgbXVzdCBiZSBleHBhbmRlZCB0byBzZXQgcHJvcGVybHlcbiAgICAgICAgLy8gVE9ETzogRmxhZ3Mgc2VlbSB0byBiZSBhbHdheXMgc2V0IC0gZGVsdGEgbmVlZHMgY2hlY2tpbmdcbiAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnQudXBkYXRlKGV4cGFuZE9iamVjdChkZWx0YSkpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBpbml0aWFsaXplVGV4dElucHV0KFxuICAgICAgICBpbnB1dDogSlF1ZXJ5PEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50IHwgSFRNTFNlbGVjdEVsZW1lbnQ+LFxuICAgICAgICBrZXk6IHN0cmluZyxcbiAgICAgICAgZGF0YTogUmVjb3JkPHN0cmluZywgc3RyaW5nPixcbiAgICApOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHZhbHVlID0gZGF0YVtrZXldO1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gSWYgdmFsdWUgZG9lcyBub3QgZXhpc3Qgb24gYWN0b3IgeWV0LCBsb2FkIGZyb20gc2hlZXRcbiAgICAgICAgICAgIGNvbnN0IGlucHV0VmFsdWUgPSBpbnB1dC52YWwoKTtcblxuICAgICAgICAgICAgaWYgKGlucHV0VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAvLyBBY3RvciBjaGFuZ2VzIHdlcmUgbWFkZVxuICAgICAgICAgICAgICAgIGRhdGFba2V5XSA9IGlucHV0VmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSBpbml0aWFsaXplIGlucHV0IHZhbHVlIHRvIGFjdG9yIHZhbHVlXG4gICAgICAgICAgICB0aGlzLnNldFRleHRJbnB1dChpbnB1dCwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaW5pdGlhbGl6ZUNoZWNrSW5wdXQoaW5wdXQ6IEpRdWVyeTxIVE1MSW5wdXRFbGVtZW50Piwga2V5OiBzdHJpbmcsIGRhdGE6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4pOiBib29sZWFuIHtcbiAgICAgICAgbGV0IHZhbHVlID0gZGF0YVtrZXldO1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29uc3QgaW5wdXRWYWx1ZSA9IGlucHV0LmF0dHIoJ2NoZWNrZWQnKSAhPT0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICAvLyBBY3RvciBjaGFuZ2VzIHdlcmUgbWFkZVxuICAgICAgICAgICAgZGF0YVtrZXldID0gaW5wdXRWYWx1ZS50b1N0cmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNldENoZWNrSW5wdXQoaW5wdXQsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGluaXRpYWxpemVSYWRpb0lucHV0KGlucHV0OiBKUXVlcnk8SFRNTElucHV0RWxlbWVudD4sIGtleTogc3RyaW5nLCBkYXRhOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB2YWx1ZSA9IGRhdGFba2V5XTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICcnKSB7XG4gICAgICAgICAgICBkYXRhW2tleV0gPSB0aGlzLmdldFJhZGlvSW5wdXRWYWx1ZShpbnB1dCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGlmIHdlJ3JlIGxvb2tpbmcgYXQgdGhlIHJpZ2h0IHJhZGlvIGZvciB0aGUgZ3JvdXAgZW5hYmxlIGl0XG4gICAgICAgICAgICBpZiAoZGF0YVtrZXldID09PSBpbnB1dC5hdHRyKCdpZCcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRDaGVja0lucHV0KGlucHV0LCAndHJ1ZScpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldENoZWNrSW5wdXQoaW5wdXQsICdmYWxzZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc2V0VGV4dElucHV0KGlucHV0OiBKUXVlcnk8SFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQgfCBIVE1MU2VsZWN0RWxlbWVudD4sIHZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgaW5wdXQudmFsKHZhbHVlKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc2V0Q2hlY2tJbnB1dChpbnB1dDogSlF1ZXJ5PEhUTUxJbnB1dEVsZW1lbnQ+LCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGlmICh2YWx1ZSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICBpbnB1dC5hdHRyKCdjaGVja2VkJywgJ3RydWUnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlucHV0LnJlbW92ZUF0dHIoJ2NoZWNrZWQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRUZXh0SW5wdXRWYWx1ZShpbnB1dDogSlF1ZXJ5PEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50IHwgSFRNTFNlbGVjdEVsZW1lbnQ+KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWwoKTtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCkudHJpbSgpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRDaGVja0lucHV0VmFsdWUoaW5wdXQ6IEpRdWVyeTxIVE1MSW5wdXRFbGVtZW50Pik6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAod2luZG93LmdldENvbXB1dGVkU3R5bGUoaW5wdXQuZ2V0KDApLCAnOmJlZm9yZScpLmNvbnRlbnQgIT09ICdub25lJykudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0UmFkaW9JbnB1dFZhbHVlKGlucHV0OiBKUXVlcnk8SFRNTElucHV0RWxlbWVudD4pOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBuYW1lID0gaW5wdXQuYXR0cignbmFtZScpO1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9ICQodGhpcy5jb250YWluZXIpLmZpbmQoYGlucHV0W25hbWU9XCIke25hbWV9XCJdYCkgYXMgSlF1ZXJ5PEhUTUxFbGVtZW50PjtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRzLmdldChpKTtcbiAgICAgICAgICAgIGlmICh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50LCAnOmJlZm9yZScpLmNvbnRlbnQgIT09ICdub25lJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBhc3luYyBjbG9zZSgpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICAvLyBhd2FpdCB0aGlzLnNldEFjdG9yRGF0YSh0aGlzLmFjdG9yRGF0YSk7XG4gICAgICAgIGlmICh0aGlzLl92aWV3ZXIpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX3ZpZXdlci5jbG9zZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy51bmJpbmRIb29rcygpO1xuXG4gICAgICAgIHJldHVybiBzdXBlci5jbG9zZSgpO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG59XG4iLCIvKiBDb3B5cmlnaHQgMjAyMCBBbmRyZXcgQ3VjY2luZWxsb1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG5pbXBvcnQgeyBQREZEYXRhIH0gZnJvbSAnLi4vY29tbW9uL3R5cGVzL1BERkRhdGEnO1xuaW1wb3J0IEJhc2VWaWV3ZXIgZnJvbSAnLi9CYXNlVmlld2VyJztcbmltcG9ydCBQbGF5ZXJTZWxlY3QgZnJvbSAnLi4vYXBwL1BsYXllclNlbGVjdCc7XG5pbXBvcnQgeyBnZXRVc2VySWRzRXhjZXB0TWUgfSBmcm9tICcuLi9VdGlsJztcbmltcG9ydCBTZXRWaWV3RXZlbnQgZnJvbSAnLi4vc29ja2V0L2V2ZW50cy9TZXRWaWV3RXZlbnQnO1xuaW1wb3J0IHsgUERGVHlwZSB9IGZyb20gJy4uL2NvbW1vbi90eXBlcy9QREZUeXBlJztcblxuLyoqXG4gKiBUaGUgUERGb3VuZHJ5IFN0YXRpY1ZpZXdlciBjbGFzcyBvcGVucyBQREZzIGFuZCBwcm92aWRlcyBldmVudCBob29rcyBmb3Igb2JzZXJ2aW5nIHRoZSB2aWV3ZXIuXG4gKiBTdGF0aWMgdmlld2VycyBkaXNwbGF5IGEgUERGIGJ1dCBkbyBub3QgcmVuZGVyIG9yIGluc3RhbnRpYXRlIGFueSBmaWxsYWJsZSBmaWVsZHMgb3IgdGhlaXIgZGF0YS5cbiAqXG4gKiBZb3UgY2Fubm90IGNyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLCB5b3UgbXVzdCBkbyBzbyB3aXRoIHRoZSBBUEkuXG4gKlxuICogU2VlIHtAbGluayBBcGkub3BlblBERn0sIHtAbGluayBBcGkub3BlblBERkJ5Q29kZX0sIHtAbGluayBBcGkub3BlblBERkJ5TmFtZX0sIHtAbGluayBBcGkub3BlblVSTH1cbiAqICB3aGljaCBhbGwgcmV0dXJuIGEgcHJvbWlzZSB3aGljaCByZXNvbHZlIHdpdGggYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy5cbiAqIEBtb2R1bGUgQVBJXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFN0YXRpY1ZpZXdlciBleHRlbmRzIEJhc2VWaWV3ZXIge1xuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiUHJvcGVydGllc1wiPlxuXG4gICAgcHJvdGVjdGVkIF9wZGZEYXRhOiBQREZEYXRhO1xuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiQ29uc3RydWN0b3IgJiBJbml0aWFsaXphdGlvblwiPlxuXG4gICAgY29uc3RydWN0b3IocGRmRGF0YT86IFBERkRhdGEsIG9wdGlvbnM/OiBBcHBsaWNhdGlvbi5PcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xuXG4gICAgICAgIGlmIChwZGZEYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHBkZkRhdGEgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogZ2FtZS5pMThuLmxvY2FsaXplKCdQREZPVU5EUlkuVklFV0VSLlZpZXdQREYnKSxcbiAgICAgICAgICAgICAgICBjb2RlOiAnJyxcbiAgICAgICAgICAgICAgICBvZmZzZXQ6IDAsXG4gICAgICAgICAgICAgICAgdXJsOiAnJyxcbiAgICAgICAgICAgICAgICB0eXBlOiBQREZUeXBlLlN0YXRpYyxcbiAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcGRmRGF0YSA9IHBkZkRhdGE7XG4gICAgfVxuXG4gICAgLy8gPC9lZGl0b3ItZm9sZD5cblxuICAgIC8vIDxlZGl0b3ItZm9sZCBkZXNjPVwiR2V0dGVycyAmIFNldHRlcnNcIj5cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBjb3B5IG9mIHRoZSBQREZEYXRhIHRoaXMgdmlld2VyIGlzIHVzaW5nLlxuICAgICAqIENoYW5nZXMgdG8gdGhpcyBkYXRhIHdpbGwgbm90IHJlZmxlY3QgaW4gdGhlIHZpZXdlci5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0IHBkZkRhdGEoKSB7XG4gICAgICAgIHJldHVybiBkdXBsaWNhdGUodGhpcy5fcGRmRGF0YSk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCB0aXRsZSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgdGl0bGUgPSB0aGlzLl9wZGZEYXRhLm5hbWU7XG4gICAgICAgIGlmICh0aGlzLl9wZGZEYXRhLmNvZGUgIT09ICcnKSB7XG4gICAgICAgICAgICB0aXRsZSA9IGAke3RpdGxlfSAoJHt0aGlzLl9wZGZEYXRhLmNvZGV9KWA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRpdGxlO1xuICAgIH1cblxuICAgIC8vIDwvZWRpdG9yLWZvbGQ+XG5cbiAgICAvLyA8ZWRpdG9yLWZvbGQgZGVzYz1cIkZvdW5kcnkgT3ZlcnJpZGVzXCI+XG5cbiAgICBwcm90ZWN0ZWQgX2dldEhlYWRlckJ1dHRvbnMoKTogYW55W10ge1xuICAgICAgICBjb25zdCBidXR0b25zID0gc3VwZXIuX2dldEhlYWRlckJ1dHRvbnMoKTtcblxuICAgICAgICBidXR0b25zLnVuc2hpZnQoe1xuICAgICAgICAgICAgY2xhc3M6ICdwZGYtc2hlZXQtc2hvdy1wbGF5ZXJzJyxcbiAgICAgICAgICAgIGljb246ICdmYXMgZmEtZXllJyxcbiAgICAgICAgICAgIGxhYmVsOiBnYW1lLmkxOG4ubG9jYWxpemUoJ1BERk9VTkRSWS5WSUVXRVIuU2hvd1RvUGxheWVyc1RleHQnKSxcbiAgICAgICAgICAgIG9uY2xpY2s6IChldmVudCkgPT4gdGhpcy5zaG93VG8oZXZlbnQpLFxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gYnV0dG9ucztcbiAgICB9XG5cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxuXG4gICAgLy8gPGVkaXRvci1mb2xkIGRlc2M9XCJJbnN0YW5jZSBNZXRob2RzXCI+XG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoZSBjdXJyZW50IHBhZ2UgdG8gR01zLlxuICAgICAqL1xuICAgIHByb3RlY3RlZCBzaG93VG8oZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICAgICAgY29uc3QgcGRmRGF0YSA9IHRoaXMucGRmRGF0YTtcbiAgICAgICAgcGRmRGF0YS5vZmZzZXQgPSAwO1xuXG4gICAgICAgIGNvbnN0IGlkcyA9IGdldFVzZXJJZHNFeGNlcHRNZSgpO1xuICAgICAgICBpZiAoZXZlbnQuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgIG5ldyBTZXRWaWV3RXZlbnQoaWRzLCBwZGZEYXRhLCB0aGlzLnBhZ2UpLmVtaXQoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBQbGF5ZXJTZWxlY3QoaWRzLCAoZmlsdGVyZWRJZHMpID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgU2V0Vmlld0V2ZW50KGZpbHRlcmVkSWRzLCBwZGZEYXRhLCB0aGlzLnBhZ2UpLmVtaXQoKTtcbiAgICAgICAgICAgIH0pLnJlbmRlcih0cnVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyA8L2VkaXRvci1mb2xkPlxufVxuIl19"}