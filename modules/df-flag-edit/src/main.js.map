{"version":3,"file":"main.js","mappings":"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","sources":["webpack:///../common/HooksExt.shim.ts","webpack:///../common/Settings.ts","webpack:///./src/FlagEditor.ts","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./src/df-flag-edit.ts"],"sourcesContent":["/**\n * HooksExt is a general extension of the FoundryVTT Hooks class.\n * @name HooksExt\n * @version 1.0.0\n * @author flamewave000\n * @license BSD-3-Clause\n * @see https://github.com/flamewave000/dragonflagon-fvtt\n * @see https://github.com/flamewave000/dragonflagon-fvtt/blob/master/LICENSE\n * * HooksExt.shim.ts, HooksExt.shim.js, HooksExt.shim.min.js, HooksExt.shim.js.map\n */\n\n/* eslint-disable no-prototype-builtins */\n// @ts-nocheck\n\nif (!(<any>globalThis).HooksExt) {\n\t/**\n\t * A simple event framework used throughout Foundry Virtual Tabletop.\n\t * When key actions or events occur, a \"hook\" is defined where user-defined callback functions can execute.\n\t * This class manages the registration and execution of hooked callback functions.\n\t */\n\tclass _HooksExt {\n\t\t/** Registry of RegExp based hooks */\n\t\tstatic readonly _regex = new Map<string, { regex: RegExp, fns: number[] }>();\n\t\t/** Repository of all hooks ever invoked. This is only ever used when `CONFIG.debug.hooks` is `true` */\n\t\tstatic readonly _hookRepo = new Set<string>();\n\n\t\t/**\n\t\t * Register a callback handler which should be triggered when a hook is triggered.\n\t\t *\n\t\t * @param {string | RegExp} hook\tThe unique name of the hooked event\n\t\t * @param {Function} fn\t\t\t\tThe callback function which should be triggered when the hook event occurs\n\t\t * @return {number}\t\t\t\t\tAn ID number of the hooked function which can be used to turn off the hook later\n\t\t */\n\t\tstatic on(hook: string | RegExp, fn: (...args: any) => any): number {\n\t\t\tconsole.debug(`${vtt} | Registered callback for ${hook} hook`); //\t\t─┬─ FoundryVTT Original\n\t\t\tconst id = Hooks._id++; //\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\tif (hook instanceof RegExp) { //\t\t\t\t\t\t\t\t\t\t─┐\n\t\t\t\tconst pattern = hook.toString(); //\t\t\t\t\t\t\t\t\t │\n\t\t\t\tlet regex = this._regex.get(pattern); //\t\t\t\t\t\t\t │\n\t\t\t\tif (!regex) { //\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\t\tregex = { regex: hook, fns: [] }; //\t\t\t\t\t\t\t │\n\t\t\t\t\tthis._regex.set(pattern, regex); //\t\t\t\t\t\t\t\t ├─ HooksExt Customized\n\t\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tregex.fns.push(id); //\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tHooks._hooks[pattern] = Hooks._hooks[pattern] || []; //\t\t\t\t │\n\t\t\t\tHooks._hooks[pattern].push(fn); //\t\t\t\t\t\t\t\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\telse { //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\t\tHooks._hooks[hook] = Hooks._hooks[hook] || []; //\t\t\t\t\t─┬─ FoundryVTT Original\n\t\t\t\tHooks._hooks[hook].push(fn); //\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─── HooksExt Customized\n\t\t\tHooks._ids[id] = fn; //\t\t\t\t\t\t\t\t\t\t\t\t\t─┬─ FoundryVTT Original\n\t\t\treturn id; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t}\n\n\t\t/**\n\t\t * Unregister a callback handler for a particular hook event\n\t\t *\n\t\t * @param {string | RegExp} hook\tThe unique name of the hooked event\n\t\t * @param {Function|number} fn\t\tThe function, or ID number for the function, that should be turned off\n\t\t */\n\t\tstatic off(hook: string | RegExp, fn: ((...args: any) => any) | number) {\n\t\t\tif (typeof fn === \"number\") { //\t\t\t\t\t\t\t\t\t\t─┐\n\t\t\t\tconst id = fn; //\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tfn = Hooks._ids[fn]; //\t\t\t\t\t\t\t\t\t\t\t\t ├─ FoundryVTT Original\n\t\t\t\tdelete Hooks._ids[id]; //\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\t/* Foundry does not currently delete the function from ids if //\t\t─┐\n\t\t\tonly the function is provided. This is a potential memory leak //\t\t │\n\t\t\tthat HooksExt attempts to plug. */ //\t\t\t\t\t\t\t\t\t │\n\t\t\telse { //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tconst entry = Object.entries(Hooks._ids).find(x => x[1] === fn);//\t │\n\t\t\t\tif (entry) //\t\t\t\t\t\t\t\t\t\t\t\t\t\t ├─ HooksExt Customized\n\t\t\t\t\tdelete Hooks._ids[parseInt(entry[0])]; //\t\t\t\t\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t/* Convert the hook to its string pattern */ //\t\t\t\t\t\t\t │\n\t\t\tif (hook instanceof RegExp) //\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\thook = hook.toString(); //\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\tthis._regex.delete(hook); //\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\tif (!Hooks._hooks.hasOwnProperty(hook)) //\t\t\t\t\t\t\t\t─┐\n\t\t\t\treturn; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\tconst fns = Hooks._hooks[hook]; //\t\t\t\t\t\t\t\t\t\t │\n\t\t\tconst idx = fns.indexOf(fn); //\t\t\t\t\t\t\t\t\t\t\t ├─ FoundryVTT Original\n\t\t\tif (idx !== -1) //\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tfns.splice(idx, 1); //\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\tconsole.debug(`${vtt} | Unregistered callback for ${hook} hook`); //\t─┘\n\t\t}\n\n\t\t/**\n\t\t * Call all hook listeners in the order in which they were registered\n\t\t * Hooks called this way can not be handled by returning false and will always trigger every hook callback.\n\t\t *\n\t\t * @param {string} hook   The hook being triggered\n\t\t * @param {...*} args     Arguments passed to the hook callback functions\n\t\t * @returns {boolean}     Were all hooks called without execution being prevented?\n\t\t */\n\t\tstatic callAll(hook: string, ...args: any) {\n\t\t\tif (CONFIG.debug.hooks) { //\t\t\t\t\t\t\t\t\t\t\t─┐\n\t\t\t\tconsole.log(`DEBUG | Calling ${hook} hook with args:`); //\t\t\t ├─ FoundryVTT Original\n\t\t\t\tconsole.log(args); //\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\t\tthis._hookRepo.add(hook); //\t\t\t\t\t\t\t\t\t\t─── HooksExt Customized\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─── FoundryVTT Original\n\t\t\tfor (const regex of this._regex) { //\t\t\t\t\t\t\t\t\t─┐\n\t\t\t\tif (!regex[1].regex.test(hook)) //\t\t\t\t\t\t\t\t\t │\n\t\t\t\t\tcontinue; //\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tfor (const fnId of regex[1].fns) //\t\t\t\t\t\t\t\t\t ├─ HooksExt Customized\n\t\t\t\t\tHooks._call(hook, Hooks._ids[fnId], args); //\t\t\t\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\tif (!Hooks._hooks.hasOwnProperty(hook)) //\t\t\t\t\t\t\t\t─┐\n\t\t\t\treturn true; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\tconst fns = new Array(...Hooks._hooks[hook]); //\t\t\t\t\t\t │\n\t\t\tfor (const fn of fns) { //\t\t\t\t\t\t\t\t\t\t\t\t ├─ FoundryVTT Original\n\t\t\t\tHooks._call(hook, fn, args); //\t\t\t\t\t\t\t\t\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\treturn true; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t}\n\n\t\t/**\n\t\t * Call hook listeners in the order in which they were registered.\n\t\t * Continue calling hooks until either all have been called or one returns false.\n\t\t *\n\t\t * Hook listeners which return false denote that the original event has been adequately handled and no further\n\t\t * hooks should be called.\n\t\t *\n\t\t * @param {string} hook   The hook being triggered\n\t\t * @param {...*} args     Arguments passed to the hook callback functions\n\t\t * @returns {boolean}     Were all hooks called without execution being prevented?\n\t\t */\n\t\tstatic call(hook: string, ...args: any) {\n\t\t\tif (CONFIG.debug.hooks) { //\t\t\t\t\t\t\t\t\t\t\t─┐\n\t\t\t\tconsole.log(`DEBUG | Calling ${hook} hook with args:`); //\t\t\t ├─ FoundryVTT Original\n\t\t\t\tconsole.log(args); //\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t\t\tthis._hookRepo.add(hook); //\t\t\t\t\t\t\t\t\t\t─── HooksExt Customized\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─── FoundryVTT Original\n\t\t\tlet fns = []; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┐\n\t\t\tfor (const regex of this._regex) { //\t\t\t\t\t\t\t\t\t │\n\t\t\t\tif (regex[1].regex.test(hook)) //\t\t\t\t\t\t\t\t\t │\n\t\t\t\t\tfns = fns.concat(regex[1].fns.map(x => Hooks._ids[x])); //\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t ├─ HooksExt Customized\n\t\t\tconst hooksExist = Hooks._hooks.hasOwnProperty(hook); //\t\t\t\t │\n\t\t\tif (!hooksExist && fns.length == 0) //\t\t\t\t\t\t\t\t\t │\n\t\t\t\treturn true; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\tif (hooksExist) //\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t\tfns = fns.concat(...Hooks._hooks[hook]); //\t\t\t\t\t\t\t─┘\n\t\t\tfor (const fn of fns) { //\t\t\t\t\t\t\t\t\t\t\t\t─┐\n\t\t\t\tconst callAdditional = Hooks._call(hook, fn, args); //\t\t\t\t │\n\t\t\t\tif (callAdditional === false) //\t\t\t\t\t\t\t\t\t ├─ FoundryVTT Original\n\t\t\t\t\treturn false; //\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\t} //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t │\n\t\t\treturn true; //\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t─┘\n\t\t}\n\n\t\t/**\n\t\t * Retrieves all of the hook calls that have been made so far. This list will always be empty\n\t\t * unless `CONFIG.debug.hooks` is set to `true`.\n\t\t * @returns String array of all calls made so far.\n\t\t */\n\t\tstatic allUniqueHooks(): string[] { return [...this._hookRepo.values()]; }\n\t}\n\n\t// If a HookExt has already been bound, do not execute the following\n\t(<any>globalThis).HooksExt = _HooksExt;\n\tHooks.on = <any>_HooksExt.on.bind(_HooksExt);\n\tHooks.off = <any>_HooksExt.off.bind(_HooksExt);\n\tHooks.callAll = <any>_HooksExt.callAll.bind(_HooksExt);\n\tHooks.call = <any>_HooksExt.call.bind(_HooksExt);\n}","\ndeclare global {\n\tinterface LenientGlobalVariableTypes {\n\t\tgame: never;\n\t\tcanvas: never;\n\t}\n\tinterface String {\n\t\t/** Localizes the string via the global `game.i18n.localize()` function. */\n\t\tlocalize(): string\n\t}\n\ttype AnyFunction = (...args: any) => any;\n}\n\nexport default class SETTINGS {\n\tstatic MOD_NAME: string;\n\tstatic init(moduleName: string) {\n\t\tthis.MOD_NAME = moduleName;\n\t\tif (!String.prototype.localize) {\n\t\t\tString.prototype.localize = function () {\n\t\t\t\treturn game.i18n.localize(this.valueOf());\n\t\t\t};\n\t\t}\n\t}\n\tstatic register<T>(key: string, config: ClientSettings.PartialSetting<T>) { game.settings.register(SETTINGS.MOD_NAME, key, config); }\n\tstatic registerMenu(key: string, config: ClientSettings.PartialMenuSetting) { game.settings.registerMenu(SETTINGS.MOD_NAME, key, config); }\n\tstatic get<T>(key: string): T { return <T>game.settings.get(SETTINGS.MOD_NAME, key); }\n\tstatic async set<T>(key: string, value: T): Promise<T> { return await game.settings.set(SETTINGS.MOD_NAME, key, value); }\n\tstatic default<T>(key: string): T { return <T>game.settings.settings.get(SETTINGS.MOD_NAME + '.' + key).default; }\n\t/** helper for referencing a Typed constructor for the `type` field of a setting { type: SETTINGS.typeOf<MyClass>() } */\n\tstatic typeOf<T>(): ConstructorOf<T> { return Object as any; }\n}\n","import SETTINGS from \"../../common/Settings\";\n\n//#region Type Definitions\n// If Ace Library is installed and enabled, this will exist\ndeclare const ace: any;\n\ndeclare class JSONEditor {\n\tconstructor(container: HTMLElement, options: JSONEditor.Options);\n\taceEditor: {\n\t\tsession: {\n\t\t\tsetUseSoftTabs: (show: boolean) => void\n\t\t},\n\t\tsetShowInvisibles: (show: boolean) => void\n\t};\n\tget: () => Record<string, Record<string, any>>;\n\tset: (e: any) => void;\n\tsetText: (e: string) => void;\n\tupdateText: (e: string) => void;\n\tformat: () => void;\n\tsetMode: (mode: string) => void;\n}\n\ndeclare namespace JSONEditor {\n\tinterface Options {\n\t\tlimitDragging: boolean,\n\t\tmode: string,\n\t\tmodes: string[],\n\t\tindentation: number,\n\t\tmainMenuBar: boolean,\n\t\tnavigationBar: boolean,\n\t\tstatusBar: boolean,\n\t\tcolorPicker: boolean\n\t}\n}\n\ndeclare interface FoundryData {\n\t_id: string;\n\tflags: any;\n\tdocument: FoundryDocument;\n}\n\ndeclare interface FoundryDocument {\n\tdata: FoundryData;\n\tupdate: (data: any) => Promise<any>\n\tunsetFlag(scope: string, key: string): Promise<unknown>\n}\n//#endregion\n\nexport default class FlagEditor extends Application {\n\tstatic readonly PREF_LAST_OBJ = 'FlagEditor.LastObject';\n\n\tprivate static readonly IGNORED_COLLECTIONS = [\n\t\t\"FogExploration\",\n\t\t\"Setting\"\n\t];\n\n\tstatic get defaultOptions(): any {\n\t\treturn mergeObject(<Partial<Application.Options>>Application.defaultOptions, {\n\t\t\ttemplate: `modules/${SETTINGS.MOD_NAME}/templates/flag-edit.hbs`,\n\t\t\tminimizable: true,\n\t\t\tresizable: true,\n\t\t\theight: 500,\n\t\t\twidth: 500\n\t\t});\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/ban-types\n\tprivate static async _findObject(id: string | String): Promise<FoundryDocument | null> {\n\t\tif (typeof id !== 'string' && !(id instanceof String)) return Promise.reject(\"Invalid parameter: id must be type 'string'\");\n\t\treturn await new Promise<FoundryDocument | null>((res, rej) => {\n\t\t\t// Search the collections\n\t\t\tconst collections = game.collections;\n\t\t\tfor (const [key, map] of collections.entries()) {\n\t\t\t\tif (FlagEditor.IGNORED_COLLECTIONS.includes(key) || !map.has(<any>id)) continue;\n\t\t\t\tres(map.get(<any>id));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trej();\n\t\t}).catch(() => new Promise<FoundryDocument | null>((res, rej) => {\n\t\t\t// Search the layers\n\t\t\tfor (const layer of canvas.layers) {\n\t\t\t\tif (!(layer instanceof PlaceablesLayer)) continue;\n\t\t\t\tif (!(<Map<string, FoundryDocument>>(<any>layer).documentCollection).has(<string>id)) continue;\n\t\t\t\tres((<Map<string, FoundryDocument>>(<any>layer).documentCollection).get(<string>id));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trej();\n\t\t})).catch(() => Promise.resolve<FoundryDocument | null>(null));\n\t}\n\n\tstatic init() {\n\t\tSETTINGS.register(FlagEditor.PREF_LAST_OBJ, { scope: 'client', type: String, default: '', config: false });\n\t\tHooks.on('renderSettings', (_: Settings, html: JQuery<HTMLElement>) => {\n\t\t\tif (!game.user.isGM) return;\n\t\t\tconst captureButton = $(`<div><button data-action=\"edit-json\"><i class=\"fas fa-code\"></i>${game.i18n.localize('DF_FLAG_EDIT.EditButtonLabel')}</button></div>`);\n\t\t\tcaptureButton.find('button').on('click', () => (new FlagEditor()).render(true));\n\t\t\thtml.find('#game-details').after(captureButton);\n\t\t});\n\t}\n\n\tconstructor() {\n\t\tsuper({\n\t\t\ttitle: game.i18n.localize('DF_FLAG_EDIT.Title').replace(' - {0} ({1})', '')\n\t\t});\n\t}\n\n\tprivate _document: FoundryDocument | null = null;\n\tset document(value: FoundryDocument | null) {\n\t\tthis._document = value;\n\t\tthis.editor.set(this._document?.data?.flags || '');\n\t}\n\tget document(): FoundryDocument | null { return this._document; }\n\teditor: JSONEditor;\n\n\tasync _render(force?: boolean, options?: any): Promise<void> {\n\t\tawait FlagEditor._loadEditor();\n\t\tconst result = await super._render(force, options);\n\t\tconst editorOptions = {\n\t\t\t// If the Ace Lib is installed and running\n\t\t\tace: 'ace' in window ? ace : undefined,\n\t\t\tlimitDragging: false,\n\t\t\tmode: 'tree',\n\t\t\tmodes: ['tree', 'code'],\n\t\t\tindentation: 4,\n\t\t\tmainMenuBar: true,\n\t\t\tnavigationBar: true,\n\t\t\tstatusBar: true,\n\t\t\tcolorPicker: true,\n\t\t\tonCreateMenu: (items: any, _: any) => (items as { className: string }[])\n\t\t\t\t.filter(x => ![\"jsoneditor-extract\", \"jsoneditor-transform\"].includes(x.className))\n\t\t};\n\t\tthis.editor = new JSONEditor(this.element.find('#editor')[0], editorOptions);\n\t\tif (!this.document) {\n\t\t\tawait this._handlePathChange(SETTINGS.get(FlagEditor.PREF_LAST_OBJ));\n\t\t}\n\n\t\tconst input = this.element.find('#object-path');\n\t\tinput.on('input', () => input.trigger('change'));\n\t\tinput.on('change', async () => this._handlePathChange((input.val() as string).trim()));\n\t\tthis.element.find('#cancel').on('click', () => this.close());\n\t\tconst applyButton = this.element.find('#apply');\n\t\tconst saveButton = this.element.find('#save');\n\t\tsaveButton.on('click', () => {\n\t\t\tapplyButton.trigger('click');\n\t\t\tthis.close();\n\t\t});\n\t\tapplyButton.on('click', async () => {\n\t\t\tif (this.document?.data?.flags === undefined || this.document?.data?.flags === null)\n\t\t\t\treturn;\n\t\t\tsaveButton.prop('disabled', true);\n\t\t\tapplyButton.prop('disabled', true);\n\t\t\tconst flags = this.editor.get();\n\t\t\tconst newKeys = Object.keys(flags)\n\t\t\t\t.flatMap(x => Object.keys(flags[x]).map(y => `${x}_____${y}`))\n\t\t\t\t.filter(x => !x.endsWith('_____'));\n\t\t\tconst oldKeys = Object.keys(this.document.data.flags)\n\t\t\t\t.flatMap(x => Object.keys(this.document.data.flags[x]).map(y => `${x}_____${y}`))\n\t\t\t\t.filter(x => !x.endsWith('_____'));\n\t\t\tconst deleted = oldKeys.filter(x => !newKeys.includes(x));\n\t\t\tfor (const flag of deleted) {\n\t\t\t\tconst scope = flag.split('_____')[0];\n\t\t\t\tconst key = flag.split('_____')[1];\n\t\t\t\ttry {\n\t\t\t\t\t// await this.document.unsetFlag(scope, key);\n\t\t\t\t\tconst head = key.split('.');\n\t\t\t\t\tconst tail = `-=${head.pop()}`;\n\t\t\t\t\tconst t = [scope, ...head, tail].join('.');\n\t\t\t\t\tflags[t] = null;\n\t\t\t\t}\n\t\t\t\tcatch (err) { console.warn(err); }\n\t\t\t}\n\t\t\tawait this.document.update({ flags });\n\t\t\tthis.editor.set(this._document?.data?.flags || '');\n\t\t\tsaveButton.prop('disabled', false);\n\t\t\tapplyButton.prop('disabled', false);\n\t\t});\n\t\treturn result;\n\t}\n\n\tprivate static _loadEditorPromise: Promise<unknown> = null;\n\tprivate static _loadEditor(): Promise<void> {\n\t\t// Resolve immediately if element exists\n\t\tif (this._loadEditorPromise == null) {\n\t\t\t// If the Editor library has not yet been loaded, lets load it now inside a promise\n\t\t\tconst scriptPromise = new Promise<void>(res => {\n\t\t\t\tconst script = document.createElement('script') as HTMLScriptElement;\n\t\t\t\tscript.async = true;\n\t\t\t\tscript.onload = () => res();\n\t\t\t\t// If the Ace Lib is installed and running\n\t\t\t\tif ('ace' in window)\n\t\t\t\t\tscript.src = `/modules/${SETTINGS.MOD_NAME}/libs/jsoneditor-minimalist.min.js`;\n\t\t\t\telse\n\t\t\t\t\tscript.src = `/modules/${SETTINGS.MOD_NAME}/libs/jsoneditor.min.js`;\n\t\t\t\tdocument.body.append(script);\n\t\t\t});\n\t\t\tconst stylePromise = new Promise<void>(res => {\n\t\t\t\tconst style = document.createElement('link') as HTMLLinkElement;\n\t\t\t\tstyle.rel = 'stylesheet';\n\t\t\t\tstyle.type = 'text/css';\n\t\t\t\tstyle.onload = () => res();\n\t\t\t\tstyle.href = `/modules/${SETTINGS.MOD_NAME}/libs/jsoneditor.min.css`;\n\t\t\t\tdocument.body.append(style);\n\t\t\t});\n\t\t\tthis._loadEditorPromise = Promise.all([scriptPromise, stylePromise]);\n\t\t}\n\t\treturn <Promise<void>>this._loadEditorPromise;\n\t}\n\n\tprivate _showError(error?: string) {\n\t\tconst el = this.element.find('.error');\n\t\tel.attr('title', error || game.i18n.localize('DF_FLAG_EDIT.ErrorObjectNotFound'));\n\t\tel.show();\n\t\tthis.document = null;\n\t\tthis._updateTitle();\n\t}\n\tprivate _hideError() {\n\t\tthis.element.find('.error').hide();\n\t}\n\tprivate _updateTitle() {\n\t\tthis.options.title = game.i18n.localize('DF_FLAG_EDIT.Title')\n\t\t\t.replace('{0}', this.document !== null ? Object.getPrototypeOf(this.document).constructor.name : '#')\n\t\t\t.replace('{1}', this.document?.data?._id || '#');\n\t\tthis.element.find('h4.window-title').text(this.options.title);\n\t}\n\n\tgetData(): any {\n\t\treturn {\n\t\t\tpath: SETTINGS.get(FlagEditor.PREF_LAST_OBJ)\n\t\t};\n\t}\n\n\tprivate async _handlePathChange(data: string) {\n\t\tawait SETTINGS.set(FlagEditor.PREF_LAST_OBJ, data);\n\t\tlet document: FoundryDocument | null;\n\t\tif (data.length === 0) {\n\t\t\tthis._hideError();\n\t\t\tdocument = null;\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\t// If we are an ID\n\t\t\tif (FlagEditor.isID(data))\n\t\t\t\tdocument = await FlagEditor.extractID(data);\n\t\t\t// we are an object path\n\t\t\telse {\n\t\t\t\tlet temp = FlagEditor.evaluateDocument(data);\n\t\t\t\t// If the result is NOT a Document/Data\n\t\t\t\tif (!FlagEditor.isDocument(temp)) {\n\t\t\t\t\t// If the Object Path result is an ID\n\t\t\t\t\tif ((temp instanceof String || typeof temp === 'string') && FlagEditor.isID(temp)) {\n\t\t\t\t\t\ttemp = await FlagEditor.extractID(temp as string);\n\t\t\t\t\t} else throw 'Invalid object from path';\n\t\t\t\t}\n\t\t\t\tdocument = <FoundryDocument | null>temp;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis._showError(error as string);\n\t\t\tdocument = null;\n\t\t\treturn;\n\t\t}\n\t\tif (document?.data === undefined || document?.data === null) {\n\t\t\tif ((<any>document)?.document === undefined || (<any>document)?.document === null) {\n\t\t\t\tthis._showError(\"Invalid object: document must be of type 'string', 'Document', or 'DocumentData'\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse document = (<any>document)?.document;\n\t\t}\n\t\tif (document?.data?.flags === undefined || document?.data?.flags === null) {\n\t\t\tthis._showError('Invalid object: does not contain a flags field');\n\t\t\treturn;\n\t\t}\n\t\tthis._hideError();\n\t\tthis.document = document;\n\t\tthis._updateTitle();\n\t}\n\n\tprivate static isID(target: any): boolean {\n\t\treturn /^['\"`]?[a-z0-9]+['\"`]?$/im.test(target);\n\t}\n\tprivate static isDocument(target: any): boolean {\n\t\treturn target?.data !== undefined || target?.document !== undefined;\n\t}\n\tprivate static extractID(target: string): Promise<FoundryDocument | null> {\n\t\treturn FlagEditor._findObject(target.match(/^['\"`]?([a-z0-9]+)['\"`]?$/im)[1]);\n\t}\n\tprivate static evaluateDocument(target: string): FoundryDocument | string | null { return eval(target); }\n}\n\n\n(<any>window).showFlagEditorForDocument = async (document: any) => {\n\tif (document.data === undefined) {\n\t\tif (document.document === undefined) {\n\t\t\tif (document instanceof String || typeof document === 'string') {\n\t\t\t\tdocument = (<any>FlagEditor)._findObject(document);\n\t\t\t}\n\t\t\telse throw Error(\"Invalid object: document must be of type 'string', 'Document', or 'DocumentData'\");\n\t\t}\n\t\telse document = document.document;\n\t}\n\t// If nothing was found, throw an error\n\tif (document === null) {\n\t\tui.notifications.error(`Could not find an object with ID '${document}'`);\n\t\tconsole.error(`Could not find an object with ID '${document}'`);\n\t\treturn;\n\t}\n\tconst editor = new FlagEditor();\n\tawait editor.render(true);\n\teditor.document = document;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import '../../common/HooksExt.shim';\nimport SETTINGS from \"../../common/Settings\";\nimport FlagEditor from \"./FlagEditor\";\nSETTINGS.init('df-flag-edit');\n\nHooks.once('init', function () {\n\tFlagEditor.init();\n});\n\nfunction launchFlagEditorForEvent(event: JQuery.ClickEvent) {\n\tconst id = $(event.currentTarget).parents('.window-app').attr('id').split('-').pop();\n\tif (!id) return;\n\tSETTINGS.set(FlagEditor.PREF_LAST_OBJ, id);\n\tnew FlagEditor().render(true);\n}\nHooks.once('ready', function () {\n\tif (!game.user.isGM) return;\n\tHooks.on(<any>/get.*HeaderButtons/, (app: Application, buttons: Application.HeaderButton[]) => {\n\t\tif (buttons.find(x => x.class === 'edit-flags')) return;\n\t\tif (app instanceof DocumentSheet) {\n\t\t\tbuttons.unshift({\n\t\t\t\ticon: 'fas fa-code',\n\t\t\t\tlabel: 'Edit Flags',\n\t\t\t\tclass: 'edit-flags',\n\t\t\t\tonclick: launchFlagEditorForEvent\n\t\t\t});\n\t\t}\n\t});\n});\n\nHooks.on('editFlags', (id: string) => {\n\tid = id?.trim();\n\tif (!id) return false;\n\tSETTINGS.set(FlagEditor.PREF_LAST_OBJ, id);\n\tnew FlagEditor().render(true);\n\treturn false;\n});"],"names":["globalThis","HooksExt","_HooksExt","static","hook","fn","console","debug","vtt","id","Hooks","_id","RegExp","pattern","toString","regex","this","_regex","get","fns","set","push","_hooks","_ids","entry","Object","entries","find","x","parseInt","delete","hasOwnProperty","idx","indexOf","splice","args","CONFIG","hooks","log","_hookRepo","add","test","fnId","_call","Array","concat","map","hooksExist","length","values","Map","Set","on","bind","off","callAll","call","SETTINGS","moduleName","MOD_NAME","String","prototype","localize","game","i18n","valueOf","key","config","settings","register","registerMenu","value","default","FlagEditor","Application","constructor","super","title","replace","_document","defaultOptions","mergeObject","template","minimizable","resizable","height","width","Promise","res","rej","collections","IGNORED_COLLECTIONS","includes","has","catch","layer","canvas","layers","PlaceablesLayer","documentCollection","resolve","reject","PREF_LAST_OBJ","scope","type","_","html","user","isGM","captureButton","$","render","after","document","editor","data","flags","async","force","options","_loadEditor","result","_render","editorOptions","ace","window","undefined","limitDragging","mode","modes","indentation","mainMenuBar","navigationBar","statusBar","colorPicker","onCreateMenu","items","filter","className","JSONEditor","element","_handlePathChange","input","trigger","val","trim","close","applyButton","saveButton","prop","newKeys","keys","flatMap","y","endsWith","deleted","flag","split","head","tail","pop","t","join","err","warn","update","_loadEditorPromise","scriptPromise","script","createElement","onload","src","body","append","stylePromise","style","rel","href","all","_showError","error","el","attr","show","_updateTitle","_hideError","hide","getPrototypeOf","name","text","getData","path","isID","extractID","temp","evaluateDocument","isDocument","target","_findObject","match","eval","showFlagEditorForDocument","Error","ui","notifications","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","obj","r","Symbol","toStringTag","launchFlagEditorForEvent","event","currentTarget","parents","once","app","buttons","class","DocumentSheet","unshift","icon","label","onclick"],"sourceRoot":""}